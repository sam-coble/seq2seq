while (*endValue != '\0') {
    if (*endValue == '"')
        inString = !inString;
    else if (*endValue == '<' && !inString)
        cbCount++;
    else if (*endValue == '>' && cbCount > 0 && !inString)
        cbCount--;
    else if (*endValue == '>' && cbCount == 0 && !inString)
        break;
    else if (*endValue == '[' && !inString)
        sbCount++;
    else if (*endValue == ']' && !inString)
        sbCount--;
    else if (*endValue == ',' && !cbCount && !sbCount && !inString)
        break;
    endValue += 1;
}
%%%
jString* getjString(jNode* node) {
    if (node->type != jSTRING)
        return NULL;
    if (node->contents != NULL)
        return (jString*)node->contents;
    jString* string = malloc(sizeof(*string));
    node->contents = (void**)string;
    string->holder = node;
    string->length = node->datalen - 2;
    string->chars = malloc(sizeof(*string->chars) * (string->length + 1));
    for (int i = 0; i < node->datalen - 2; i++)
        string->chars[i] = node->rawdata[i + 1];
    string->chars[string->length] = '\0';
    return string;
}
%%%
By this time the hunter, asleep in the cave, began to dream, and the fairy whispered the secret in his ear. With both sight and hearing, he saw and understood all.
%%%
It was midday in midsummer, and the heat was great, as he took up a mass of wet snow, hardly more than a dipper full, but already made soft by the sun's rays. He squeezed the mass hard, between the palms of his hands. To the Frost Giants, it seemed scarcely bigger than a pill.
Then, striking an attitude, like a baseball pitcher, or a man playing tenpins, and about to roll the ball along down the alley, the Frost King held up before them the dark gray, sticky ball. As he fondled and patted it, as his own child, the Frost King called out, "I name thee, my son, 'Soaker Smash-All,' and I expect thee to break all records. Make the widest swathe of ruin, my son, ever known among men. The sun is [44]mine enemy, and, through thee, I shall spoil his work and give him plenty of labor to restore it. Go!"
Saying this, the toss was made and the ball set rolling.
%%%
"Good," cried the man with the golden hair. "Any other choice would have meant death. Here is the horn. Blow it tomorrow, and see what will happen."
%%%
Only a few days later, a line of wagons, driven up from a southern port, brought in supplies from France. Five of the wagons contained saddles, bridles, stirrups and a full equipment, made in France, for the whole regiment of Colonel Sheldon's cavalry, which had been at first raised in Connecticut. This was Lafayette's own gift, and had been paid from out of his own purse. The Continental Congress had given him a commission in the American army, with the rank of Major-General.[24]
%%%
Did the British capture Lafayette? Did he show fear, when Gustave Hess, the scout, rode up and told of three columns of red coats marching by different roads? Two were on one side of the Schuylkill river, and one on the other. Surely, with their five thousand men, they would, as they fully expected, trap the Marquis; and, they might even bag his whole force. A ship was actually waiting in the Delaware river to take [26]the young Frenchman a captive to London. Indeed, Lord Howe had invited some handsome Tory ladies to dinner, expecting to outwit Washington and to have the young Frenchman to sit as guest and captive.
But the young general spoiled this game. Mounting his horse, he ordered out, what military men call "false heads of columns." This made the British, who knew not what might be behind these front files, halt, until reinforced. Then they deployed, and, bringing up their cannon, sent a round shot that smashed the axle tree of one of Lafayette's field pieces.
Must, then, the young Frenchman abandon his gun, and face Washington, with one of his cannon lost by capture? Not he! Turning the heads of their horses, the artillery men of the Continentals drove into the Harby farm yard, drew out a wagon, lashed the dismounted cannon to the hind axle, hitched on the team, and, whipping up the steeds, the whole battery dashed toward Matson's ford, and reached safely the camp at Valley Forge. Seven gallant American lads, in the rear guard of the young Continentals, died in the fight to save the guns for their country.
%%%
At this, every fairy looked at each other, as if to say, "What a mouthful," "How strange a name," or "So big for a little fairy!" or "Why does she talk Latin?"
There were questions in their eyes also, but none asked "What does the name mean?" for all fairies are very shy about confessing ignorance.
But the Fairy Queen, who knew almost everything, put on a look of great dignity, and discreetly inquired, of the sage, if her everyday talk was in Latin. She did not mean to be sarcastic, however.
"Why would you call me by the 'Pearly Lion's Foot,' if I were to volunteer?" asked a bright young fairy.
%%%
if (node->type != jSTRING)
    return NULL;
if (node->contents != NULL)
    return (jString*)node->contents;
jString* string = malloc(sizeof(*string));
node->contents = (void**)string;
string->holder = node;
string->length = node->datalen - 2;
string->chars = malloc(sizeof(*string->chars) * (string->length + 1));
for (int i = 0; i < node->datalen - 2; i++)
    string->chars[i] = node->rawdata[i + 1];
string->chars[string->length] = '\0';
return string;
%%%
int isjTrue (char* str) {
    return (*str++ == 't' &&
            *str++ == 'r' &&
            *str++ == 'u' &&
            *str++ == 'e' &&
            *str == '\0') ? 4 : 0;
}
%%%
return (*str++ == 'f' &&
        *str++ == 'a' &&
        *str++ == 'l' &&
        *str++ == 's' &&
        *str++ == 'e' &&
        *str == '\0') ? 5 : 0;
%%%
jObject* getjObject(jNode* node) {
    if (node->type != jOBJECT)
        return NULL;
    if (node->contents != NULL)
        return (jObject*)node->contents;
    jObject* object = malloc(sizeof(*object));
    node->contents = (void**)object;
    object->holder = node;
    int colonCount = 0;
    char* cur = findNextColon(node->rawdata + 1, node->rawdata + node->datalen);
    while (cur != NULL) {
        colonCount++;
        cur = findNextColon(cur + 1, node->rawdata + node->datalen);
    }

    object->size = colonCount;
    object->keys = malloc(sizeof(*object->keys) * object->size);
    object->values = malloc(sizeof(*object->values) * object->size);

    int i = 0;
    char* prev = node->rawdata + 1;
    cur = findNextColon(prev, node->rawdata + node->datalen);
    while (cur != NULL) {
        *cur = '\0';
        object->keys[i] = getjNode(prev);
        *cur = ':';
        prev = cur + 1;
        cur = findNextComma(prev, node->rawdata + node->datalen);
        if (cur == NULL) {
            *(node->rawdata + node->datalen - 1) = '\0';
            object->values[i++] = getjNode(prev);
            *(node->rawdata + node->datalen - 1) = '>';
            break;
        } else {
            *cur = '\0';
            object->values[i++] = getjNode(prev);
            *cur = ',';
            prev = cur + 1;
            cur = findNextColon(prev, node->rawdata + node->datalen);
        }
        
    }

    return object;
}
%%%
Only a few miles distant, across the Hidden Stream, or Schuylkill, as the Dutch had named the river, was the valley forge, where the farmers in the region around had their tools made and mended.
Not far away, on the hill, was soon built Saint Peter's Lutheran church. In Switzerland, the Harbys had been members of the Reformed church, but all the people of the neighborhood now worshipped together.
%%%
When, after their first victories, the cows and goats should come, and the birds make their nests, and men and women arrive, and the boys and girls play, these fairies, thus changed into flowers, were not to object to have their stalks eaten up by the cattle, or their seeds to be swallowed by the birds, or their blossoms to be plucked by the children. Even when they should come to their best bloom, and seem too pretty to be touched, they were to welcome the cows and goats.
To all these directions, the new plants, trees, and flowers, nodded their heads, and the war began. The older fairies went back to the vineyards, [89]groves, forests, dales and meadows, in the lower lands of sunshine, of mild climate, and of fair weather, and the battle was on.
Several millions of years slipped away, and some of the fairies in the warm countries had almost forgot their cousins in the high Alps. Then it happened that some thousands of them made up a party to go and visit what they had once left long ago, as a polar region, of thick ice where no land was visible.
%%%
Only a few days later, a line of wagons, driven up from a southern port, brought in supplies from France. Five of the wagons contained saddles, bridles, stirrups and a full equipment, made in France, for the whole regiment of Colonel Sheldon's cavalry, which had been at first raised in Connecticut. This was Lafayette's own gift, and had been paid from out of his own purse. The Continental Congress had given him a commission in the American army, with the rank of Major-General.[24]
"Why, that sounds like a prince," murmured little Sarah to herself.
A few days later, and another surprise broke the monotony of life at Barren Hill. Washington wished to know what the British in Philadelphia were going to do. Would they attack him? Or, considering his military position too strong to risk assault, would they retire to New York? Would Washington capture, or be captured?
%%%
A strange thing happened. All the cows and goats woke up from their sleep, and one, from all directions, could hear the tinkling of their neck [33]bells, all over the pastures, far and near. The poor creatures thought it was time to get up and be milked, but they were puzzled to find it was yet dark. In fact, they were all, still, quite sleepy and very slow to move.
Something even far more wonderful happened next. Perrod, after first hearing the horn blow, thought the music had ceased: when, suddenly, it all seemed to come back in vastly greater volume. The sounds were multiplied, as if a thousand echoes had blended into one and all heaven had joined in the melody. Perrod was entranced. He even closed his eyes lest he might, by looking down at the strange men, lose some of what seemed to him a choir of angels singing.
%%%
Awaking, the hunter found his old blunderbuss gone. In its place lay the rifle, and a beauty it was, lighter to carry, more graceful in shape, and requiring less powder and lead. For one who had to climb mountains, this was a great benefit. So he at once loaded his new piece, so as to be ready for the first chamois he should see. He thought it would be fine fun to carry home a prize, in addition to his new weapon.
He had hardly stepped out of the topaz cave, [140]which seemed to close like a door behind him, than there appeared in view four chamois, each full grown and with splendid horns. Putting his rifle to his shoulder and taking careful aim, though the distance was great, he fired. Instantly, there fell the finest of the animals, while the others scampered away.
%%%
json_type getjNodeType (char* str) {
    char* start = firstNonSpace(str);
    char* end = firstEndSpace(start);
    if (start == end)
        return jWHITESPACE;
    char endHolder = *end;
    *end = '\0';
    json_type ret;
    if (isjString(start)) {
        ret = jSTRING;
    } else if (isjNumber(start)) {
        ret = jNUMBER;
    } else if (isjArray(start)) {
        ret = jARRAY;
    } else if (isjObject(start)) {
        ret = jOBJECT;
    } else if (isjWhitespace(start)) {
        ret = jWHITESPACE;
    } else if (isjTrue(start)) {
        ret = jTRUE;
    } else if (isjFalse(start)) {
        ret = jFALSE;
    } else if (isjNull(start)) {
        ret = jNULL;
    } else {
        ret = jERROR;
    }
    *end = endHolder;
    return ret;
}
%%%
char* start = str;
if (*str == '-')
    str += 1;

if (*str == '0') {
    str += 1;
} else if (*str >= '1' && *str <= '9') {
    while (*str >= '1' && *str <= '9')
        str += 1;
} else { // number must contian at least one digit
    return 0;
}

if (*str == '.') {
    str += 1;
    if (*str < '0' || *str > '9') // at least one digit must follow '.'
        return 0;
    while (*str >= '0' && *str <= '9')
        str += 1;
}

if (*str == 'e' || *str == 'E') {
    str +=1;
    if (*str == '+' || *str == '-')
        str += 1;
    if (*str < '0' || *str > '9') // at least one digit must follow (e|e\+|e-)
        return 0;
    while (*str >= '0' && *str <= '9')
        str += 1;
}

if (*str == '\0')
    return str - start;

return 0;
%%%
But when the king saw that the little tailor had only a pair of scissors, he laughed, until he forgot his grief. Then he offered the little man a battle axe. It was as sharp as a razor, and heavy enough to chop open a knight clothed in steel. Thus armed, the two were all ready to set out together to the dragon's cave.
Pretending that one of his shoe laces had broken and he needed to tie it up, the tailor told the giant to go on, and carry both axe and iron club, and he would catch up with him. When the two were together, the giant was about to hand his companion the battle axe, when the tailor began at once to talk about rice pudding. He smilingly asked the giant whether he liked raisins in it, and would take it with grated nutmeg, sprinkled over the top; or, would he have it plain?
The subject was so interesting to the giant, that his eyes sparkled at once. He forgot that he was carrying both of the two heavy things, axe and bar. He never dropped them, until they reached the dragon's lair.[127]
%%%
number->isInt = 0;
number->dvalue = atof(node->rawdata);
number->ivalue = (int)number->dvalue;
 else {
number->isInt = 1;
number->ivalue = atoi(node->rawdata);
number->dvalue = (double)number->ivalue;
%%%
When the North Wind blew down the news to the Swiss fairies, there was much sadness and even terror. Where could the fairies dance, when the meadows were gone and the flowers dead?
How could they float in the air, clad only in gauzy garments? How could they see each other, if mist and storm and darkness filled the air, and ice covered the ground? And how could they live without the blossoms? One fairy actually wept tears, in sympathy for the poor cows, that were certain to starve. And as for the children, whom the fairies loved, where could they play, if there were no fields to play in, or roses or violets to pick?
%%%
To the people who treat them badly, or make fun of their feet, or heads, or laugh and jeer at them, because they are so small, the Swiss dwarfs are very mischievous, and even revengeful, and do such folks great harm in the kitchens and stables. They smash the milk pans and cheese kettles, upset the churns, lead the cattle astray, tie the cows' tails together, and put stones and sticks in their food-troughs. Usually they do so much mischief, that the rude or cruel people have to be good, and treat the dwarfs with more politeness.
As for their looks, and the way they dress, the Swiss dwarfs beat all. They are web-footed, like geese, but they cover themselves, from head to toes, with long green cloaks. They wear gay red caps on their heads, which look like the cowls of monks. Most curious of all, are their beards, which are thick and long, and often white as snow.[58]
%%%
if (node->type != jARRAY)
    return NULL;
// printf("getting array\n");
if (node->contents != NULL)
    return (jArray*)node->contents;
jArray* array = malloc(sizeof(*array));
node->contents = (void**)array;
array->holder = node;
int commaCount = 0;
char* cur = findNextComma(node->rawdata + 1, node->rawdata + node->datalen);
while (cur != NULL) {
    commaCount++;
    cur = findNextComma(cur + 1, node->rawdata + node->datalen);
}

if (!commaCount && *firstNonSpace(node->rawdata + 1) == ']')
    array->size = 0;
else
    array->size = commaCount + 1;
array->elements = malloc(sizeof(*array->elements) * array->size);

int i = 0;
char* prev = node->rawdata + 1;
cur = findNextComma(prev, node->rawdata + node->datalen);
while (cur != NULL) {
    *cur = '\0';
    array->elements[i++] = getjNode(prev);
    *cur = ',';
    prev = cur + 1;
    cur = findNextComma(prev, node->rawdata + node->datalen);
}
// printf("prev=%c\n", *prev);
if (array->size > 0) {
    *(node->rawdata + node->datalen - 1) = '\0';
    array->elements[i] = getjNode(prev);
    *(node->rawdata + node->datalen - 1) = ']';
}


// printf("array size=%d\n", array->size);
// printf("array[0]=%p\n", array->elements[0]);
return array;
%%%
The boys left their hoops, and the girls their dolls, to run and welcome the returning hero. Old and young listened to his war stories, and even the dogs and pigeons seemed to share in the joy. The imagination of the youngsters was fired, and often maidens followed their lovers to distant countries. Who has not read, in the pages of Froissart, or Macaulay, of "Appenzell's stout infantry," or of the valor and devotion of the Swiss Guard, in the Tuilleries at Paris, who "died to defend their master." In their everlasting honor, one sees at Luzerne, sculptured out of the solid rock, the dying lion. This splendid work of art symbolizes the loyalty [11]and valor of the seven hundred and eighty-six victims, of the French mob, in 1793.
While the young men had opportunity to see the great world, beyond the mountains, most of the girls stayed at home in the valleys. Yet all the time, they thought of their brothers, lovers and kinsmen. They, too, longed to see a real prince, and to look on a military pageant, and gaze on the splendor of courts and palaces. At times, it was hard to restrain the maidens from roaming off, down the Rhine, to the rich and gay city of Amsterdam, or to the brilliancy of Paris.
%%%
By this time the proceedings of this avalanche, which had started out to settle quarrels, had become positively frivolous. Wabbling about, here and there, reeling like a man with a quart of brandy in his stomach, the mighty ball rolled down the long road, leading into a larger village.
"Now," fancied the Frost Giants, that were watching from aloft, "it surely will uphold the reputation of the family and act like other avalanches, in turning villages into cemeteries, and [166]farms and vineyards into deserts." Vain thought!
%%%
Yet they all went away happy, for they felt sure that whatever foolish mortals should do, Switzerland would still be the fairies' playground.[181]
[Contents]
XVII
THE KANGAROO POA
%%%
if (*endValue == '"')
    inString = !inString;
else if (*endValue == '<' && !inString)
    cbCount++;
else if (*endValue == '>' && cbCount > 0 && !inString)
    cbCount--;
else if (*endValue == '>' && cbCount == 0 && !inString)
    break;
else if (*endValue == '[' && !inString)
    sbCount++;
else if (*endValue == ']' && !inString)
    sbCount--;
else if (*endValue == ',' && !cbCount && !sbCount && !inString)
    break;
endValue += 1;
%%%
In old days, when it was the fashion for young men to be soldiers of fortune and enlist in the armies of France, or Germany, or Italy, or Holland, a Swiss man could forget, even his country, unless he had a sweetheart at home.
%%%
Then he clutched his whip more tightly, expecting to get down and thrash the animal with all his strength.
But Gulick moved on, the road narrowing down, between rocks, as many bridle paths in Switzerland do. Yet no sooner had the intelligent beast entered into the shadow, than again a shining angel appeared in the path in front of them, but this time in a threatening manner, and waving his glittering sword.
Startled at the sight, the ass again stopped, hoping its master would treat his own beast more kindly and see what was the matter.
But angry men are nearly always blind, and sometimes half insane, or even wholly so. Gruntli once more drove his already bloody spurs into Gulick's side.
%%%
Whereupon, every young man turned his female partner round, and some of them, most ungallantly, flapped their hands on their lower skirts. Feeling and finding that these were very damp, four or five of them at once lifted up their hands, which were wringing wet, and shook off the drops.
One bold fellow even went behind, and seized the tail of his partner's petticoat. She seemed to be the sloppiest-looking girl in the whole party, [204]and he actually wrung out a half pint of water.
%%%
*cur = '\0';
object->keys[i] = getjNode(prev);
*cur = ':';
prev = cur + 1;
cur = findNextComma(prev, node->rawdata + node->datalen);
if (cur == NULL) {
    *(node->rawdata + node->datalen - 1) = '\0';
    object->values[i++] = getjNode(prev);
    *(node->rawdata + node->datalen - 1) = '>';
    break;
} else {
    *cur = '\0';
    object->values[i++] = getjNode(prev);
    *cur = ',';
    prev = cur + 1;
    cur = findNextColon(prev, node->rawdata + node->datalen);
}

%%%
// printTabs(tabs);
if (array->size == 0) {
    printf("[]");
    return;
}
printf("[\n");
for (int i = 0; i < array->size; i++) {
    printTabs(tabs + 1);
    printjNode(array->elements[i], tabs + 1);
    if (i < array->size - 1)
        printf(",");
    printf("\n");
}
printTabs(tabs);
printf("]");
%%%
if (number->holder != NULL) {
    freejNode(number->holder);
    return;
}
free(number);
%%%
Some wondered how the battle would go, and if the war would ever end. Could they possibly march up the mountain sides, and hold their own, amid the blasts of winter and amid the eternal snow and ice, and win the land now covered up? Not a sign of field, or pasture, or road, or any space clear of snow, was then visible. There was nothing but ice, many miles thick and looming so far up in the air, as to seem, at night, to touch the stars. The jagged rocks, splintered by the lightning, and the mountain sides, clothed [87]with glaciers, like armor, and which were billions of tons in weight, seemed very forbidding.
"Just give us a few millions of years, and we'll surely win," cried the fairy queen, who was proud of her beautiful army, and who, with them all, knew or cared nothing for what we call time.
Fairies never cry, but some felt as if they might weep, to see so many pretty flowers killed, as they feared they would be. Even the idea of the chills and shivers, they would have to suffer, made some of the timid ones feel creepy.
%%%
Now, according to these ideas, there was a very hard-hearted man, named Chicksha, who beat his children. When angry, he threw dishes at his wife and cursed his servants. One day, when in a fit of bad temper, he fell dead. No one was sorry, and some were even glad.
%%%
// printf("creating node\n");
jNode* node = malloc(sizeof(*node));
char* start = firstNonSpace(str);
char* end = firstEndSpace(start);
node->type = getjNodeType(str);
node->contents = NULL;
node->datalen = end - start;
node->rawdata = malloc(sizeof(*node->rawdata) * (node->datalen + 1));
for (int i = 0; i < node->datalen; i++)
    node->rawdata[i] = start[i];
return node;
%%%
char* start = str;
if (*str != '<')
    return 0;
while (*str != '>') {
    int inString = 0, cbCount = 0, sbCount = 0; // " < [
    char* endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && !cbCount && !inString)
            break;
        else if (*endValue == ':' && !cbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    char endHolder = *endValue;
    *endValue = '\0';
    json_type elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE &&
        *str == '<' && 
        *endValue == '>')
        return endValue - start;

    if (elementType != jSTRING ||
        *endValue == '>')
        return 0;

    str = endValue;

    inString = 0, cbCount = 0, sbCount = 0;
    endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && cbCount == 0 && !inString)
            break;
        else if (*endValue == '[' && !inString)
            sbCount++;
        else if (*endValue == ']' && !inString)
            sbCount--;
        else if (*endValue == ',' && !cbCount && !sbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    endHolder = *endValue;
    *endValue = '\0';
    elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE ||
        elementType == jERROR)
        return 0;

    str = endValue;
}

if (*++str == '\0')
    return str - start;
return 0;
%%%
return 0;
%%%
if (string->holder != NULL) {
    freejNode(string->holder);
    return;
}
free(string->chars);
free(string);
%%%
No ogres or man-eating giants, of either sex, [174]were invited to this meeting, for the Swiss fairies are a very respectable lot of folks. In some countries, they do not have anything to do with "gods," or "devils." They are very particular as to who or how or what they regard as fit for society, or look upon as equals. Such beings of uncertain reputation as "the gods," or "the fates," or "the devils" or any of their tribe, were not known in their fairy society. It is said that such beings used to live in the mountains, when the Romans were in the land.
%%%
Whenever the Fairy Ship touched the shore, the ground, no matter how hard and stony it had been, at once became soft with soil. Then, grasses, and flowers, grain farms and orchards, and trees rich in luscious fruits, sprang up. Every boy and girl, always on the lookout, and adults, who were so fortunate as to catch a [233]glimpse of the Fairy Ship, would make a wish in their hearts, which was sure to be gratified. They got what they wanted, though often in fairy time, that is, years afterwards.
For years and years, the Fairy Ship plied up and down the lovely blue lake, stopping here and there. A moonlight night was the best time for catching a glimpse of it. Many old folks, still living, like to tell about the craft of good fortune, and also what they then wished for, when they were so happy as to see it coming, or sailing past them.
But bye and bye, when the black smoke of steamboats poisoned the air, and set the fairies sneezing and coughing, and roughened the throats of the swans, so that they could not sing any more, the Fairy Queen gave up her pleasure trips on the lake and ordered the snow fairies back to their mountains.
%%%
But when it comes to leaping, from rock to rock, the chamois is the Johnny Jump Up, among all animals, for he will skip over a chasm fifteen feet wide. Then, he will land on a tiny ledge of rock, so narrow that one could hardly imagine a cat could hold itself on. Putting his hind legs first, it gets a good footing, and then bounds forward.
These creatures are so agile, that one almost expects to see the strongest of them climb up trees, by hooking their horns on the branches, but they do not. They cut many capers, but not this one. The wonderful thing is that the females, as well as the males, have horns also.
These chamois ladies, and the little folks of the family, that is, the doe and fawn, generally live down among the lower forests, while the daddies and strong young bucks stay, most of the time, up among the high rocks and peaks. They all eat the lovely flowers, grasses, mosses and aromatic herbs, that have a hot taste, and which keep them warm inside.
%%%
He was just about to stretch both his hands and drink the green liquid, when the golden haired man, speaking gently to Perrod, said:
%%%
THE DWARF AND HIS CONFECTIONERY
%%%
Saying this, the toss was made and the ball set rolling.
At first, for several seconds, with Soaker Smash-All, it was more like ploughing, than rolling its way through the drifts, for the slope was slight. Then, as the incline grew more steep, the tumbling became more rapid, until about a half mile from the starting point, the baby avalanche had, by its leaps and bounds grown so fast, as to be already as big as a barn. It was bouncing swiftly along, when, instead of going straight ahead, as its daddy, the Frost King, had planned and expected, it rolled against a rounded rock, that curved up and backwards, like the dashboard of a sleigh, or the roof of a pagoda.
At once, it swerved to the right and bounded high up in the air, as though some Frost Giant was playing foot ball, and was trying to hit the goal.
%%%
So the boy had another run and was in very bad temper. He seized the bridle of Gulick, and gave such a jerk, in his anger, that he nearly broke the strap, and pained the animal's jaw.
%%%
"I am sure it will. Thank you heartily," said Soft Pudding.
Then the Fairy Queen held out before his gaze a lovely cuckoo clock, made of black walnut, with hands and face-figures cut out of the wood of the white birch tree.
%%%
One warm day, the cooper heard, afar off, the echoes of the Alpine horn. He listened with delight to the yodel music, as the shepherds called their cows and goats. As he was wondering how he could get out of the valley, and whether the dragons would let him go, he saw the larger one of the two monsters unfurl his wings, which were as big as a windmill's sails. He flew straight up in the air, and, when near the blue sky, circled about a few times, like the carrier pigeons, which the cooper had seen at home. Then, careering far away, he disappeared in the dim distance beyond. No doubt, that day, some poor daddy, on coming home at night, missed one of his daughters. The cooper had noticed, that both the dragons had been roaring with hunger, for several days previously, and now he had his fears.
So the cooper watched his chance, determined not to let the other dragon get away, without his stealing a ride on the monster's back. He knew [74]that a man's weight, for a dragon to carry in the air, would hardly be felt, so much as that of a feather.
For a dragon had the power of a catapult, the strength of a rhinoceros, a roar like a lion, teeth like a tiger, fins like a fish, claws like a falcon, wings like an eagle, and scales like an alligator. In short, a dragon was a whole menagerie in itself.
So watching his chance, the cooper, at the very moment that he saw the second dragon unfold his wings, grabbed hold of his tail; and, though it was slippery, he hung on to this, for dear life. Far up in the air, the monster flew, at first very high, and then low, as if he knew where the cooper lived. Then, coming near his village, the monster swooped down near the earth, and dropped his burden gently on the top of a wagon loaded with hay. He was off before any one could let fly an arrow from the string, or shoot a bolt out of a bow gun, or say "By Saint Matthew."
%%%
int isjObject (char* str) {
    char* start = str;
    if (*str != '<')
        return 0;
    while (*str != '>') {
        int inString = 0, cbCount = 0, sbCount = 0; // " < [
        char* endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && !cbCount && !inString)
                break;
            else if (*endValue == ':' && !cbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        char endHolder = *endValue;
        *endValue = '\0';
        json_type elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE &&
            *str == '<' && 
            *endValue == '>')
            return endValue - start;

        if (elementType != jSTRING ||
            *endValue == '>')
            return 0;

        str = endValue;

        inString = 0, cbCount = 0, sbCount = 0;
        endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && cbCount == 0 && !inString)
                break;
            else if (*endValue == '[' && !inString)
                sbCount++;
            else if (*endValue == ']' && !inString)
                sbCount--;
            else if (*endValue == ',' && !cbCount && !sbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        endHolder = *endValue;
        *endValue = '\0';
        elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE ||
            elementType == jERROR)
            return 0;

        str = endValue;
    }

    if (*++str == '\0')
        return str - start;
    return 0;
}
%%%
int isjObject (char* str) {
    char* start = str;
    if (*str != '<')
        return 0;
    while (*str != '>') {
        int inString = 0, cbCount = 0, sbCount = 0; // " < [
        char* endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && !cbCount && !inString)
                break;
            else if (*endValue == ':' && !cbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        char endHolder = *endValue;
        *endValue = '\0';
        json_type elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE &&
            *str == '<' && 
            *endValue == '>')
            return endValue - start;

        if (elementType != jSTRING ||
            *endValue == '>')
            return 0;

        str = endValue;

        inString = 0, cbCount = 0, sbCount = 0;
        endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && cbCount == 0 && !inString)
                break;
            else if (*endValue == '[' && !inString)
                sbCount++;
            else if (*endValue == ']' && !inString)
                sbCount--;
            else if (*endValue == ',' && !cbCount && !sbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        endHolder = *endValue;
        *endValue = '\0';
        elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE ||
            elementType == jERROR)
            return 0;

        str = endValue;
    }

    if (*++str == '\0')
        return str - start;
    return 0;
}
%%%
freejNode(number->holder);
return;
%%%
int inString = 0, cbCount = 0, sbCount = 0;
for (char* cur = start; cur < end; cur += 1) {
    if (*cur == '\0')
        return NULL;
    else if (*cur == '"')
        inString = !inString;
    else if (*cur == '[' && !inString)
        sbCount++;
    else if (*cur == ']' && !inString)
        sbCount--;
    else if (*cur == '<' && !inString)
        cbCount++;
    else if (*cur == '>' && !inString)
        cbCount--;
    else if (*cur == ',' && !inString && !cbCount && !sbCount)
        return cur;
}
return NULL;
%%%
while (cur != NULL) {
    commaCount++;
    cur = findNextComma(cur + 1, node->rawdata + node->datalen);
}
%%%
Only a few days later, a line of wagons, driven up from a southern port, brought in supplies from France. Five of the wagons contained saddles, bridles, stirrups and a full equipment, made in France, for the whole regiment of Colonel Sheldon's cavalry, which had been at first raised in Connecticut. This was Lafayette's own gift, and had been paid from out of his own purse. The Continental Congress had given him a commission in the American army, with the rank of Major-General.[24]
"Why, that sounds like a prince," murmured little Sarah to herself.
%%%
char* start = str;
while (*str != '\0')
    str += 1;
while (str > start && isCharWhitespace(*(str - 1)))
    str -= 1;
return str;
%%%
Yet during all these night hours, they had the power of eyesight. They saw all that was going on, and this was what they witnessed.
Just as the first gleams of the upcoming sun were beginning to streak the midnight blue of the skies, with light, and make rosy the east, but while, at the same time, the moon cast a pale light on the strange scene, they discerned plainly the Lorelei. She was standing on the highest pointed rock that rose out of the Rhine. There, the beautiful creature was, as if in a waiting attitude, before a mirror, and about to retire to her [248]bed for sleep. She took off all her ornaments and jewels. She unbound the bands of her shining hair, and unplaited the braids, until her tresses fell, in one glorious mass, like a cataract of gold. She threw away, one by one, her comb, her girdle, her splendid robes, and each of her pearls and gems, into the foaming waters. Then she chanted a spell, to draw the waters up to the very top of the rock, until the wavelets rolled over her shining feet.
%%%
if (string->holder != NULL) {
    freejNode(string->holder);
    return;
}
free(string->chars);
free(string);
%%%
int isjObject (char* str) {
    char* start = str;
    if (*str != '<')
        return 0;
    while (*str != '>') {
        int inString = 0, cbCount = 0, sbCount = 0; // " < [
        char* endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && !cbCount && !inString)
                break;
            else if (*endValue == ':' && !cbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        char endHolder = *endValue;
        *endValue = '\0';
        json_type elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE &&
            *str == '<' && 
            *endValue == '>')
            return endValue - start;

        if (elementType != jSTRING ||
            *endValue == '>')
            return 0;

        str = endValue;

        inString = 0, cbCount = 0, sbCount = 0;
        endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && cbCount == 0 && !inString)
                break;
            else if (*endValue == '[' && !inString)
                sbCount++;
            else if (*endValue == ']' && !inString)
                sbCount--;
            else if (*endValue == ',' && !cbCount && !sbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        endHolder = *endValue;
        *endValue = '\0';
        elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE ||
            elementType == jERROR)
            return 0;

        str = endValue;
    }

    if (*++str == '\0')
        return str - start;
    return 0;
}
%%%
The sick and the well alike get vast benefit. They think it great fun to find so much ice and snow, and also so much sunshine, as if winter and summer liked to play together. In February, hardy and strong people enjoy sledding and sliding, besides skis and skittles, and [78]many other merry sports. Children go out on sleds, with almost nothing on them, to enjoy the air baths.
%%%
char* firstNonSpace (char* str) {
    while (isCharWhitespace(*str))
        str += 1;
    return str;
}
%%%
*cur = '\0';
object->keys[i] = getjNode(prev);
*cur = ':';
prev = cur + 1;
cur = findNextComma(prev, node->rawdata + node->datalen);
if (cur == NULL) {
    *(node->rawdata + node->datalen - 1) = '\0';
    object->values[i++] = getjNode(prev);
    *(node->rawdata + node->datalen - 1) = '>';
    break;
} else {
    *cur = '\0';
    object->values[i++] = getjNode(prev);
    *cur = ',';
    prev = cur + 1;
    cur = findNextColon(prev, node->rawdata + node->datalen);
}

%%%
if (string->holder != NULL) {
    freejNode(string->holder);
    return;
}
free(string->chars);
free(string);
%%%
Silver Wreath, the fairy, was noted for living among the lofty peaks, where only the hardiest flowers, such as the Alpine rose, and the noble white flower, called the edelweiss, could grow. No animal or bird, ermine or ptarmigan, could [211]be whiter than her body, which glistened like snow crystals or hoar frost, when struck by the sunbeams. When she blushed, her whole body was like the wonderful Alpine glow that, after sunset, robes the mountain tops, and both for the same reason. The sky becomes rosy red, because the sun's rays are reflected from the snow, even after going down. So this fairy's beautiful body not only shone by its own light, but at times reflected the great luminary's loveliest tints. It was a way the sun had, of saying "good night" to the mighty mountains. So, also, fairy Silver Wreath blushed when, in the dawn of day, she made her farewell curtsey to her companions, for, after sunrise, the fairies disappear.
Now there was a brave hunter named Jeannod, who lived in a village of Uri. In his pursuit of the chamois, this stalwart youth was not afraid to follow this agile animal over the most dizzy precipices, and far up beyond the snow line. He did not hesitate to climb the most perpendicular mountain walls, to get a good shot. Hence, he was often compelled to spend a night, amid the cliffs and glaciers.
One evening, while on a hunting expedition, Jeannod caught sight of Silver Wreath, as she was flitting on her gauzy wings around a peak. At once, he fell in love with her. Happily for him, she was, after several meetings, enamored [212]of Jeannod, and he became her favorite. As they became better acquainted with each other, she guided him over unknown paths and often warned him of danger. She directed him to the chamois herds, and fed him with the finest oat cake and cheese. When too wearied to retrace his way back, or to return home, for the night, she watched over him while he slept. There, far above, where the eagles flew, she guarded her lover from falling rock or ice, shielding him from every peril, seen and unseen.
%%%
"Well, not exactly the Australian jumper, or the American tree-climber; but, if we can persuade the sun to help us, we may get a plant to become more mother-like, and keep her babies at home, until they are weaned and warmly clothed. Then, when they grow up, they will [186]be able to find food, and set up housekeeping for themselves."
%%%
The chairman at once recognized him, called him by name, and bade him come up in front and speak where all could hear him. He was very modest at first, and held back a moment, but fearing that some of the other dwarfs might twist their necks off, in turning them too far around to get a good look at him, and knowing that some of the old fellows were nearly deaf, he strode forward. Stepping upon a platform of rock, where all could hear him easily, he began thus:
"The trouble with our friend Walter, and with all other hunters, good and bad, especially with those who are poor shots, is that with all their good intentions, they are too stupid. They need the help of us dwarfs."
Here he was interrupted by applause, and cries of "well said," and "go on."
%%%
"What's the matter?" asked the giant. "Don't you feel all right?"
"Why, no! You nearly dented my skull, when you struck the dragon with your club. Why are you not more skillful? I can handle such monsters better than you. Can't you see that I just leaped into the dragon's mouth, in order to cut his throat, with my scissors?" With this, he flourished his shears, which were all bloody.
The stupid giant was dumbfounded, but he did not know enough to contradict the tailor, who told the big fellow to shoulder the dragon, and [128]they would both go back to the king's court, and demand the promised reward. So, with much pulling and hauling, lifting and dragging, the giant did all the work. The clumsy carcass was laid before the royal throne. The princess, looking on, wondered which one of the two heroes was to be her husband.
She did not feel, just then, like marrying either of them, big or little. When, however, she thought it over, she believed she could live on her income better with the tailor, than with the giant, who was already beginning to ask when dinner would be ready.
%%%
There were many girls in Japan, named Taka, which means a hawk, because of their bad temper, or their cruelty to puppies or kittens. Sometimes, however, the name was a compliment, because they were quick and smart, like falcons.
Now, according to these ideas, there was a very hard-hearted man, named Chicksha, who beat his children. When angry, he threw dishes at his wife and cursed his servants. One day, when in a fit of bad temper, he fell dead. No one was sorry, and some were even glad.
After this event, whenever people saw a falcon, with terrible shining eyes, and beak as sharp as two razors, and with claws and talons, like a steel meat hook, they said, "It must be Chicksha, [104]come to life again." Then they all ran out of their houses to see a thing so wonderful.
After they had become used to the sight, they noticed, one day, that the terrible creature had unfolded its wings, spread them out wide, and flown westward. After awhile, this falcon had soared so high and so far, that, in the distance, it became nothing more than a speck on the blue horizon. Then it disappeared behind the mountains. At this, everybody clapped their hands with delight. In fact, some of the more pious went to the village shrine and gave thanks to Great Buddha, for ridding the neighborhood of such a pest.
%%%
char* start = str;
if (*str != '"')
    return 0;
str += 1;
while (*str != '"') {
    if (*str == '\\') {
        str += 1;
        if (*str == 'u') {
            for (int i = 0; i < 4; i++) {
                str += 1;
                if ((*str < '0' || *str > '9') &&
                    (*str < 'a' || *str > 'f')) {
                    return 0;
                }
            }
        } else if (
            *str != '"' &&
            *str != '\\' && 
            *str != '/' &&
            *str != 'b' &&
            *str != 'f' &&
            *str != 'n' &&
            *str != 'r' &&
            *str != 't') {
            return 0;
        }
    }
    else if (*str == '\0') {
        return 0;
    }
    str += 1;
}

str += 1;
if (*str == '\0')
    return str - start;
return 0;
%%%
*(node->rawdata + node->datalen - 1) = '\0';
array->elements[i] = getjNode(prev);
*(node->rawdata + node->datalen - 1) = ']';
%%%
When the little boys and girls, who read these Swiss fairy tales, grow up to be big and travel in Switzerland, they will enjoy the Alpine horn.
Nearly every shepherd lad in the mountains knows how to blow it. It is made of wood, and is about half as long as an ordinary broom. Its butt, or heavy end, rests on the ground. When a man blows a long blast, the sound, at first, when one is too near, does not seem to be very pleasing; for distance lends enchantment to the sound. But wait a moment, and listen! Far off across the valley, the strains are caught up, and sent back from the tops of the high mountains. Then it sounds as if a great choir of angels had come down from Heaven to sing glory to God, and to bring greetings to all good souls. Nowhere in all the world is there such sweet music made by echoes.
Sometimes there is a double set of echoes, like one rainbow inside of another. Then, it makes one think of a choir of little angels, that sing a [29]second time, after the first heavenly chorus has ceased.
How the Swiss people first received the Alpine horn, as a gift from the fairies, is told in the story of a faithful shepherd's boy, named Perrod. He had to work hard all day, in tending the cows that grazed on the high mountain pastures, which the natives call the Alps. But when foreign people speak of "the Alps," they mean the ranges of mountains themselves.
%%%
while (*str != '>') {
    int inString = 0, cbCount = 0, sbCount = 0; // " < [
    char* endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && !cbCount && !inString)
            break;
        else if (*endValue == ':' && !cbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    char endHolder = *endValue;
    *endValue = '\0';
    json_type elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE &&
        *str == '<' && 
        *endValue == '>')
        return endValue - start;

    if (elementType != jSTRING ||
        *endValue == '>')
        return 0;

    str = endValue;

    inString = 0, cbCount = 0, sbCount = 0;
    endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && cbCount == 0 && !inString)
            break;
        else if (*endValue == '[' && !inString)
            sbCount++;
        else if (*endValue == ']' && !inString)
            sbCount--;
        else if (*endValue == ',' && !cbCount && !sbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    endHolder = *endValue;
    *endValue = '\0';
    elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE ||
        elementType == jERROR)
        return 0;

    str = endValue;
}
%%%
[Contents]
XX
THE ALPINE HUNTER AND HIS FAIRY GUARDIAN
There is one variety of the Swiss fairies who manage to get along with very few clothes, and those very thin. The prettiest ones among them seem to live up among the highest mountain peaks. There, it is colder than anywhere else, but these fairies do not mind it. Furs are not in fashion, but only very filmy garments. On their backs are gauzy wings, by which they can fly around from one peak to another. They hover over the meadows also, which in summer glisten with blossoms of every tint and hue. They love to plague Jack Frost, and the old mountain giants, that have beards of icicles, and hair of snow streamers, and who try so hard to freeze out the flowers.
%%%
At this, all the fairies of every sort and kind, laughed and guffawed so uproariously, that the meeting adjourned in disorder.[180]
Yet they all went away happy, for they felt sure that whatever foolish mortals should do, Switzerland would still be the fairies' playground.[181]
%%%
char* start = firstNonSpace(str);
char* end = firstEndSpace(start);
if (start == end)
    return jWHITESPACE;
char endHolder = *end;
*end = '\0';
json_type ret;
if (isjString(start)) {
    ret = jSTRING;
} else if (isjNumber(start)) {
    ret = jNUMBER;
} else if (isjArray(start)) {
    ret = jARRAY;
} else if (isjObject(start)) {
    ret = jOBJECT;
} else if (isjWhitespace(start)) {
    ret = jWHITESPACE;
} else if (isjTrue(start)) {
    ret = jTRUE;
} else if (isjFalse(start)) {
    ret = jFALSE;
} else if (isjNull(start)) {
    ret = jNULL;
} else {
    ret = jERROR;
}
*end = endHolder;
return ret;
%%%
"Well then," asked still another fairy, "can you furnish us with a vegetable kangaroo?" This was asked in a tone of contempt, as if she believed it were not possible to protect anything from Jack Frost and the giants, even though the sun helped with all his might.
%%%
In truth, the fairies of every sort held their noses, and otherwise showed their dislike, or contempt, whenever any one made mention of the name or the deeds of demons, or devils.
%%%
In one of the towns near by, lived a proud man, named Gruntli, who scouted the idea of there being any fairies, or Santa Claus. To his view, there was no intelligence, or virtue, in dumb brutes. He did not believe in anything but what he could see, taste, smell, hear, or handle with his ten fingers. This was what he called "science."
This old fellow, Gruntli, boasted of being "a man of science." He considered that everything belonging to religion was superstition. Mule drivers, cow milkers, cheese makers, and such folk, whom he called "the ignorant common people," might have faith in such things, but not he.
Gruntli was rich. He had a large house, with one room full of books, but not one of these contained any poetry, or stories, or novels, or romances. He sneered at anybody who said they [251]believed in Santa Claus, and he openly insulted people who loved to think that William Tell, their national hero, ever lived. As for the exploits of Joan of Arc, or of Arnold of Winkelried, he used to say that what was told of them was only the same as nursery stories.
%%%
str += 1;
if ((*str < '0' || *str > '9') &&
    (*str < 'a' || *str > 'f')) {
    return 0;
}
%%%
return (*str++ == 'n' &&
    *str++ == 'u' &&
    *str++ == 'l' &&
    *str++ == 'l' &&
    *str == '\0') ? 4 : 0;
%%%
number->isInt = 0;
number->dvalue = atof(node->rawdata);
number->ivalue = (int)number->dvalue;
 else {
number->isInt = 1;
number->ivalue = atoi(node->rawdata);
number->dvalue = (double)number->ivalue;
%%%
Here was one creature, dazzlingly splendid in colors, while, alongside of her, was a little lady robed entirely in white, as if she were to be the bride of Jack Frost, and marry him in a country where the tint of ermine and ptarmigan bird was the only one in fashion.
%%%
char* start = str;
while (*str != '\0') {
    if (!isCharWhitespace(*str))
        return 0;
    str += 1;
}
return str - start;
%%%
void printjNode(jNode* node, int tabs) {
    // printf("printing\n");
    // printf("type= %d\n", node->type);
    switch (node->type) {
        case jSTRING: {
            printjString(getjString(node), tabs);
            break;
        } case jNUMBER: {
            printjNumber(getjNumber(node), tabs);
            break;
        } case jARRAY: {
            printjArray(getjArray(node), tabs);
            break;
        } case jOBJECT: {
            printjObject(getjObject(node), tabs);
            break;
        } default: {
            printf("Could not parse.\n");
            break;
        }
    }
}
%%%
jNode* getjNode (char* str) {
    // printf("creating node\n");
    jNode* node = malloc(sizeof(*node));
    char* start = firstNonSpace(str);
    char* end = firstEndSpace(start);
    node->type = getjNodeType(str);
    node->contents = NULL;
    node->datalen = end - start;
    node->rawdata = malloc(sizeof(*node->rawdata) * (node->datalen + 1));
    for (int i = 0; i < node->datalen; i++)
        node->rawdata[i] = start[i];
    return node;
}
%%%
On the contrary, in the forest home of the chamois, there was much rejoicing, for they had heard the ring of the rifle and seen its flash. In fact, avalanches were very popular in chamois society, for even when one was seen coming, soon enough, the bucks and does could easily dodge them.[48]
%%%
return (*str++ == 'f' &&
        *str++ == 'a' &&
        *str++ == 'l' &&
        *str++ == 's' &&
        *str++ == 'e' &&
        *str == '\0') ? 5 : 0;
%%%
char* start = str;
if (*str != '"')
    return 0;
str += 1;
while (*str != '"') {
    if (*str == '\\') {
        str += 1;
        if (*str == 'u') {
            for (int i = 0; i < 4; i++) {
                str += 1;
                if ((*str < '0' || *str > '9') &&
                    (*str < 'a' || *str > 'f')) {
                    return 0;
                }
            }
        } else if (
            *str != '"' &&
            *str != '\\' && 
            *str != '/' &&
            *str != 'b' &&
            *str != 'f' &&
            *str != 'n' &&
            *str != 'r' &&
            *str != 't') {
            return 0;
        }
    }
    else if (*str == '\0') {
        return 0;
    }
    str += 1;
}

str += 1;
if (*str == '\0')
    return str - start;
return 0;
%%%
for (int i = 0; i < tabs; i++)
    printf("  ");
%%%
*(node->rawdata + node->datalen - 1) = '\0';
object->values[i++] = getjNode(prev);
*(node->rawdata + node->datalen - 1) = '>';
break;
 else {
*cur = '\0';
object->values[i++] = getjNode(prev);
*cur = ',';
prev = cur + 1;
cur = findNextColon(prev, node->rawdata + node->datalen);
%%%
THE ALPINE HUNTER AND HIS FAIRY GUARDIAN
There is one variety of the Swiss fairies who manage to get along with very few clothes, and those very thin. The prettiest ones among them seem to live up among the highest mountain peaks. There, it is colder than anywhere else, but these fairies do not mind it. Furs are not in fashion, but only very filmy garments. On their backs are gauzy wings, by which they can fly around from one peak to another. They hover over the meadows also, which in summer glisten with blossoms of every tint and hue. They love to plague Jack Frost, and the old mountain giants, that have beards of icicles, and hair of snow streamers, and who try so hard to freeze out the flowers.
These fairies know all the secrets of the mountains. They find out where the largest and prettiest rock crystals are, and where the priceless minerals are to be found. They can tell just where the caves of sparkling topaz are situated, but they do not let any mortal know, unless he [210]is their favorite. They can lead a hunter to the spot where the chamois are feeding on the moss. When they want to reward a brave man, they bring him bullets that are sure to hit the buck, and win for the marksman a fine pair of horns; or, at the village shooting matches, plug the bull's eye of the target, and so secure the prize. To please his fairy guardian, the hunter must always promise to do what she bids him, or else her bad temper is roused. Then she scolds, and leaves him to his luck, which, after that time, is never good. It is not safe to quarrel with a fairy.
%%%
The little girls, Sarah, Hannah and Margaret, often heard from their grandfather and grandmother about Switzerland, whence, following William Penn, they had come. Their kinsfolk still lived in the old land across the sea. When the Revolutionary war was over, their father, John Harby, came to the Quaker City, and kept a hotel. There, when Philadelphia was the national capital, he entertained members of Congress and the refugee French noblemen.
%%%
while (isCharWhitespace(*str))
    str += 1;
return str;
%%%
char* start = str;
if (*str != '<')
    return 0;
while (*str != '>') {
    int inString = 0, cbCount = 0, sbCount = 0; // " < [
    char* endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && !cbCount && !inString)
            break;
        else if (*endValue == ':' && !cbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    char endHolder = *endValue;
    *endValue = '\0';
    json_type elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE &&
        *str == '<' && 
        *endValue == '>')
        return endValue - start;

    if (elementType != jSTRING ||
        *endValue == '>')
        return 0;

    str = endValue;

    inString = 0, cbCount = 0, sbCount = 0;
    endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && cbCount == 0 && !inString)
            break;
        else if (*endValue == '[' && !inString)
            sbCount++;
        else if (*endValue == ']' && !inString)
            sbCount--;
        else if (*endValue == ',' && !cbCount && !sbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    endHolder = *endValue;
    *endValue = '\0';
    elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE ||
        elementType == jERROR)
        return 0;

    str = endValue;
}

if (*++str == '\0')
    return str - start;
return 0;
%%%
int isjObject (char* str) {
    char* start = str;
    if (*str != '<')
        return 0;
    while (*str != '>') {
        int inString = 0, cbCount = 0, sbCount = 0; // " < [
        char* endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && !cbCount && !inString)
                break;
            else if (*endValue == ':' && !cbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        char endHolder = *endValue;
        *endValue = '\0';
        json_type elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE &&
            *str == '<' && 
            *endValue == '>')
            return endValue - start;

        if (elementType != jSTRING ||
            *endValue == '>')
            return 0;

        str = endValue;

        inString = 0, cbCount = 0, sbCount = 0;
        endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && cbCount == 0 && !inString)
                break;
            else if (*endValue == '[' && !inString)
                sbCount++;
            else if (*endValue == ']' && !inString)
                sbCount--;
            else if (*endValue == ',' && !cbCount && !sbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        endHolder = *endValue;
        *endValue = '\0';
        elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE ||
            elementType == jERROR)
            return 0;

        str = endValue;
    }

    if (*++str == '\0')
        return str - start;
    return 0;
}
%%%
It was the general opinion, however, that mortal men could do wonderful things. They might build railroads up to the mountain tops, harness every waterfall, fill the valleys with electric machinery, and erect observatories to study the weather and the stars. For all this, the fairies paid them due honor.
It was acknowledged that, in one thing, some of the native mortals could beat the world, that is, in holding out their hands for a gift. Fairies thought this was because they had a disease, called itch of the palm; but they noticed that a coin always healed the trouble and caused the fingers to shut up finely on the silver.
But when human beings gave credit, for the smart things which the fairies used to do, to the monster they called the Devil, they were vexed indeed. Both the frost giants and the flower fairies declared that they would go on with their work, for who or what could stop either of them? Besides, no human beings could produce anything so pretty as a flower, or a snow crystal. At the idea of their making Edelweiss out of canton flannel, and selling these bogus things in the shops, they laughed again and again.
%%%
char* start = str;
if (*str != '<')
    return 0;
while (*str != '>') {
    int inString = 0, cbCount = 0, sbCount = 0; // " < [
    char* endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && !cbCount && !inString)
            break;
        else if (*endValue == ':' && !cbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    char endHolder = *endValue;
    *endValue = '\0';
    json_type elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE &&
        *str == '<' && 
        *endValue == '>')
        return endValue - start;

    if (elementType != jSTRING ||
        *endValue == '>')
        return 0;

    str = endValue;

    inString = 0, cbCount = 0, sbCount = 0;
    endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && cbCount == 0 && !inString)
            break;
        else if (*endValue == '[' && !inString)
            sbCount++;
        else if (*endValue == ']' && !inString)
            sbCount--;
        else if (*endValue == ',' && !cbCount && !sbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    endHolder = *endValue;
    *endValue = '\0';
    elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE ||
        elementType == jERROR)
        return 0;

    str = endValue;
}

if (*++str == '\0')
    return str - start;
return 0;
%%%
while (cur != NULL) {
    *cur = '\0';
    object->keys[i] = getjNode(prev);
    *cur = ':';
    prev = cur + 1;
    cur = findNextComma(prev, node->rawdata + node->datalen);
    if (cur == NULL) {
        *(node->rawdata + node->datalen - 1) = '\0';
        object->values[i++] = getjNode(prev);
        *(node->rawdata + node->datalen - 1) = '>';
        break;
    } else {
        *cur = '\0';
        object->values[i++] = getjNode(prev);
        *cur = ',';
        prev = cur + 1;
        cur = findNextColon(prev, node->rawdata + node->datalen);
    }
    
}
%%%
if (*endValue == '"')
    inString = !inString;
else if (*endValue == '<' && !inString)
    cbCount++;
else if (*endValue == '>' && cbCount > 0 && !inString)
    cbCount--;
else if (*endValue == '>' && cbCount == 0 && !inString)
    break;
else if (*endValue == '[' && !inString)
    sbCount++;
else if (*endValue == ']' && !inString)
    sbCount--;
else if (*endValue == ',' && !cbCount && !sbCount && !inString)
    break;
endValue += 1;
%%%
jObject* getjObject(jNode* node) {
    if (node->type != jOBJECT)
        return NULL;
    if (node->contents != NULL)
        return (jObject*)node->contents;
    jObject* object = malloc(sizeof(*object));
    node->contents = (void**)object;
    object->holder = node;
    int colonCount = 0;
    char* cur = findNextColon(node->rawdata + 1, node->rawdata + node->datalen);
    while (cur != NULL) {
        colonCount++;
        cur = findNextColon(cur + 1, node->rawdata + node->datalen);
    }

    object->size = colonCount;
    object->keys = malloc(sizeof(*object->keys) * object->size);
    object->values = malloc(sizeof(*object->values) * object->size);

    int i = 0;
    char* prev = node->rawdata + 1;
    cur = findNextColon(prev, node->rawdata + node->datalen);
    while (cur != NULL) {
        *cur = '\0';
        object->keys[i] = getjNode(prev);
        *cur = ':';
        prev = cur + 1;
        cur = findNextComma(prev, node->rawdata + node->datalen);
        if (cur == NULL) {
            *(node->rawdata + node->datalen - 1) = '\0';
            object->values[i++] = getjNode(prev);
            *(node->rawdata + node->datalen - 1) = '>';
            break;
        } else {
            *cur = '\0';
            object->values[i++] = getjNode(prev);
            *cur = ',';
            prev = cur + 1;
            cur = findNextColon(prev, node->rawdata + node->datalen);
        }
        
    }

    return object;
}
%%%
"I know," said Daddy. "We have been waiting for news of the alliance with France. Now, our Continentals and the sparkling Bourbonnieres will march together. Whole companies, among these, are our Swiss boys." Then he hummed, joyfully, the old German tune of Yankee Doodle. Perhaps now, a French fleet would come up the Delaware, blockade Philadelphia, and capture Howe's army, as Burgoyne had been captured. At the table, they kept on talking a long time.
Only a few days later, a line of wagons, driven up from a southern port, brought in supplies from France. Five of the wagons contained saddles, bridles, stirrups and a full equipment, made in France, for the whole regiment of Colonel Sheldon's cavalry, which had been at first raised in Connecticut. This was Lafayette's own gift, and had been paid from out of his own purse. The Continental Congress had given him a commission in the American army, with the rank of Major-General.[24]
"Why, that sounds like a prince," murmured little Sarah to herself.
A few days later, and another surprise broke the monotony of life at Barren Hill. Washington wished to know what the British in Philadelphia were going to do. Would they attack him? Or, considering his military position too strong to risk assault, would they retire to New York? Would Washington capture, or be captured?
%%%
*cur = '\0';
object->keys[i] = getjNode(prev);
*cur = ':';
prev = cur + 1;
cur = findNextComma(prev, node->rawdata + node->datalen);
if (cur == NULL) {
    *(node->rawdata + node->datalen - 1) = '\0';
    object->values[i++] = getjNode(prev);
    *(node->rawdata + node->datalen - 1) = '>';
    break;
} else {
    *cur = '\0';
    object->values[i++] = getjNode(prev);
    *cur = ',';
    prev = cur + 1;
    cur = findNextColon(prev, node->rawdata + node->datalen);
}

%%%
It is true that at this meeting, the elves, gnomes and kobolds were, some of them, so black and sooty, and smelled so strongly of smoke and fire, that the more dainty fairies in gauzy dresses did not like to sit near them. Besides this, some of the kobolds came with their leather aprons on, and altogether they were such real blacksmiths, that the doorkeeper did not want to admit them. At least, the water fairies thought, they might have taken off their aprons and washed up a little.
Biggest of all, at the assembly, were the frost giants, and one of these, who towered above all, was chosen, by a show of hands, to be president of the meeting. A half acre was allowed him to sit down upon. When ready to tap for order, he picked up a boulder, for a gavel, which weighed a ton or more. With this, he pounded on a flat rock. At the sound, all stopped talking, looked up and listened. One minute before, [198]it was like the buzzing of bees. Now all was silence.
These frost giants, of whom a dozen or so were present, had ridden to the meeting each on his own avalanche, which he used for a bicycle. They all had long beards of icicles, that appeared like stalactites in a cave. Their big eyes looked, for all the world, like locomotive headlights, and some of the little fairies were afraid to look at them.
%%%
"DRINK YOUNG FRIEND," SAID THE GIANT
[41]
As a rule, nobody knows, either in summer or winter, just when the avalanches will fall, or whether they will be made of light, powdery, dry snow, or of snow that is heavy, wet, and like what the boys call "soakers." Yet there are some old men in Switzerland, who can foretell avalanches, as our wise men try to do with the weather.
Once upon a time, the Frost Giant's baby, of which we are going to tell, was born, and great things were expected of it, even when it was only as big as a snowflake. But, when it grew up, to be a real avalanche, it behaved very differently from all the others. It disappointed its daddy and its uncles awfully. The Frost Giants like to make all the mischief they can, while this one wanted to help men, instead of hurting them, and made a new record in the history of colossal snowballs.
%%%
if (node->type != jOBJECT)
    return NULL;
if (node->contents != NULL)
    return (jObject*)node->contents;
jObject* object = malloc(sizeof(*object));
node->contents = (void**)object;
object->holder = node;
int colonCount = 0;
char* cur = findNextColon(node->rawdata + 1, node->rawdata + node->datalen);
while (cur != NULL) {
    colonCount++;
    cur = findNextColon(cur + 1, node->rawdata + node->datalen);
}

object->size = colonCount;
object->keys = malloc(sizeof(*object->keys) * object->size);
object->values = malloc(sizeof(*object->values) * object->size);

int i = 0;
char* prev = node->rawdata + 1;
cur = findNextColon(prev, node->rawdata + node->datalen);
while (cur != NULL) {
    *cur = '\0';
    object->keys[i] = getjNode(prev);
    *cur = ':';
    prev = cur + 1;
    cur = findNextComma(prev, node->rawdata + node->datalen);
    if (cur == NULL) {
        *(node->rawdata + node->datalen - 1) = '\0';
        object->values[i++] = getjNode(prev);
        *(node->rawdata + node->datalen - 1) = '>';
        break;
    } else {
        *cur = '\0';
        object->values[i++] = getjNode(prev);
        *cur = ',';
        prev = cur + 1;
        cur = findNextColon(prev, node->rawdata + node->datalen);
    }
    
}

return object;
%%%
if (*str == 'e' || *str == 'E') {
    str +=1;
    if (*str == '+' || *str == '-')
        str += 1;
    if (*str < '0' || *str > '9') // at least one digit must follow (e|e\+|e-)
        return 0;
    while (*str >= '0' && *str <= '9')
        str += 1;
}
%%%
"Why would you call me by the 'Pearly Lion's Foot,' if I were to volunteer?" asked a bright young fairy.
"For two reasons, your Majesty," answered the old oracle, addressing, not the young volunteer, but the Queen, as was proper.
"First, to reward valor and virtue, by giving an august name; and second, to let the Frost Giants, the insolent fellows from the North Pole, know, that when even one of us fairies puts her foot down, it is like a lion's. No one can move, or lift, or push, or drive it away. We [150]thrust forward this fairy flower, as our banner, to say to the enemy, 'We shall not surrender, and we defy you!' "
The Fairy Queen, full of admiration, replied:
%%%
There, among the great coral trees and groves of gold and silver and amid heaps of shining gems, with a score of maidens to wait on her, valets and footmen and servants of a strange sort, and with food rich and abundant, pleasing and tempting to both eye and palate, and with the most entrancing music ever at her command, she was enraptured. So delighted was she, that the years passed away as days.
%%%
Instead of the heart of a chamois, the rifle [47]bullet struck the monster snowball in the centre, but it hurt the avalanche no more than a flea bite on the end of an elephant's tail.
%%%
The giants told their sons and daughters not to meddle with the human folks, but rather to help them; for the giants, dull as their wits were, were afraid of any creature, that, though smaller than they were, had more brains. They wondered how human beings got such big heads, and they often pounded on each other's skulls, to see if they were hollow inside, like a cocoanut.
%%%
void printjNode(jNode* node, int tabs) {
    // printf("printing\n");
    // printf("type= %d\n", node->type);
    switch (node->type) {
        case jSTRING: {
            printjString(getjString(node), tabs);
            break;
        } case jNUMBER: {
            printjNumber(getjNumber(node), tabs);
            break;
        } case jARRAY: {
            printjArray(getjArray(node), tabs);
            break;
        } case jOBJECT: {
            printjObject(getjObject(node), tabs);
            break;
        } default: {
            printf("Could not parse.\n");
            break;
        }
    }
}
%%%
In other words, this fellow was something altogether different from any sort of fairy in earth, air, sky, water, cave, or mine. Besides, though the demons had the reputation of being always very busy and very smart, they never did anything good, nor helped honest mortals, as the fairies often did.
In truth, the fairies of every sort held their noses, and otherwise showed their dislike, or contempt, whenever any one made mention of the name or the deeds of demons, or devils.
%%%
Dick warned them that they were near the end of the first part of their journey and that the train would stop, when at the level of five thousand feet. Then the temperature would be so high, that they must all be prepared to jump overboard and swim.
At this bit of news, all the family laughed. They said they were glad, for already the palace [231]cars had got so wet with the thaw, inside, that the ceiling dripped on them continually, the seats were slippery, and fast melting away, while as for the floor, it was only a puddle, most of the time. It was a case of watering stock. After all, however, the fairies did not mind it much, and they were only in fun, when they pretended to grumble.
At last, the train, after having made a quick passage of a thousand years, or thereabouts, arrived at its terminal. Then it gradually melted away, becoming a noisy and very muddy river. One after another, the fairies turned themselves into water, and slid out into the stream, rolling about until they reached the beautiful Lake Leman, at the end of which was Geneva. Here they expected to pay a brief visit, of four or five hundred years, before returning home to the mountain tops.
When they arrived at the entrance of the lake, and were well into the deep water, the fairies found waiting for them one of the prettiest craft that ever floated. It was a galley, of strange shape, with a high deck at the bow and the stern. There was plenty of room in the middle for the fairies to play and dance. With their pretty butterfly wings, and lovely gauzy robes, of every tint and hue, they looked so sweet!
%%%
return 0;
%%%
The Father of the Fairies, who used to live along and under the river Rhine, was not able always to control his daughters, after they had grown up. One of them, named Lorelei, a long time ago, used to appear above the current of the great stream, at the place where the water dashes over the rocks and foams high. It was very hard, in that place, or near it, for the sailors to steer their boats, so as not to have them dashed to pieces. Only with cool heads and strong arms could the boatmen get their vessels through in safety.
But if they should stop, to look at the pretty maidens, or to turn their heads to listen to the lovely music which they made, then, they were sure to lose their heads and have the boat go wrong and run upon the rocks. Then, of course, every one on board was thrown into the boiling waves, and drowned. The rocks are so sharp and jagged that, when the boat was upset, the poor people were thrown violently against these, and, even if spared by the waves, were sure to perish.[242]
The fairy, named Lorelei, paid no attention to their cries, but only laughed at them, as they struggled in the water.
%%%
int isCharWhitespace (char ch) {
    return 
        ch == ' ' ||
        ch == '\t' ||
        ch == '\r' ||
        ch == '\n';
}
%%%
char* start = str;
while (*str != '\0')
    str += 1;
while (str > start && isCharWhitespace(*(str - 1)))
    str -= 1;
return str;
%%%
One day, after hearing some of these dreadful stories, the fairy took the form of a Yankee pedestrian tourist, and walked along a well beaten path in the mountains. Coming to a closed gate, which shut off the passage, it was opened for him by a little girl, not ten years old, who said plaintively with tears in her voice:
"Meine Mutter ist gestorben," (My mother is dead).
At this, the kind hearted fairy, in Yankee clothes, nearly dropped his Alpenstock, out of sheer sympathy. Taking out his purse, he was [173]about to hand the child a silver coin; when, looking up at the doorway of the chalet near by, he saw a woman standing and peering out with keen interest. He hesitated a moment, and then inquired, of the little gate-opener, whether that were her mother. She, having learned to speak her piece, but not prompted as to any further question, replied at once "Yes."
%%%
int isjObject (char* str) {
    char* start = str;
    if (*str != '<')
        return 0;
    while (*str != '>') {
        int inString = 0, cbCount = 0, sbCount = 0; // " < [
        char* endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && !cbCount && !inString)
                break;
            else if (*endValue == ':' && !cbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        char endHolder = *endValue;
        *endValue = '\0';
        json_type elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE &&
            *str == '<' && 
            *endValue == '>')
            return endValue - start;

        if (elementType != jSTRING ||
            *endValue == '>')
            return 0;

        str = endValue;

        inString = 0, cbCount = 0, sbCount = 0;
        endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && cbCount == 0 && !inString)
                break;
            else if (*endValue == '[' && !inString)
                sbCount++;
            else if (*endValue == ']' && !inString)
                sbCount--;
            else if (*endValue == ',' && !cbCount && !sbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        endHolder = *endValue;
        *endValue = '\0';
        elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE ||
            elementType == jERROR)
            return 0;

        str = endValue;
    }

    if (*++str == '\0')
        return str - start;
    return 0;
}
%%%
In one breath, both the tailor and the giant asked, "What's the matter?"
Then the man-at-arms told them the trouble. A dragon, living up in the mountains, in a cave had been roaring all night for food. The citizens wanted to feed the criminals, then in prison, to the monster, but he refused such common nourishment. In fact, he was the most particular [125]dragon, as to his diet, that ever came to Switzerland. He required one maiden a day to appease his hunger. He never would be satisfied with boys, or men, or even with ladies, that were either slender or bony.
%%%
All giants behave in about the same way, in every country; so each one of the big-boned fellows in Switzerland was like his relations in other lands. He had two legs, each as thick as a telegraph pole, arms like crowbars, and a body that made one think of a hogshead. His bone box, called a skull, had only a spoonful or two of brains inside of it, for his head was no bigger than a cocoanut. Usually he went about roaring like a bull, and carried a club in his right hand, as long and thick as a young fir tree. Although he was as strong as an ox, he could hardly run as fast as an elephant, and any smart dog could move around more quickly than he. That is the reason why a nimble princess, with a needle, could outwit him, or any clever young fellow could trap him in a pit, and then crack his skull with a pickaxe.
The monstrous fellow had a stomach equal to that of a rhinoceros. At one meal, he could chew up a sirloin of beef, eat a half bushel of rice, and gulp down a firkin of milk. With his club, he [119]could smash a hay wagon; but, besides eating and bullying, he was not good for much. In fact, when it came to a game of hard thinking, and using his two spoonfuls of brains, any clever boy or girl twelve years' old could beat him. Some giants, of course, were more intelligent than others, but as a rule, a giant got very soon and very much tired out, when he had to use his mind.
They do say that the reason why giants are so stupid is because that, when they were quite little babies, their skull bones closed tight, too soon; so that their brains never grew any larger, while the bone became thicker and thicker. That is the reason why some people usually called the big lout, "Mr. Bone Head, with the big club."
%%%
char* start = str;
if (*str != '[')
    return 0;
while (*str != ']') {
    int inString = 0, sbCount = 0, cbCount = 0; // " [
    char* endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '[' && !inString)
            sbCount++;
        else if (*endValue == ']' && sbCount > 0 && !inString)
            sbCount--;
        else if (*endValue == ']' && sbCount == 0 && !inString)
            break;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && !inString)
            cbCount--;
        else if (*endValue == ',' && !sbCount && !cbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    char endHolder = *endValue;
    *endValue = '\0';
    json_type elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jERROR)
        return 0;

    if (elementType == jWHITESPACE &&
        (*str != '[' || *endValue != ']'))
        return 0;
    
    str = endValue;
}

if (*++str == '\0')
    return str - start;
return 0;
%%%
jNode* getjNode (char* str) {
    // printf("creating node\n");
    jNode* node = malloc(sizeof(*node));
    char* start = firstNonSpace(str);
    char* end = firstEndSpace(start);
    node->type = getjNodeType(str);
    node->contents = NULL;
    node->datalen = end - start;
    node->rawdata = malloc(sizeof(*node->rawdata) * (node->datalen + 1));
    for (int i = 0; i < node->datalen; i++)
        node->rawdata[i] = start[i];
    return node;
}
%%%
War broke out. From the new State House, in Philadelphia, then one of the most wonderful buildings in any of the colonies, floated the flag of thirteen stripes, red and white, and independence was proclaimed.
%%%
They say that the soul of Belgium is the carillon. In many a tower, far up in the air hang a hundred bells or more, of all sizes. These are struck by hammers, which are worked by the carillonier, who presses the keyboard, as if playing the piano. Very famous are these chime-masters, and sweet is the music, which sounds in the air. When away from home, in a foreign land, the Belgian gets homesick, amid strangers, and is often down-hearted, because of the silences of the strange country. Should he hear the sweet chimes of a city church, a vision of the home land, with its quaint houses and high towers, its carrier pigeons, and river-dykes, and flower markets, and happy children, playing in the streets, rises before him. Then he thinks of the years of his childhood, in his old home.
%%%
[Contents]
XI
%%%
return 0;
%%%
After the Alpen glow, or rosy light, that flushed the mountains like a maiden's blush, the fairies came out to dance in the meadows. They always went away and disappeared at sunrise, for the dancing fairies would be turned into stone, if the sun's rays struck them. It was even worse for them, than for mortals, who, even amid the ice and snow, when climbing high mountains, might be sunstruck and die. One family of the flowers they named Four o'Clocks.
But by and bye, men learned that they could set two sticks in a line north and south, and the shadow line from one stick would touch the other. They called this time twelve o'clock, or noon. The old men also took notice that, in the long days of summer, the sun lengthened and, in cold winter, shortened its shadows. They were thus able to count the days before the flowers would bloom in the springtime. Then the yodel music would sound and the cows be driven to pasture up in the high mountains.
From this noon shadow of the sun, men got the idea of the sundial. Placing a round disc, or plate, made of brass, or copper, on a stone or [94]post, and setting on one side of it a metal pin, they noticed the sun's shadow going round it in a circle. On the spaces, they marked the hours. Soon, it became the general fashion to have sundials in the gardens.
%%%
"Let me tell you, then, about the kangaroo, that lives in Australia. She has a wallet, or [185]travelling bag where, or in which, she stows away her little folks, and there they are as cozy as if they were riding in a wagon. Yet, all the time, they can look out and see what is going on in the world. In this way, both the young opossums and the kangaroos are kept warm, and are fed until they are grown. No wolves, or bears, or foxes can catch and run away with them."
%%%
But when the age of steam and smoke and puffing locomotives, and boats, with iron chimneys, that breathed out choking gas from their furnaces, and left clouds of blackness on the beautiful blue lakes and landscape, had come, the happy days changed to gloom. Men made railroads up to the very tops of the mountains and stuck their big hotels in the prettiest places, even on the high Alps. They spoiled the village [172]dances, drove away the poor people from their old amusements in summer, and even turned thousands of the once honest Swiss folks into money-grubbers. Then the fairies lost all patience, and determined to call an out door congress, such as the mortals do at the Landsgemeinde, or town meetings, when they talked politics and voted by thousands, raising their hands, to mean "yes" or "no."
One fairy, that was the lawyer and politician of the Swiss fairy world, was especially angry, when it was learned that even the children were taught by their parents to tell lies about their mother being dead-when she was waiting in the chalet, for the money the little girls got by telling doleful tales and thus moving the pity of travelers.
%%%
They say that the soul of Belgium is the carillon. In many a tower, far up in the air hang a hundred bells or more, of all sizes. These are struck by hammers, which are worked by the carillonier, who presses the keyboard, as if playing the piano. Very famous are these chime-masters, and sweet is the music, which sounds in the air. When away from home, in a foreign land, the Belgian gets homesick, amid strangers, and is often down-hearted, because of the silences of the strange country. Should he hear the sweet chimes of a city church, a vision of the home land, with its quaint houses and high towers, its carrier pigeons, and river-dykes, and flower markets, and happy children, playing in the streets, rises before him. Then he thinks of the years of his childhood, in his old home.
In Switzerland, it is not the tower bells, or even the church-spires, sounding out the tollings for a funeral, or the merry peals of wedding bells, [111]or the strokes calling to worship, that so deeply stir the mountain man's heart, as do the yodel music and the carillon of the cows.
%%%
But Gulick moved on, the road narrowing down, between rocks, as many bridle paths in Switzerland do. Yet no sooner had the intelligent beast entered into the shadow, than again a shining angel appeared in the path in front of them, but this time in a threatening manner, and waving his glittering sword.
Startled at the sight, the ass again stopped, hoping its master would treat his own beast more kindly and see what was the matter.
But angry men are nearly always blind, and sometimes half insane, or even wholly so. Gruntli once more drove his already bloody spurs into Gulick's side.
At this, stung with pain, and fearing to rush against the angel, the beast dashed sideways against the rocky wall.
%%%
int isjObject (char* str) {
    char* start = str;
    if (*str != '<')
        return 0;
    while (*str != '>') {
        int inString = 0, cbCount = 0, sbCount = 0; // " < [
        char* endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && !cbCount && !inString)
                break;
            else if (*endValue == ':' && !cbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        char endHolder = *endValue;
        *endValue = '\0';
        json_type elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE &&
            *str == '<' && 
            *endValue == '>')
            return endValue - start;

        if (elementType != jSTRING ||
            *endValue == '>')
            return 0;

        str = endValue;

        inString = 0, cbCount = 0, sbCount = 0;
        endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && cbCount == 0 && !inString)
                break;
            else if (*endValue == '[' && !inString)
                sbCount++;
            else if (*endValue == ']' && !inString)
                sbCount--;
            else if (*endValue == ',' && !cbCount && !sbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        endHolder = *endValue;
        *endValue = '\0';
        elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE ||
            elementType == jERROR)
            return 0;

        str = endValue;
    }

    if (*++str == '\0')
        return str - start;
    return 0;
}
%%%
*(node->rawdata + node->datalen - 1) = '\0';
object->values[i++] = getjNode(prev);
*(node->rawdata + node->datalen - 1) = '>';
break;
 else {
*cur = '\0';
object->values[i++] = getjNode(prev);
*cur = ',';
prev = cur + 1;
cur = findNextColon(prev, node->rawdata + node->datalen);
%%%
int isjArray (char* str) {
    char* start = str;
    if (*str != '[')
        return 0;
    while (*str != ']') {
        int inString = 0, sbCount = 0, cbCount = 0; // " [
        char* endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '[' && !inString)
                sbCount++;
            else if (*endValue == ']' && sbCount > 0 && !inString)
                sbCount--;
            else if (*endValue == ']' && sbCount == 0 && !inString)
                break;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && !inString)
                cbCount--;
            else if (*endValue == ',' && !sbCount && !cbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        char endHolder = *endValue;
        *endValue = '\0';
        json_type elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jERROR)
            return 0;

        if (elementType == jWHITESPACE &&
            (*str != '[' || *endValue != ']'))
            return 0;
        
        str = endValue;
    }

    if (*++str == '\0')
        return str - start;
    return 0;
}
%%%
This enraged Gruntli still further, and he cried out:
"You stupid beast! If you want to climb up into the saddle and ride yourself, I'll jump off."
Then he clutched his whip more tightly, expecting to get down and thrash the animal with all his strength.
%%%
After this event, whenever people saw a falcon, with terrible shining eyes, and beak as sharp as two razors, and with claws and talons, like a steel meat hook, they said, "It must be Chicksha, [104]come to life again." Then they all ran out of their houses to see a thing so wonderful.
%%%
III
THE WONDERFUL ALPINE HORN
When the little boys and girls, who read these Swiss fairy tales, grow up to be big and travel in Switzerland, they will enjoy the Alpine horn.
Nearly every shepherd lad in the mountains knows how to blow it. It is made of wood, and is about half as long as an ordinary broom. Its butt, or heavy end, rests on the ground. When a man blows a long blast, the sound, at first, when one is too near, does not seem to be very pleasing; for distance lends enchantment to the sound. But wait a moment, and listen! Far off across the valley, the strains are caught up, and sent back from the tops of the high mountains. Then it sounds as if a great choir of angels had come down from Heaven to sing glory to God, and to bring greetings to all good souls. Nowhere in all the world is there such sweet music made by echoes.
%%%
int isjWhitespace (char* str) {
    char* start = str;
    while (*str != '\0') {
        if (!isCharWhitespace(*str))
            return 0;
        str += 1;
    }
    return str - start;
}
%%%
return 0;
%%%
return (*str++ == 't' &&
        *str++ == 'r' &&
        *str++ == 'u' &&
        *str++ == 'e' &&
        *str == '\0') ? 4 : 0;
%%%
[Contents]
XVIII
%%%
while (*endValue != '\0') {
    if (*endValue == '"')
        inString = !inString;
    else if (*endValue == '<' && !inString)
        cbCount++;
    else if (*endValue == '>' && cbCount > 0 && !inString)
        cbCount--;
    else if (*endValue == '>' && cbCount == 0 && !inString)
        break;
    else if (*endValue == '[' && !inString)
        sbCount++;
    else if (*endValue == ']' && !inString)
        sbCount--;
    else if (*endValue == ',' && !cbCount && !sbCount && !inString)
        break;
    endValue += 1;
}
%%%
Entering in and peering about him, he discerned four great round lights, like moons. At this, his heart began to beat, his blood to swell in his veins, and his hair to rise, nearly knocking his hat off. He saw two streams of fire issue from beneath and between these shining orbs. After a few seconds, he saw clearly two dragons, that were breathing out streams of fire, that [71]nearly scorched off his eyebrows, while the sulphurous smell nearly knocked him over.
At this, the cooper made the sign of the cross, and prayed for protection. Thereupon, both the dragons, that had got their jaws ready to swallow him, shut their mouths. They crawled up gently, with their tails down, and they gave him to understand that they were friendly, by licking his hands and feet. This they kept on doing, until all the mud, into which he had tumbled, and which had stuck to his clothes, was entirely gone. It was almost like taking a steam bath.
As the winter came on, the appetite of the dragons became less ravenous and they ate little. Like bears and marmots, they went into their cave, and kept very quiet, as if asleep. Moreover, even in summer, when these dragons could not get a supply of maidens, they devoured a sweetish substance, that exuded from a cleft in the rocks, which must have been filled by a colony of bees, for honey trickled plentifully down into the gully. At any rate, the cooper got to like the dragon's winter food so well, that he wondered how he could ever have enjoyed black bread and cheese. In a month, his stomach got quite used to the new diet.
%%%
Hearing the strange noise, the King of the dwarfs turned around to look. In one hand was his skillet, and in the other a ladle and a cloth; and with both he was holding a very hot kettle, full of some liquid. In fact, he was just about to pour out the boiling chocolate over a dish of caramels, made after his own recipe.
But seeing the lazy lubber, wide awake, when he was believed to be fast asleep, the dwarf's [65]whole appearance changed. Instead of smiles, in his usually happy manner, his eyes blazed with wrath, like fire. His face wore one long scowl. He danced with rage, and screamed out,
"So that's the way you keep your word, is it? You ungrateful bumpkin! Take that, and that!"
%%%
while (*endValue != '\0') {
    if (*endValue == '"')
        inString = !inString;
    else if (*endValue == '<' && !inString)
        cbCount++;
    else if (*endValue == '>' && cbCount > 0 && !inString)
        cbCount--;
    else if (*endValue == '>' && cbCount == 0 && !inString)
        break;
    else if (*endValue == '[' && !inString)
        sbCount++;
    else if (*endValue == ']' && !inString)
        sbCount--;
    else if (*endValue == ',' && !cbCount && !sbCount && !inString)
        break;
    endValue += 1;
}
%%%
char* start = str;
if (*str == '-')
    str += 1;

if (*str == '0') {
    str += 1;
} else if (*str >= '1' && *str <= '9') {
    while (*str >= '1' && *str <= '9')
        str += 1;
} else { // number must contian at least one digit
    return 0;
}

if (*str == '.') {
    str += 1;
    if (*str < '0' || *str > '9') // at least one digit must follow '.'
        return 0;
    while (*str >= '0' && *str <= '9')
        str += 1;
}

if (*str == 'e' || *str == 'E') {
    str +=1;
    if (*str == '+' || *str == '-')
        str += 1;
    if (*str < '0' || *str > '9') // at least one digit must follow (e|e\+|e-)
        return 0;
    while (*str >= '0' && *str <= '9')
        str += 1;
}

if (*str == '\0')
    return str - start;

return 0;
%%%
Stumpy was just about to thrust in one of its front paws, through the little round hole, in the [161]bird box, hoping to claw and drag out the four squabs, one by one, and eat them all up; when down came the edge of the avalanche, like ten billion of bricks. It just grazed the bird box, without doing any harm, or hurting the young ones inside, but it flattened out that puss, so that it crawled away alive, but limping, and meowing most piteously, and with one ear ground off by a bit of sharp ice. The mother bird, returning at this moment, seeing the cat, danced around and chirped out what sounded like the Japanese "aru beki" (served you right).
%%%
if (*endValue == '"')
    inString = !inString;
else if (*endValue == '<' && !inString)
    cbCount++;
else if (*endValue == '>' && cbCount > 0 && !inString)
    cbCount--;
else if (*endValue == '>' && cbCount == 0 && !inString)
    break;
else if (*endValue == '[' && !inString)
    sbCount++;
else if (*endValue == ']' && !inString)
    sbCount--;
else if (*endValue == ',' && !cbCount && !sbCount && !inString)
    break;
endValue += 1;
%%%
str +=1;
if (*str == '+' || *str == '-')
    str += 1;
if (*str < '0' || *str > '9') // at least one digit must follow (e|e\+|e-)
    return 0;
while (*str >= '0' && *str <= '9')
    str += 1;
%%%
"For two reasons, your Majesty," answered the old oracle, addressing, not the young volunteer, but the Queen, as was proper.
"First, to reward valor and virtue, by giving an august name; and second, to let the Frost Giants, the insolent fellows from the North Pole, know, that when even one of us fairies puts her foot down, it is like a lion's. No one can move, or lift, or push, or drive it away. We [150]thrust forward this fairy flower, as our banner, to say to the enemy, 'We shall not surrender, and we defy you!' "
The Fairy Queen, full of admiration, replied:
%%%
All the other hunters were happy, too, for chamois meat was plentiful in every chalet. Nevertheless, so many of the herds were, in time, so depleted and the total number in the mountains so lessened, that laws were passed forbidding any hunter, young or old, and no matter how famous, from shooting more than one hundred, during his life time. Yet, even then, there was plenty of meat for all, and very much more than in the old days.
%%%
str += 1;
if (*str < '0' || *str > '9') // at least one digit must follow '.'
    return 0;
while (*str >= '0' && *str <= '9')
    str += 1;
%%%
Some of them at this meeting wanted very much to tell about some of the tricks, which they had played on foolish men, or how they had done a good thing or two to people they liked. There was, however, no time for a long chat, for it was said that much business was on hand. Moreover, the meeting must break up before daybreak.
%%%
char* start = str;
if (*str != '<')
    return 0;
while (*str != '>') {
    int inString = 0, cbCount = 0, sbCount = 0; // " < [
    char* endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && !cbCount && !inString)
            break;
        else if (*endValue == ':' && !cbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    char endHolder = *endValue;
    *endValue = '\0';
    json_type elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE &&
        *str == '<' && 
        *endValue == '>')
        return endValue - start;

    if (elementType != jSTRING ||
        *endValue == '>')
        return 0;

    str = endValue;

    inString = 0, cbCount = 0, sbCount = 0;
    endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && cbCount == 0 && !inString)
            break;
        else if (*endValue == '[' && !inString)
            sbCount++;
        else if (*endValue == ']' && !inString)
            sbCount--;
        else if (*endValue == ',' && !cbCount && !sbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    endHolder = *endValue;
    *endValue = '\0';
    elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE ||
        elementType == jERROR)
        return 0;

    str = endValue;
}

if (*++str == '\0')
    return str - start;
return 0;
%%%
void printjNode(jNode* node, int tabs) {
    // printf("printing\n");
    // printf("type= %d\n", node->type);
    switch (node->type) {
        case jSTRING: {
            printjString(getjString(node), tabs);
            break;
        } case jNUMBER: {
            printjNumber(getjNumber(node), tabs);
            break;
        } case jARRAY: {
            printjArray(getjArray(node), tabs);
            break;
        } case jOBJECT: {
            printjObject(getjObject(node), tabs);
            break;
        } default: {
            printf("Could not parse.\n");
            break;
        }
    }
}
%%%
Often some of the fairies wondered how it would feel to be born as a baby, and drink milk, and eat candy, and first crawl over the floor, and then walk and grow up to be a man or a woman. They could only guess vaguely what it was to die. For that is the curious thing about fairies, they cannot die, because they were never born. They do not have to grow like human babies, or big elephants, or little kangaroos, or be hatched out of eggs, like chickens, or wriggle in the ponds, or swim in the water like frogs, or fishes, or whales, or porpoises. Once in a while, some fairy thought she would like to try it, just once, to live and die, just to see how it felt, but the other fairies, who did not admire her taste, only laughed at her.[226]
%%%
It was wonderful how the pretty fairies were perfectly willing to be changed into humble looking plants, that never could grow very tall, but lie quite flat on the ground, and have deep roots in the crannies. They would have to live without much society, or excitement, and spend their lives in clefts and hollows. What was hardest to bear, was, that most of them would have to live like nuns; for in the case of many of them, [82]their beauty would never be appreciated or even seen.
Some were glad even to become plain meadow grasses. When one plump fairy was told she would become an Alpine Poa, and must carry her babies on her back, she gladly consented saying, "I am willing."
The enthusiasm for the war became an epidemic. Some of the big fairies asked to be changed into trees-oak, maple, spruce, pine, or birch. This was hard, for those who had been regular chatterboxes would now be able only to sough in the breeze, or whisper in the winds, and they could roar only in a gale or tempest. Some even begged to be allowed to take on the form of the old-fashioned arolla, the most ancient of all the Swiss trees.
%%%
char* start = str;
if (*str != '[')
    return 0;
while (*str != ']') {
    int inString = 0, sbCount = 0, cbCount = 0; // " [
    char* endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '[' && !inString)
            sbCount++;
        else if (*endValue == ']' && sbCount > 0 && !inString)
            sbCount--;
        else if (*endValue == ']' && sbCount == 0 && !inString)
            break;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && !inString)
            cbCount--;
        else if (*endValue == ',' && !sbCount && !cbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    char endHolder = *endValue;
    *endValue = '\0';
    json_type elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jERROR)
        return 0;

    if (elementType == jWHITESPACE &&
        (*str != '[' || *endValue != ']'))
        return 0;
    
    str = endValue;
}

if (*++str == '\0')
    return str - start;
return 0;
%%%
Nevertheless, for a third time, the sagacious beast ran away. When the stable boy, out of patience, rushed into the wine room, and told the overseer of the strange behavior of his donkey, Gulick, the man had sense enough to follow the mule train.
Well for him and his master, that he did so, for, when hearing a frightful noise, he looked behind him, from the top of the hill, he saw a landslide, from the mountain flank, wipe out the whole town, leaving the houses, people and cattle buried under one white pall of earth, rock and snow.
After this, one would suppose that the owner [255]of Gulick would fully trust the animal's wonderful instinct and unerring vision, as well as his sure footedness.
But this man, Gruntli was, as he called himself, "too much of a man of science" to consider such an affair, as that of Gulick and the landslide, as anything but an accident, a coincidence, or, as an example of "the doctrine of averages."
%%%
So by and bye, after a few millions of years had passed by, the fairies, who never die of old age, got together in a meeting. After talking the matter over, they resolved to have a flower that could fight the frost giants, by laughing in their faces, and keep on growing, no matter how hard the winds blew, or how deep the snow was, or how often the avalanches fell, or glaciers formed. Besides being able to live, and find its own food, by rooting itself deep in the crevices of the rocks, such a flower ought to be sweet, and taste good to the cows.
%%%
(*str < 'a' || *str > 'f')) {
return 0;

%%%
Amused at this, she stood and watched, while [51]perched on a boulder, looking on with wonder. Then the young giantess burst out laughing.
"How funny, to make stripes, and little gutters, all along the ground," she said to herself. Then, she walked up to where the man was and lifting him, his plough, and both his horses, in one of her big hands, she held out her apron, open wide, and dropped the whole lot, man, team, and tools into it. These she took home to play with, on the cave floor. Her mother looked on and enjoyed the fun, as her daughter pulled the horses' tails, and made them kick. She forced the man to dance on her thumb nail, and used the iron end of the plough to clean her finger nails. The man talked and whined and wanted to go home to his wife and babies, but the giantess, Bertha, could not understand, a word he said. So she spoke to her mother thus:
"This must be his way of frowning, like a wolf cub. Or, maybe he is chattering, like a monkey. Or is he crying? Do you suppose?"
At this, the shadow of Old Gargy darkened the cave door. He saw what was being done, and instantly ordered the release of the man and his horses. Then he lifted his club, as a sign of securing obedience.
%%%
First the dwarf loaded the gun and then, with a mallet, pounded on the ramrod, to drive the lead of the bullet well into the grooves. Then, taking aim, he pulled the trigger. The bullet struck the disc, knocking the pretty crystal to pieces.
By this time the hunter, asleep in the cave, began to dream, and the fairy whispered the secret in his ear. With both sight and hearing, he saw and understood all.
Awaking, the hunter found his old blunderbuss gone. In its place lay the rifle, and a beauty it was, lighter to carry, more graceful in shape, and requiring less powder and lead. For one who had to climb mountains, this was a great benefit. So he at once loaded his new piece, so as to be ready for the first chamois he should see. He thought it would be fine fun to carry home a prize, in addition to his new weapon.
He had hardly stepped out of the topaz cave, [140]which seemed to close like a door behind him, than there appeared in view four chamois, each full grown and with splendid horns. Putting his rifle to his shoulder and taking careful aim, though the distance was great, he fired. Instantly, there fell the finest of the animals, while the others scampered away.
%%%
int isjWhitespace (char* str) {
    char* start = str;
    while (*str != '\0') {
        if (!isCharWhitespace(*str))
            return 0;
        str += 1;
    }
    return str - start;
}
%%%
str +=1;
if (*str == '+' || *str == '-')
    str += 1;
if (*str < '0' || *str > '9') // at least one digit must follow (e|e\+|e-)
    return 0;
while (*str >= '0' && *str <= '9')
    str += 1;
%%%
if (containsDecimalOrExponent(node->rawdata, node->datalen)) {
    number->isInt = 0;
    number->dvalue = atof(node->rawdata);
    number->ivalue = (int)number->dvalue;
} else {
    number->isInt = 1;
    number->ivalue = atoi(node->rawdata);
    number->dvalue = (double)number->ivalue;
}
%%%
void freejString(jString* string) {
    if (string->holder != NULL) {
        freejNode(string->holder);
        return;
    }
    free(string->chars);
    free(string);
}
%%%
Many people think Switzerland the most beautiful country on earth. It is certainly the world's playground. Every year, many hundreds of thousands of persons from various countries, go there to spend either the winter or the summer. They come to enjoy the good sleep that comes from the bracing air, to climb the high peaks, to see the flowers, to hear the echoes of the Alpine horn, to ride over the mountain roads, or to be whisked up, on electric railways, to summits among the clouds. With most of the tourists, the effect of the sharp atmosphere is to whet their appetites, even more than their wits; but perhaps this is what they seek.
The sick and the well alike get vast benefit. They think it great fun to find so much ice and snow, and also so much sunshine, as if winter and summer liked to play together. In February, hardy and strong people enjoy sledding and sliding, besides skis and skittles, and [78]many other merry sports. Children go out on sleds, with almost nothing on them, to enjoy the air baths.
Yet Switzerland was not always a flowery playground, rich in splendid hotels, where the boarders' bills catch the spirit of the place and become mountain climbers. For ages, it was a sort of North Pole, set in the middle of Europe, frozen in, tight and fast, and with mountains of snow and rivers of ice, where no animals could live. In this age, everything was white. Then there were no animals, men, women, children or babies; no flowers, no birds, no fish; no farms, no vineyards, but only dreadful cold, all the year round, and for millions of years.
%%%
jString* getjString(jNode* node) {
    if (node->type != jSTRING)
        return NULL;
    if (node->contents != NULL)
        return (jString*)node->contents;
    jString* string = malloc(sizeof(*string));
    node->contents = (void**)string;
    string->holder = node;
    string->length = node->datalen - 2;
    string->chars = malloc(sizeof(*string->chars) * (string->length + 1));
    for (int i = 0; i < node->datalen - 2; i++)
        string->chars[i] = node->rawdata[i + 1];
    string->chars[string->length] = '\0';
    return string;
}
%%%
if (*endValue == '"')
    inString = !inString;
else if (*endValue == '<' && !inString)
    cbCount++;
else if (*endValue == '>' && cbCount > 0 && !inString)
    cbCount--;
else if (*endValue == '>' && cbCount == 0 && !inString)
    break;
else if (*endValue == '[' && !inString)
    sbCount++;
else if (*endValue == ']' && !inString)
    sbCount--;
else if (*endValue == ',' && !cbCount && !sbCount && !inString)
    break;
endValue += 1;
%%%
"And I'll make the new contrivance sing. No longer shall a timekeeper be called a bell, to strike or sound the hours. I'll put a bird inside, to fly out and call out the hours."
So the next night, the Queen of the Fairies took counsel of the owl, the wisest of all the birds, and also as fair-minded as a judge, who is just to all and the favorite of none. The owl decided that the cuckoo would serve best, and could be [97]most depended upon always to come out, flap its wings, and chirp out the proper numbers of the hours.
The Fairy Queen was surprised. "How can you, sir Judge, nominate a bird of bad character? The cuckoo is a pirate. Does it not lay its eggs in the nests of other birds? How often, besides stealing their homes, it throws out the eggs of the rightful owners, and, because of this robbery, the birdies die."
%%%
As a rule, nobody knows, either in summer or winter, just when the avalanches will fall, or whether they will be made of light, powdery, dry snow, or of snow that is heavy, wet, and like what the boys call "soakers." Yet there are some old men in Switzerland, who can foretell avalanches, as our wise men try to do with the weather.
Once upon a time, the Frost Giant's baby, of which we are going to tell, was born, and great things were expected of it, even when it was only as big as a snowflake. But, when it grew up, to be a real avalanche, it behaved very differently from all the others. It disappointed its daddy and its uncles awfully. The Frost Giants like to make all the mischief they can, while this one wanted to help men, instead of hurting them, and made a new record in the history of colossal snowballs.
%%%
while (*endValue != '\0') {
    if (*endValue == '"')
        inString = !inString;
    else if (*endValue == '<' && !inString)
        cbCount++;
    else if (*endValue == '>' && cbCount > 0 && !inString)
        cbCount--;
    else if (*endValue == '>' && cbCount == 0 && !inString)
        break;
    else if (*endValue == '[' && !inString)
        sbCount++;
    else if (*endValue == ']' && !inString)
        sbCount--;
    else if (*endValue == ',' && !cbCount && !sbCount && !inString)
        break;
    endValue += 1;
}
%%%
for (int i = 0; i < 4; i++) {
    str += 1;
    if ((*str < '0' || *str > '9') &&
        (*str < 'a' || *str > 'f')) {
        return 0;
    }
}
%%%
char* firstNonSpace (char* str) {
    while (isCharWhitespace(*str))
        str += 1;
    return str;
}
%%%
There were many girls in Japan, named Taka, which means a hawk, because of their bad temper, or their cruelty to puppies or kittens. Sometimes, however, the name was a compliment, because they were quick and smart, like falcons.
Now, according to these ideas, there was a very hard-hearted man, named Chicksha, who beat his children. When angry, he threw dishes at his wife and cursed his servants. One day, when in a fit of bad temper, he fell dead. No one was sorry, and some were even glad.
After this event, whenever people saw a falcon, with terrible shining eyes, and beak as sharp as two razors, and with claws and talons, like a steel meat hook, they said, "It must be Chicksha, [104]come to life again." Then they all ran out of their houses to see a thing so wonderful.
%%%
case jSTRING: {
    printjString(getjString(node), tabs);
    break;
} case jNUMBER: {
    printjNumber(getjNumber(node), tabs);
    break;
} case jARRAY: {
    printjArray(getjArray(node), tabs);
    break;
} case jOBJECT: {
    printjObject(getjObject(node), tabs);
    break;
} default: {
    printf("Could not parse.\n");
    break;
}
%%%
return 0;
%%%
Yet when the sun got up early in the morning, and the south wind blew with a quiet force that did more in a day's work than a million steam shovels, the snow melted, and soon the green meadows were spangled with red and blue, yellow and white flowers.[4]
When June came, the big boys got ready, with their fathers and hired men, to leave their village home, and go up to spend the whole summer on the spicy pastures, that is, the Alps, high up on the mountains, to stay until near October. There the bees would gather honey from the nectar in the blossoms, and cows would feed on the sweet juices of the grass. It was at this season that the milk, cream, butter and cheese, were the very best of the year. Many a growing boy, counting on his fingers the days, looked forward for months to life outdoors, on the highlands, among the birds, the butterflies and the wild animals. As for the cattle, they could sniff the sweet aroma of the flowery fields and grasses at a distance and long before men could.
The day of the great cow parade, when the other four-footed animals, dogs, goats, pigs, horses and donkeys, joining in, was the greatest of the year. Then the leading cow, named Lady, or Queenie, or Cleopatra, often carrying the milking stool on her head, between her horns, led the procession. The girls were all out in their best clothes to deck the hats of the daddies with wreaths and blossoms, and to say and wave good-byes. Pretty nearly every one was decorated with flowers.
%%%
Retrieving his prize, Walter started down the mountain with the buck on his back. Reaching home, his wife embraced him, and all his children gathered round him, while his dog frisked about him in delight. Then he told the whole story.
%%%
int isjTrue (char* str) {
    return (*str++ == 't' &&
            *str++ == 'r' &&
            *str++ == 'u' &&
            *str++ == 'e' &&
            *str == '\0') ? 4 : 0;
}
%%%
freejNode(object->keys[i]);
freejNode(object->values[i]);
%%%
For instance, there were several of the Herwisch folk, or first cousins to the Will-o'-the-wisp. Several dozen of little creatures of this family, not much bigger than dolls, were on hand. They live on marshy ground and delight in lighting their little lanterns at night. Then they entice bumpkins and other dull fellows, out of the regular path in the fields, into the mud and swamp. When the clumsy chaps are floundering deep in the water, and down among the frogs and tadpoles, the Herwisch put out their lights and leave the louts in the wet, all the while laughing at them. Stupid fellows from the grog and beer shops, with their brains befuddled, are the chief victims of these merry mischiefs. It is good to see how many a drunkard gets a ducking and cooling off from these tiny tots.[196]
%%%
Old Sol declared that, with the aid of the fairies, he would make Switzerland the most beautiful of all countries, so that many people from foreign lands would come to see it. He would scoop out lakes, channel out rivers, smooth the face of the country, and make it lovely with pastures, rich in cows and goats, and spangled with flowers of many hues. Yes, if the fairies would promise to put enough clothes on their favorites, and wrap them up in downy undergarments, with lots of fur and wool for overcoats, he would help the prettiest flowers to climb up to the high mountains. Then he would promise to furnish heat enough, so that they could keep warm and live there. He would make it so pleasant for them, that they would never get homesick, or want to go back to their mothers in the valley below. In spite of the frost giants, the storms and winds, the tempests, and the icy breath of the giants, these flowers would bloom, and nod, and laugh at and defy all enemies.
%%%
commaCount++;
cur = findNextComma(cur + 1, node->rawdata + node->datalen);
%%%
while (cur != NULL) {
    commaCount++;
    cur = findNextComma(cur + 1, node->rawdata + node->datalen);
}
%%%
Buttermilk and potatoes, and corn meal, boiled in goat's milk, was what was on the bill of fare for Walter's family, most of the time. They [134]were too poor to live down in the valleys, or villages, where the land was all owned by well-to-do people. So the entire family, old and young, were kept busy at work, every moment of daylight in summer, when the snow was off the ground. There were many things to do, to get fuel, to keep the roof from leaking, and to prepare for the awful cold, from September to May.
Walter's chief trouble was with his poor gun, the barrel of which was a smooth bore, which could not shoot a bullet straight forward, very far, so that the hunter could not be sure of hitting anything that was over fifty yards away.
Sometimes, Walter would spend many hours, or even a whole day, while out hunting, in climbing over rocks and up the steep mountain sides, to get even a distant shot at a chamois, only to miss his aim. Or, what was even worse, to this kind-hearted hunter, the leaden ball, going out of its course, only wounded the poor animal, so that it ran away, to suffer a long time and then die in pain. In this manner, Walter very often lost a dinner for himself and his hungry children, while he grieved over inflicting pain upon innocent creatures. More than once, he threw down the gun, in his anger, calling it names, as if it were an animal, or, at the worst, a "blunder buss."
%%%
colonCount++;
cur = findNextColon(cur + 1, node->rawdata + node->datalen);
%%%
if (string->holder != NULL) {
    freejNode(string->holder);
    return;
}
free(string->chars);
free(string);
%%%
int inString = 0, cbCount = 0, sbCount = 0;
for (char* cur = start; cur < end; cur += 1) {
    if (*cur == '\0')
        return NULL;
    else if (*cur == '"')
        inString = !inString;
    else if (*cur == '[' && !inString)
        sbCount++;
    else if (*cur == ']' && !inString)
        sbCount--;
    else if (*cur == '<' && !inString)
        cbCount++;
    else if (*cur == '>' && !inString)
        cbCount--;
    else if (*cur == ':' && !inString && !cbCount && !sbCount)
        return cur;
}
return NULL;
%%%
Then he clutched his whip more tightly, expecting to get down and thrash the animal with all his strength.
But Gulick moved on, the road narrowing down, between rocks, as many bridle paths in Switzerland do. Yet no sooner had the intelligent beast entered into the shadow, than again a shining angel appeared in the path in front of them, but this time in a threatening manner, and waving his glittering sword.
Startled at the sight, the ass again stopped, hoping its master would treat his own beast more kindly and see what was the matter.
%%%
freejNode(array->holder);
return;
%%%
At this, the cooper made the sign of the cross, and prayed for protection. Thereupon, both the dragons, that had got their jaws ready to swallow him, shut their mouths. They crawled up gently, with their tails down, and they gave him to understand that they were friendly, by licking his hands and feet. This they kept on doing, until all the mud, into which he had tumbled, and which had stuck to his clothes, was entirely gone. It was almost like taking a steam bath.
As the winter came on, the appetite of the dragons became less ravenous and they ate little. Like bears and marmots, they went into their cave, and kept very quiet, as if asleep. Moreover, even in summer, when these dragons could not get a supply of maidens, they devoured a sweetish substance, that exuded from a cleft in the rocks, which must have been filled by a colony of bees, for honey trickled plentifully down into the gully. At any rate, the cooper got to like the dragon's winter food so well, that he wondered how he could ever have enjoyed black bread and cheese. In a month, his stomach got quite used to the new diet.
He was not afraid of the dragons, and they seemed to enjoy his company. Perhaps they thought that, when the spring should come, he [72]might tell them, when his wife went abroad out of the house; and then, if starving, they might make a dinner of her.
%%%
jNode* getjNode (char* str) {
    // printf("creating node\n");
    jNode* node = malloc(sizeof(*node));
    char* start = firstNonSpace(str);
    char* end = firstEndSpace(start);
    node->type = getjNodeType(str);
    node->contents = NULL;
    node->datalen = end - start;
    node->rawdata = malloc(sizeof(*node->rawdata) * (node->datalen + 1));
    for (int i = 0; i < node->datalen; i++)
        node->rawdata[i] = start[i];
    return node;
}
%%%
if (*endValue == '"')
    inString = !inString;
else if (*endValue == '<' && !inString)
    cbCount++;
else if (*endValue == '>' && cbCount > 0 && !inString)
    cbCount--;
else if (*endValue == '>' && cbCount == 0 && !inString)
    break;
else if (*endValue == '[' && !inString)
    sbCount++;
else if (*endValue == ']' && !inString)
    sbCount--;
else if (*endValue == ',' && !cbCount && !sbCount && !inString)
    break;
endValue += 1;
%%%
jString* getjString(jNode* node) {
    if (node->type != jSTRING)
        return NULL;
    if (node->contents != NULL)
        return (jString*)node->contents;
    jString* string = malloc(sizeof(*string));
    node->contents = (void**)string;
    string->holder = node;
    string->length = node->datalen - 2;
    string->chars = malloc(sizeof(*string->chars) * (string->length + 1));
    for (int i = 0; i < node->datalen - 2; i++)
        string->chars[i] = node->rawdata[i + 1];
    string->chars[string->length] = '\0';
    return string;
}
%%%
*cur = '\0';
object->keys[i] = getjNode(prev);
*cur = ':';
prev = cur + 1;
cur = findNextComma(prev, node->rawdata + node->datalen);
if (cur == NULL) {
    *(node->rawdata + node->datalen - 1) = '\0';
    object->values[i++] = getjNode(prev);
    *(node->rawdata + node->datalen - 1) = '>';
    break;
} else {
    *cur = '\0';
    object->values[i++] = getjNode(prev);
    *cur = ',';
    prev = cur + 1;
    cur = findNextColon(prev, node->rawdata + node->datalen);
}

%%%
On the prow of the ship stood their Queen, [232]who ruled over the lowlands and lake waters, and was captain of this fairy vessel. The smallest of the fairies were continually flitting round the queen, dropping flowers and fruits, and filling the air with perfumes. The vessel had sails of the shape called lateen, or leg-of-mutton. These were made of embroidered silk and cloth of gold. For even more rapid movement, several snow white swans, swift of feet and bright of eye, were harnessed, with silver chains, to the front part, called the cut-water. These drew the ship along gracefully, all the time singing in chorus the sweetest songs imaginable. Accompanying this music was a large golden harp, set in front of the mast, and this, whispered to by the winds, made, with the swans' songs, the most delicious melody all day long.
Some of the fairies remembered the echo music of the Alpine horn, sent back by the lofty mountain peaks; which, however, lasted but a few seconds. Yet this lake melody continued from sunrise to sunset.
Whenever the Fairy Ship touched the shore, the ground, no matter how hard and stony it had been, at once became soft with soil. Then, grasses, and flowers, grain farms and orchards, and trees rich in luscious fruits, sprang up. Every boy and girl, always on the lookout, and adults, who were so fortunate as to catch a [233]glimpse of the Fairy Ship, would make a wish in their hearts, which was sure to be gratified. They got what they wanted, though often in fairy time, that is, years afterwards.
For years and years, the Fairy Ship plied up and down the lovely blue lake, stopping here and there. A moonlight night was the best time for catching a glimpse of it. Many old folks, still living, like to tell about the craft of good fortune, and also what they then wished for, when they were so happy as to see it coming, or sailing past them.
%%%
So by and bye, after a few millions of years had passed by, the fairies, who never die of old age, got together in a meeting. After talking the matter over, they resolved to have a flower that could fight the frost giants, by laughing in their faces, and keep on growing, no matter how hard the winds blew, or how deep the snow was, or how often the avalanches fell, or glaciers formed. Besides being able to live, and find its own food, by rooting itself deep in the crevices of the rocks, such a flower ought to be sweet, and taste good to the cows.
In this way pastures would be coaxed to cover the meadows of the high Alps with their green glory, well spangled with blooms. Then men could get milk and make butter and cheese. The fairies liked good boys and girls, and were always glad to help their fathers and mothers, and they also loved meadows, with plenty of flowers and grass, for their moonlight dances. They never enjoyed this, their favorite amusement, so much as when, in the spring, the fields or the heights were both fragrant and beautiful.
%%%
When spring time came, the girls went blossom hunting. One very common flower, which they had known in Switzerland, the Pearly Everlasting, somehow reminded them of the Edelweiss. Daddy, who loved trees, almost to worship, saluted the same species as those which he had seen growing in the Old World-fir, birch, pine, and oak; but the persimmon tree was new to him and he enjoyed the autumn fruit, which the frost seemed to ripen; while the sugar maple was as good as a fairy tale, for the idea of a tree bearing candy was wonderful. In fact, the Harbys hailed the trees as friends, true and tried, with reverence and awe.
%%%
int isjWhitespace (char* str) {
    char* start = str;
    while (*str != '\0') {
        if (!isCharWhitespace(*str))
            return 0;
        str += 1;
    }
    return str - start;
}
%%%
char* start = str;
while (*str != '\0') {
    if (!isCharWhitespace(*str))
        return 0;
    str += 1;
}
return str - start;
%%%
if (*endValue == '"')
    inString = !inString;
else if (*endValue == '<' && !inString)
    cbCount++;
else if (*endValue == '>' && cbCount > 0 && !inString)
    cbCount--;
else if (*endValue == '>' && cbCount == 0 && !inString)
    break;
else if (*endValue == '[' && !inString)
    sbCount++;
else if (*endValue == ']' && !inString)
    sbCount--;
else if (*endValue == ',' && !cbCount && !sbCount && !inString)
    break;
endValue += 1;
%%%
Down in the Valley, the farmer's wife, although the sky was blue, and the sun shining, thought it was thundering, or that an avalanche had fallen down the mountain; but it was only the giant family showing how happy they were, at eating the food of human beings.
"So you see, daughter Bertha," said Old Gargy, her daddy, "what these human creatures can do for us. So, do you let them alone; and, in the future, harm them not, even in play. Then [53]they will give us more bread and cheese and milk."
%%%
while (cur != NULL) {
    commaCount++;
    cur = findNextComma(cur + 1, node->rawdata + node->datalen);
}
%%%
Now the supply of plump and beautiful girls had actually run so low, that the new victims had to draw lots. This very day, the lot had fallen on the King's only daughter, and at sunrise the next day, she was to be swallowed up.
%%%
When he woke up in the morning, out of his sleep, old Soft Pudding stretched out his hands [99]to receive the gift, but it was daylight, and, of course, the fairy was gone. It was the common light of the sun, but he was very happy, even though he had only dreamed. He proceeded at once to turn his dream into reality, by constructing the clock.
Within a week, he had made the works. Then, he set them inside a black walnut case, with ivory figures on the dial. After several attempts, he succeeded with the wooden cuckoo, that would come out, flap its wings, and chirp the number of the hours, and go inside the shut doors, while the clock face also marked the proper point.
%%%
// printf("printing\n");
// printf("type= %d\n", node->type);
switch (node->type) {
    case jSTRING: {
        printjString(getjString(node), tabs);
        break;
    } case jNUMBER: {
        printjNumber(getjNumber(node), tabs);
        break;
    } case jARRAY: {
        printjArray(getjArray(node), tabs);
        break;
    } case jOBJECT: {
        printjObject(getjObject(node), tabs);
        break;
    } default: {
        printf("Could not parse.\n");
        break;
    }
}
%%%
THE FAIRIES' PALACE CAR
Once upon a time, the fairies that live up near the mountain tops got together, and one said to another:
%%%
if (number->holder != NULL) {
    freejNode(number->holder);
    return;
}
free(number);
%%%
Never again was the Lorelei seen by man. [249]The people, who live around the old place of moonlight music, say that the siren felt insulted at this invasion of her domain. In her view, what were the lives of a few sailors, and the loss of one fisherman's son, for a lover, compared with such music as she gave so freely?
So, to punish foolish men, she has never again left her shining caves, under the Rhine, to appear on earth. Yet, inspired by her example, the musicians have continued her sweet music, while the poets never weary of telling her story in their rhymes and stanzas.[250]
[Contents]
XXIV
%%%
return (*str++ == 'f' &&
        *str++ == 'a' &&
        *str++ == 'l' &&
        *str++ == 's' &&
        *str++ == 'e' &&
        *str == '\0') ? 5 : 0;
%%%
After this, one would suppose that the owner [255]of Gulick would fully trust the animal's wonderful instinct and unerring vision, as well as his sure footedness.
%%%
while (*str != ']') {
    int inString = 0, sbCount = 0, cbCount = 0; // " [
    char* endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '[' && !inString)
            sbCount++;
        else if (*endValue == ']' && sbCount > 0 && !inString)
            sbCount--;
        else if (*endValue == ']' && sbCount == 0 && !inString)
            break;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && !inString)
            cbCount--;
        else if (*endValue == ',' && !sbCount && !cbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    char endHolder = *endValue;
    *endValue = '\0';
    json_type elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jERROR)
        return 0;

    if (elementType == jWHITESPACE &&
        (*str != '[' || *endValue != ']'))
        return 0;
    
    str = endValue;
}
%%%
THE PALACE UNDER THE WAVES
Fashions change in the fairy world, as well as among mortals who live on the earth. The Swiss water fairies, called Undines, at times grew tired of living down below the surface of the lakes and rivers. When restless, they longed to mingle in the village gatherings. They wanted to hear the lively music of the young men and maidens, as they sang and danced. Their favorite time for waltzes and cotillions was on moonlight nights.
So it became quite common, at these times, for the fairy maids and swains to swim up to the shore. Then these Undines changed themselves into girls and young men. They put on clothes, that were deep green, the color of the waves. Slipping in among the dancers, they joined in the fun and merry making. In this manner, many a lad romped with a water fairy and even kissed her, thinking she was or might be his sweetheart; for, in the dim light of the moon, it was not always easy to see clearly the face of one's partner. Many a lassie received an embrace, [202]or a salute on the lips, from a lively dancer, whom she supposed was a new comer. He might not be well known in the village, she thought, though he appeared graceful and dressed very nicely, in sea green, gauzy clothes.
%%%
"First, to reward valor and virtue, by giving an august name; and second, to let the Frost Giants, the insolent fellows from the North Pole, know, that when even one of us fairies puts her foot down, it is like a lion's. No one can move, or lift, or push, or drive it away. We [150]thrust forward this fairy flower, as our banner, to say to the enemy, 'We shall not surrender, and we defy you!' "
The Fairy Queen, full of admiration, replied:
"We bow to your wisdom, and so it shall be written in our books. Nevertheless, both mortals and fairies must have also a short name for everyday use. How about the second, or personal part, Margarita?"
"As you will, your Highness, but may I suggest even a better term, in the speech of the mortals of this mountain land? They will love anything that you may clothe and adorn, I am sure."
%%%
Nearly every shepherd lad in the mountains knows how to blow it. It is made of wood, and is about half as long as an ordinary broom. Its butt, or heavy end, rests on the ground. When a man blows a long blast, the sound, at first, when one is too near, does not seem to be very pleasing; for distance lends enchantment to the sound. But wait a moment, and listen! Far off across the valley, the strains are caught up, and sent back from the tops of the high mountains. Then it sounds as if a great choir of angels had come down from Heaven to sing glory to God, and to bring greetings to all good souls. Nowhere in all the world is there such sweet music made by echoes.
Sometimes there is a double set of echoes, like one rainbow inside of another. Then, it makes one think of a choir of little angels, that sing a [29]second time, after the first heavenly chorus has ceased.
How the Swiss people first received the Alpine horn, as a gift from the fairies, is told in the story of a faithful shepherd's boy, named Perrod. He had to work hard all day, in tending the cows that grazed on the high mountain pastures, which the natives call the Alps. But when foreign people speak of "the Alps," they mean the ranges of mountains themselves.
In winter, these level stretches of ground are covered with snow and ice, but by the month of June, it is warm enough for the grass and flowers to grow. Then the cowboys and cheese makers go up with their cattle. At night, Perrod, having milked the cows, skimmed the cream off the milk, hung the great caldron over the fire, and made the cheese.
%%%
Many people said that some of these used to live still further back and long ago, in certain mountains and caves which could be pointed out, but they went away forever, after the good saint Fridolin, and others came to St. Gall and Appenzell, from Ireland, a thousand years ago. When the idolators, in China or Japan, would build a temple for their idols, they inscribed it on their bells that "gods, as well as devils," have paid or subscribed money to help rear the structure.
But Swiss fairies are better educated, and they have nothing to do with either "gods" or "devils." These creatures have no reputation in Switzerland, and are not received into fairy society; for the Swiss fairies approve of churches and never hurt them, or the good people who go to them.[175]
%%%
while (cur != NULL) {
    commaCount++;
    cur = findNextComma(cur + 1, node->rawdata + node->datalen);
}
%%%
if (string->holder != NULL) {
    freejNode(string->holder);
    return;
}
free(string->chars);
free(string);
%%%
if (node == NULL)
    return;
*node->contents = NULL; // node->contents->holder
switch (node->type) {
    case jSTRING:
        freejString((jString*)node->contents);
        break;
    case jNUMBER:
        freejNumber((jNumber*)node->contents);
        break;
    case jARRAY:
        freejArray((jArray*)node->contents);
        break;
    case jOBJECT:
        freejObject((jObject*)node->contents);
        break;
    default:
        break;
}
free (node->rawdata);
free (node);
%%%
Above, there first rose a stalk, a few inches high, until it reached half a foot. Then the [154]arms multiplied and stretched out. They were densely covered, like sleeves of overcoats, with thick coverings, each resembling white flannel, or velvet, and as warm as the fur of an ermine.
"Looks as if she had on an ulster," said one of the many fairies, some of whom thought she looked too sweet for any use.
%%%
This Lorelei, the chief of the river fairies, was never seen during the day, for during the sunlight she loved to sit among her jeweled caves, and remain far down below in the cool depths of the waters. During daylight hours, if any mortal tried to catch even a glimpse of her, he sought in vain. It thus happened that some people, and even boatmen on their way down to Rotterdam, laughed at the idea of there being a Lorelei, or any other fairy among the rocks.
But when the moon was at its full and shone brightest, and its silvery beams seemed to turn into a fairy-like gauze, woven of mist and moonbeams, the Lorelei was in her happiest mood.
%%%
printf("{\n");
for (int i = 0; i < object->size; i++) {
    printTabs(tabs + 1);
    printjNode(object->keys[i], tabs + 1);
    printf(": ");
    printjNode(object->values[i], tabs + 1);
    if (i < object->size - 1)
        printf(",");
    printf("\n");
}

printTabs(tabs);
printf("}");
%%%
XV
THE AVALANCHE THAT WAS PEACEMAKER
Sometimes judges and lawyers advise people, that have a quarrel, to settle their case outside of court. When a person thus decides between two, who are not agreed, we say that they are judicially minded. Now there was once, in Switzerland, an avalanche, that did what peacemakers and honest judges could not accomplish. So it was called the Judicial Avalanche.
%%%
void freejArray(jArray* array) {
    if (array->holder != NULL) {
        freejNode(array->holder);
        return;
    }
    for (int i = 0; i < array->size; i++)
        freejNode(array->elements[i]);
    free(array->elements);
    free(array);
}
%%%
In the Far East, before rifles were invented, falcons were kept, fed, trained, and taught to hunt such birds as the crane, pigeons, ducks, geese and barnyard fowls, and the many little feathered fellows, that live in the woods and swamps. Men would go in among the rushes and the bushes, and drive out, from the covert, both the smaller and larger birds. Out in the fields, or on the hills, the falconer would be in waiting to let his trained birds fly at them, with beak and talons.
One man carried around his waist a wide hoop, kept a foot or so out from his body, and held by a strap from his shoulders. On this hoop, were a half dozen or so trained falcons, with their eyes covered by little caps or hoods held down over their heads. As soon as a bird was seen, the hunter would take off the hood and let one of the trained falcons free.
Flying straight up, high in the air, and swiftly descending, swooping down and striking the bird in the neck, with its sharp beak, the falcons brought down the game to their masters, until the hunting bags were full. Women, as well as men, loved this sport, and it was a gay sight, when a cavalcade of ladies and gentlemen, as they issued from the castle, and all on horseback, went out for a hunt, while the gamekeepers with the falcons and bush-beaters, with the dogs, followed. [103]The men on foot carried a spear, in case they should meet a bear, or wild boar. On their return, the hunting party would have a feast in the castle.
%%%
There is one variety of the Swiss fairies who manage to get along with very few clothes, and those very thin. The prettiest ones among them seem to live up among the highest mountain peaks. There, it is colder than anywhere else, but these fairies do not mind it. Furs are not in fashion, but only very filmy garments. On their backs are gauzy wings, by which they can fly around from one peak to another. They hover over the meadows also, which in summer glisten with blossoms of every tint and hue. They love to plague Jack Frost, and the old mountain giants, that have beards of icicles, and hair of snow streamers, and who try so hard to freeze out the flowers.
These fairies know all the secrets of the mountains. They find out where the largest and prettiest rock crystals are, and where the priceless minerals are to be found. They can tell just where the caves of sparkling topaz are situated, but they do not let any mortal know, unless he [210]is their favorite. They can lead a hunter to the spot where the chamois are feeding on the moss. When they want to reward a brave man, they bring him bullets that are sure to hit the buck, and win for the marksman a fine pair of horns; or, at the village shooting matches, plug the bull's eye of the target, and so secure the prize. To please his fairy guardian, the hunter must always promise to do what she bids him, or else her bad temper is roused. Then she scolds, and leaves him to his luck, which, after that time, is never good. It is not safe to quarrel with a fairy.
%%%
This, in itself, was bad enough, and the dwarf was disgusted at such manners and much irritated by the noise. But, worse than this was to come. This ill mannered dairyman, who kept peeping between his eyelids, got very much excited, as he saw the dwarf doing the most wonderful things, with common weeds and flowers. Out of these he drew juices, flavors, coloring matter, aromatic liquids, and sugars, either in crystal, or in the form of gum or candy. Out of his pots, pans and kettles, he poured what looked like the most tempting things to eat. They smelled so delightful that Hilty forgot himself and, with his eyes wide open, stared at the dwarf and what he was doing.
By this time, Hilty was building great air castles. He saw himself in a great candy store in Lucerne employing fifty pretty girls, in attractive uniform, to allure the public, wait at the [62]counters on the crowd of customers, who came with plenty of money and all eager to get waited on. They stood in lines, four deep, in front of the show cases, eyeing what they were to choose; while those nearest the girls were eagerly buying bonbons, chocolates, caramels, all-day suckers, mint drops and Iceland moss paste, in boxes tied up in dainty, gay colored ribbons. Each box was wrapped, not in common paper, but in dotted Swiss muslin, or fine cambric. No one seemed to care how much the cost might be.
Back of the counters, were scores of lovely Swiss maidens, in white bodices, with silver chains, ornamented girdles, and brilliant head-dresses. These were tied, so as to show they were not yet married. There were dozens of waiter boys and serving maids, scurrying around with trays, attending to the people at the tables, who called for ices and sweets, or drinks, to be sipped. His chief customers were among the fashionable folks of Lucerne. For, in Hilty's vision, his was the resort of the most stylish people in the city.
%%%
*(node->rawdata + node->datalen - 1) = '\0';
object->values[i++] = getjNode(prev);
*(node->rawdata + node->datalen - 1) = '>';
break;
 else {
*cur = '\0';
object->values[i++] = getjNode(prev);
*cur = ',';
prev = cur + 1;
cur = findNextColon(prev, node->rawdata + node->datalen);
%%%
*cur = '\0';
object->keys[i] = getjNode(prev);
*cur = ':';
prev = cur + 1;
cur = findNextComma(prev, node->rawdata + node->datalen);
if (cur == NULL) {
    *(node->rawdata + node->datalen - 1) = '\0';
    object->values[i++] = getjNode(prev);
    *(node->rawdata + node->datalen - 1) = '>';
    break;
} else {
    *cur = '\0';
    object->values[i++] = getjNode(prev);
    *cur = ',';
    prev = cur + 1;
    cur = findNextColon(prev, node->rawdata + node->datalen);
}

%%%
When spring time came, the girls went blossom hunting. One very common flower, which they had known in Switzerland, the Pearly Everlasting, somehow reminded them of the Edelweiss. Daddy, who loved trees, almost to worship, saluted the same species as those which he had seen growing in the Old World-fir, birch, pine, and oak; but the persimmon tree was new to him and he enjoyed the autumn fruit, which the frost seemed to ripen; while the sugar maple was as good as a fairy tale, for the idea of a tree bearing candy was wonderful. In fact, the Harbys hailed the trees as friends, true and tried, with reverence and awe.
A generation came and went, and soon there was a little God's acre around the little church [19]on the hill top. The Hess family, from Zurich, also had made their home near by, at Whitemarsh, and several couples of the young men and maidens of the two households made love and married together.
The fathers and mothers, who had known the old home land beyond the sea, talked often of chamois and ibex, and edelweiss and the rock roses, and the meadow flowers, and the cows and the yodel music. When they spoke of the "Alps," they meant the summer pastures high up, and not mountains. At times, especially in June, they felt homesick for the yodel songs and the Alpine horn echoes. They spoke often of the curious things at Neuchatel, and Berne, and Zurich, and the Lake of the Four Cantons. They sang the hymns of Heimath, or Home, and of the Fatherland, and of the Heavenly Land, and recounted the exploits of the Swiss heroes. The children were taught not to be afraid of the dark, and all knew by heart many hymns, especially that beginning, "Alone, yet not alone with God am I."
%%%
colonCount++;
cur = findNextColon(cur + 1, node->rawdata + node->datalen);
%%%
So the old fairies put their heads together, to find a proper name for the new fairy flower-baby, that was to live among the cold mountain tops and refuse to be frightened, or frozen, or be driven down lower, or to be cuddled up in meadows, near men's houses, where it was warm.
"What say you?" asked the Queen, of the wisest of the fairies, who was considered a sort of [149]sage or prophet, and who had a wonderfully long head. "What name do you give?"
%%%
return (*str++ == 'n' &&
    *str++ == 'u' &&
    *str++ == 'l' &&
    *str++ == 'l' &&
    *str == '\0') ? 4 : 0;
%%%
jNumber* getjNumber(jNode* node) {
    if (node->type != jNUMBER)
        return NULL;
    if (node->contents != NULL)
        return (jNumber*)node->contents;
    jNumber* number = malloc(sizeof(*number));
    node->contents = (void**)number;
    number->holder = node;
    if (containsDecimalOrExponent(node->rawdata, node->datalen)) {
        number->isInt = 0;
        number->dvalue = atof(node->rawdata);
        number->ivalue = (int)number->dvalue;
    } else {
        number->isInt = 1;
        number->ivalue = atoi(node->rawdata);
        number->dvalue = (double)number->ivalue;
    }
    return number;
}
%%%
ret = jSTRING;
 else if (isjNumber(start)) {
ret = jNUMBER;
 else if (isjArray(start)) {
ret = jARRAY;
 else if (isjObject(start)) {
ret = jOBJECT;
 else if (isjWhitespace(start)) {
ret = jWHITESPACE;
 else if (isjTrue(start)) {
ret = jTRUE;
 else if (isjFalse(start)) {
ret = jFALSE;
 else if (isjNull(start)) {
ret = jNULL;
 else {
ret = jERROR;
%%%
Upon this, she made up her mind that this fine fellow was no other than the King of the Crystal Cavern, which was far down in the world under the waters.
She was about to give the signal, that would expose him, when her mouth was shut, and her limbs felt as if paralyzed by some unseen and unknown power, when she saw him offer to take, as his partner, the Princess Babi, the daughter of the castle lord.
Smilingly the lovely maiden put out her arms, in return for his embrace. All she thought of was the fun and merriment. Yet, within a few minutes after they had linked arms together, he started in a whirling dance. It was so rapid, that the mother and the older spectators, who sat watching the young people, were too fascinated to speak or cry out. They noticed him whirling his partner around, but getting ever nearer the lakeside. Wider and wider were the [207]circles they made, but all the time he was bringing her nearer the beach; while she seemed delirious with delight, apparently oblivious to everything but the rapturous motion.
%%%
int isjWhitespace (char* str) {
    char* start = str;
    while (*str != '\0') {
        if (!isCharWhitespace(*str))
            return 0;
        str += 1;
    }
    return str - start;
}
%%%
Jeannod was so happy in his love for fairy Silver Wreath, that he wanted to make her his wife. So one day, he kneeled before her and asked her to be his bride. He thought it would be easy for her to accept his love and care, after she had so helped and favored him.
%%%
The queen of the fairies, that lived down in the warm meadows, felt sorry that so fine a place should have nothing in it that was alive, or had any color, red, pink, blue, or yellow, violet or green. She believed that the land could be conquered [79]from the frost giants and made a country in which boys and girls could play and pick flowers.
%%%
printTabs(tabs + 1);
printjNode(array->elements[i], tabs + 1);
if (i < array->size - 1)
    printf(",");
printf("\n");
%%%
On the other hand, the new generation told of other game, deer, bear, wolf, wild turkey and pigeons, and of new fruits like the persimmon. Their model, in civil life, was the good governor, William Penn, and their hero in valor and rescue of captives was Colonel Bouquet, the Swiss soldier [20]in the service of their sovereign, Queen Anne. They loved her, also, because she loved the yodel music. Later came the kings named George. The flag over them was the Union Jack, which they saw float on the staff, when they went to Philadelphia often, and, occasionally, to Lancaster.
%%%
return (*str++ == 't' &&
        *str++ == 'r' &&
        *str++ == 'u' &&
        *str++ == 'e' &&
        *str == '\0') ? 4 : 0;
%%%
*(node->rawdata + node->datalen - 1) = '\0';
array->elements[i] = getjNode(prev);
*(node->rawdata + node->datalen - 1) = ']';
%%%
This animal had fought with many dogs, and one, that it had scratched pretty badly, had bitten off its tail, so short, that even a rabbit would be ashamed of the measly tuft, left on the end, for, only what looked like a furry plug was visible.
Now this old puss, known as "Stumpy," was just that minute about to sneak up to a bird box, in which were four very hungry little birdies. The mother bird was out, seeking worms for her little folks' dinner.
%%%
char* start = str;
while (*str != '\0') {
    if (!isCharWhitespace(*str))
        return 0;
    str += 1;
}
return str - start;
%%%
return (*str++ == 't' &&
        *str++ == 'r' &&
        *str++ == 'u' &&
        *str++ == 'e' &&
        *str == '\0') ? 4 : 0;
%%%
Then the Queen lifted her wand tipped with a star. She touched the forehead of the Fairy of the Lion's Foot, which was her war name; while in the talk of mortals, she was called Noble White, though still the fairies, quite often, use the name Margarita.
%%%
One day, when her daddy and mamma were asleep, she sneaked out from the cave, on her tiptoes, and slipped down a glacier. When on solid ground, she ran, like a deer, up into the valley, where she saw a farmer with two horses making furrows in the field.
Amused at this, she stood and watched, while [51]perched on a boulder, looking on with wonder. Then the young giantess burst out laughing.
%%%
The Fairy Queen was surprised. "How can you, sir Judge, nominate a bird of bad character? The cuckoo is a pirate. Does it not lay its eggs in the nests of other birds? How often, besides stealing their homes, it throws out the eggs of the rightful owners, and, because of this robbery, the birdies die."
"True, I have considered this," said the owl, "but the cuckoo is a summer bird, that eats up the hairy caterpillars, which other birds will not touch. In this manner, it helps the trees to grow and the fruit to ripen, so that men have a clean country for the fairies to play in. Besides, in the courting season, you know it is the male bird's love note, that sounds so sweetly, in April, May and June, and this song, 'cuckoo, cuckoo,' we all love to hear."
The Queen of the Fairies pondered this answer. She was impressed with the owl's wisdom, and, besides, she wanted all the fairies to love each other. So she concluded to invite the male cuckoo bird to be her model, for the new clock, that was to make Switzerland wealthy and famous. Surely, such clocks would be wanted, all over the world.
%%%
if (object->holder != NULL) {
    freejNode(object->holder);
    return;
}
for (int i = 0; i < object->size; i++) {
    freejNode(object->keys[i]);
    freejNode(object->values[i]);
}
free(object->keys);
free(object->values);
free(object);
%%%
When the story teller heard the once little maids talk about things Swiss, and Hessian, and British, and Pennsylvanian, these three, two of whom the Hessians had once scared into the garret, were dear old ladies. Sitting up in bed, or in her chair, as straight as her rheumatism and her bent fingers would allow, grandmother told us many a tale of Swiss ancestral and Revolutionary times.
To the end of the years of her life, which lasted from 1770 to 1866, her sister Hannah, our maiden aunt, sang the songs, played on the piano [3]the ditties, and danced the minuets and waltzes, which the French officers and noblemen had taught her when the Quaker city, from 1790 to 1800, was the national capital.
We children, even when big girls and boys, and ready for college, enjoyed the fun, the music, and the stories. It was from these dear old ladies that the story teller learned to love the mountains, and to climb them, in America and Japan, and, for weeks at a time, to tramp among them in glorious Switzerland.
%%%
Smilingly the lovely maiden put out her arms, in return for his embrace. All she thought of was the fun and merriment. Yet, within a few minutes after they had linked arms together, he started in a whirling dance. It was so rapid, that the mother and the older spectators, who sat watching the young people, were too fascinated to speak or cry out. They noticed him whirling his partner around, but getting ever nearer the lakeside. Wider and wider were the [207]circles they made, but all the time he was bringing her nearer the beach; while she seemed delirious with delight, apparently oblivious to everything but the rapturous motion.
Reaching the shore, pausing hardly a moment, he leaped with her into the water, which was then silvered with the moonbeams and rippling with the breeze.
Down, down, below the sparkling waves, the King of the World under the Waters-for it was he-made her his wife and queen, but never would he let her go back home.
%%%
As the winter came on, the appetite of the dragons became less ravenous and they ate little. Like bears and marmots, they went into their cave, and kept very quiet, as if asleep. Moreover, even in summer, when these dragons could not get a supply of maidens, they devoured a sweetish substance, that exuded from a cleft in the rocks, which must have been filled by a colony of bees, for honey trickled plentifully down into the gully. At any rate, the cooper got to like the dragon's winter food so well, that he wondered how he could ever have enjoyed black bread and cheese. In a month, his stomach got quite used to the new diet.
%%%
But instead of going to his house or shop, where the wood shavings smelled so sweet, he resolved to take a walk, to get rid of a splitting headache. So he scrambled up the mountain side, expecting, on his return, to tell his wife, that he had been out in the woods, looking for timber, to make hoops and barrel staves.
He hardly knew where he was going, for he was stupid and half dizzy, from so much drink, from the night before, and pretty soon he slipped and fell. Over and over, he rolled, until, coming to the edge of a precipice, he stumbled and slid far down into a bog. This cooled him off and brought him to his senses.
He tried long to find the way out, but could see no hole or cleft in the rocks. After a while, he saw what looked like a tunnel, or, it might be, a grotto.
Entering in and peering about him, he discerned four great round lights, like moons. At this, his heart began to beat, his blood to swell in his veins, and his hair to rise, nearly knocking his hat off. He saw two streams of fire issue from beneath and between these shining orbs. After a few seconds, he saw clearly two dragons, that were breathing out streams of fire, that [71]nearly scorched off his eyebrows, while the sulphurous smell nearly knocked him over.
%%%
*str != 't') {
return 0;

%%%
Then he clutched his whip more tightly, expecting to get down and thrash the animal with all his strength.
%%%
if (*cur == '\0')
    return NULL;
else if (*cur == '"')
    inString = !inString;
else if (*cur == '[' && !inString)
    sbCount++;
else if (*cur == ']' && !inString)
    sbCount--;
else if (*cur == '<' && !inString)
    cbCount++;
else if (*cur == '>' && !inString)
    cbCount--;
else if (*cur == ':' && !inString && !cbCount && !sbCount)
    return cur;
%%%
// printTabs(tabs);
if (array->size == 0) {
    printf("[]");
    return;
}
printf("[\n");
for (int i = 0; i < array->size; i++) {
    printTabs(tabs + 1);
    printjNode(array->elements[i], tabs + 1);
    if (i < array->size - 1)
        printf(",");
    printf("\n");
}
printTabs(tabs);
printf("]");
%%%
Now, in a certain house in the dorf, an old fashioned mother was scolding her frivolous young daughter, named Angelette, for aping Paris and Napoleonic fashions. She remarked that things had come to a pretty pass, when a young snip of a girl needed the leather of a whole goat to clothe her arms. Daddy had also joined in the conversation, but only to lose his temper. In his gestures, the cover of his pipe dropped [163]off, spilling the hot ashes all over his daughter's low-necked frock. The sparks made her jump, besides reddening the skin of her neck, even more than her arms.
The girl Angelette was dressing for the evening dance, on the green, and was quite put out by the accident. In fact, the old man had seized the tip of Angelette's middle finger of her glove and had pulled off the half yard or more of white kid, when the avalanche flew past. It flung a bit of rock, like the bolt of a catapult, right through the window, sending the glove, all muddy and torn, out of the other.
%%%
if (*str == 'e' || *str == 'E') {
    str +=1;
    if (*str == '+' || *str == '-')
        str += 1;
    if (*str < '0' || *str > '9') // at least one digit must follow (e|e\+|e-)
        return 0;
    while (*str >= '0' && *str <= '9')
        str += 1;
}
%%%
commaCount++;
cur = findNextComma(cur + 1, node->rawdata + node->datalen);
%%%
In one room, she left behind her all the wardrobe [109]and whatever was Belgian. She then stepped into the next room, which was all Austrian in its furniture and treasures. It was full of dainty clothes, fluffy and gauzy for summer wear, the time of flowers; but there was also more, in plenty, of garments that were fur-lined, for winter warmth. With garments for wear next to the skin, that were white as an edelweiss, and thicker wraps for her body, that were crimson and purple, like the Alpine rose, she was met by the Swiss chaperone and the maidens awaiting her, who completed her costume. Then she stood forth as a bride, ready for the other ceremony of wedding, which took place in the cathedral, where, with bell and book, in the holy bonds of matrimony, they were to be joined by the bishop. There, the prince met his lovely princess and the two were married, and they and their children lived happily ever afterwards.[110]
[Contents]
XI
THE YODEL CARILLON OF THE COWS
%%%
"You are always wise. So please let me have a name that will be popular with the Swiss people."
"Well, your highness, if it be your pleasure, we shall clothe your pet in purest white, like ermine, rivalling even the snow, without spot, or stain, or any dark tint. So, we may justly call it, the Edelweiss, that is, the Noble White."[151]
At this, all the fairies shouted with delight. Even the Queen herself smiled, and then made answer.
"You have well spoken; 'Edelweiss' it shall be."
%%%
The Frost Giants were terribly disappointed at seeing their pet mount up in the air like a pigskin ball from the foot of a first class kicker, even before it was half grown. To behave so differently, from what its daddy had felt sure of, [45]and told the Frost Giants it would do, seemed like disobedience. For, was not this avalanche the Frost King's son? Instead of rolling straight down the valley, gathering force for its final plunge, at every yard, it was apparently trying to climb up to the moon.
"That youngster is altogether too smart," whispered one old giant to another.
Just a second or two, before this baby avalanche seemed to have lost both its head and its path, to go aside and play in the deep valley below, there was a hunter, on one side of the ravine, who had climbed up the high rocks, to get a shot at a herd of chamois that were feeding quietly on the other side.
%%%
int inString = 0, sbCount = 0, cbCount = 0; // " [
char* endValue = str + 1;
while (*endValue != '\0') {
    if (*endValue == '"')
        inString = !inString;
    else if (*endValue == '[' && !inString)
        sbCount++;
    else if (*endValue == ']' && sbCount > 0 && !inString)
        sbCount--;
    else if (*endValue == ']' && sbCount == 0 && !inString)
        break;
    else if (*endValue == '<' && !inString)
        cbCount++;
    else if (*endValue == '>' && !inString)
        cbCount--;
    else if (*endValue == ',' && !sbCount && !cbCount && !inString)
        break;
    endValue += 1;
}
if (*endValue == '\0')
    return 0;

char endHolder = *endValue;
*endValue = '\0';
json_type elementType = getjNodeType(str + 1);
*endValue = endHolder;

if (elementType == jERROR)
    return 0;

if (elementType == jWHITESPACE &&
    (*str != '[' || *endValue != ']'))
    return 0;

str = endValue;
%%%
But seeing the lazy lubber, wide awake, when he was believed to be fast asleep, the dwarf's [65]whole appearance changed. Instead of smiles, in his usually happy manner, his eyes blazed with wrath, like fire. His face wore one long scowl. He danced with rage, and screamed out,
"So that's the way you keep your word, is it? You ungrateful bumpkin! Take that, and that!"
Then, he flung the pot of hot chocolate at the fellow's head, and followed up his attack, with the ladle and cloth, batting him out of the cave.
%%%
while (cur != NULL) {
    *cur = '\0';
    array->elements[i++] = getjNode(prev);
    *cur = ',';
    prev = cur + 1;
    cur = findNextComma(prev, node->rawdata + node->datalen);
}
%%%
jNode* getjNode (char* str) {
    // printf("creating node\n");
    jNode* node = malloc(sizeof(*node));
    char* start = firstNonSpace(str);
    char* end = firstEndSpace(start);
    node->type = getjNodeType(str);
    node->contents = NULL;
    node->datalen = end - start;
    node->rawdata = malloc(sizeof(*node->rawdata) * (node->datalen + 1));
    for (int i = 0; i < node->datalen; i++)
        node->rawdata[i] = start[i];
    return node;
}
%%%
int isjNumber (char* str) {
    char* start = str;
    if (*str == '-')
        str += 1;

    if (*str == '0') {
        str += 1;
    } else if (*str >= '1' && *str <= '9') {
        while (*str >= '1' && *str <= '9')
            str += 1;
    } else { // number must contian at least one digit
        return 0;
    }

    if (*str == '.') {
        str += 1;
        if (*str < '0' || *str > '9') // at least one digit must follow '.'
            return 0;
        while (*str >= '0' && *str <= '9')
            str += 1;
    }

    if (*str == 'e' || *str == 'E') {
        str +=1;
        if (*str == '+' || *str == '-')
            str += 1;
        if (*str < '0' || *str > '9') // at least one digit must follow (e|e\+|e-)
            return 0;
        while (*str >= '0' && *str <= '9')
            str += 1;
    }

    if (*str == '\0')
        return str - start;

    return 0;
}
%%%
The fairies young and old, all thought it over, but no one could tell how to begin or proceed. The young ones thought much of gloves and muffs, tippets and leggings, hoods and ear muffs, thick stockings and fleecy lined gloves. Yet how could these be made to fit a plant?
It was natural for them to think in this way, for all their things to wear were on the outside, both for grown ups and those fairies that were more like big boys and girls. On the other hand, the fairy mothers were all the time thinking about the baby's life, and not only how to cover the young thing, but also to have it warmly wrapped up, when it was still very little. They brought to mind examples of papooses well bundled in furs for cradles and hung on the branches. Some told of Esquimaux babies, all swaddled in furs, that are given a lump of whale blubber, instead of candy, and skewered on a stick, so that it will not swallow the tidbit, all at once, and choke. Others told of Italian bambinos, wrapped up tight, and Japanese akambos, held pick-a-pack style, on their big sisters, but none of these seemed to give the right idea of what was wanted.
At last, one old grandmother fairy made a [184]sign that she wished to speak, and all listened while she talked.
"You fairies had better stop thinking about human beings, for not one of them could live where we want this flower to grow. It is too cold, and the frost giants already own the country. Better look to the animals to show us how. Now I have heard of a two-legged creature, that yet is not a man nor a woman; and another one, with four legs that carries its babies, even a whole family, of four or five, in a pouch in front of its body, until the little ones can take care of themselves. In this way, they are kept free from danger, until they grow up and can provide for themselves."
%%%
return 
    ch == ' ' ||
    ch == '\t' ||
    ch == '\r' ||
    ch == '\n';
%%%
jString* getjString(jNode* node) {
    if (node->type != jSTRING)
        return NULL;
    if (node->contents != NULL)
        return (jString*)node->contents;
    jString* string = malloc(sizeof(*string));
    node->contents = (void**)string;
    string->holder = node;
    string->length = node->datalen - 2;
    string->chars = malloc(sizeof(*string->chars) * (string->length + 1));
    for (int i = 0; i < node->datalen - 2; i++)
        string->chars[i] = node->rawdata[i + 1];
    string->chars[string->length] = '\0';
    return string;
}
%%%
void freejArray(jArray* array) {
    if (array->holder != NULL) {
        freejNode(array->holder);
        return;
    }
    for (int i = 0; i < array->size; i++)
        freejNode(array->elements[i]);
    free(array->elements);
    free(array);
}
%%%
return (*str++ == 'n' &&
    *str++ == 'u' &&
    *str++ == 'l' &&
    *str++ == 'l' &&
    *str == '\0') ? 4 : 0;
%%%
if (number->holder != NULL) {
    freejNode(number->holder);
    return;
}
free(number);
%%%
It was a pretty long session, for all were allowed to have their say, just as at a town meeting of mortals.
Yet when one of the big giants talked too long, or when a lovely and pretty fairy wandered in her thoughts, and prattled too much, without saying anything, the whole company coughed him, or her, down. After all, nothing much came of the meeting, for they could not agree.
Here the president of the meeting pounded hard, to call the long-winded fairy to order, lest he might keep on for a week. It would soon be sunrise, when they must all scamper.
So, at the first streak of light, in the east, down came the gavel of the president, with a force that split the rock, and, before half of those who wanted to speak, had opened their mouths, the congress was adjourned.
%%%
Their sabots, or wooden shoes, were hollowed out of whole trunks of fir trees, and when they walked they made an awful stamping noise. Their breath, like mist, rolled out in great clouds over the assembly, so that at times some of the fairies could not see the speaker and several felt very chilly. Their voices, in speaking, sounded like rolling thunder. When the president pounded with his gavel, some of the fairies, sitting at the edge of the crowd, thought an earthquake had taken place.
%%%
while (*endValue != '\0') {
    if (*endValue == '"')
        inString = !inString;
    else if (*endValue == '<' && !inString)
        cbCount++;
    else if (*endValue == '>' && cbCount > 0 && !inString)
        cbCount--;
    else if (*endValue == '>' && cbCount == 0 && !inString)
        break;
    else if (*endValue == '[' && !inString)
        sbCount++;
    else if (*endValue == ']' && !inString)
        sbCount--;
    else if (*endValue == ',' && !cbCount && !sbCount && !inString)
        break;
    endValue += 1;
}
%%%
THE WONDERFUL ALPINE HORN
When the little boys and girls, who read these Swiss fairy tales, grow up to be big and travel in Switzerland, they will enjoy the Alpine horn.
Nearly every shepherd lad in the mountains knows how to blow it. It is made of wood, and is about half as long as an ordinary broom. Its butt, or heavy end, rests on the ground. When a man blows a long blast, the sound, at first, when one is too near, does not seem to be very pleasing; for distance lends enchantment to the sound. But wait a moment, and listen! Far off across the valley, the strains are caught up, and sent back from the tops of the high mountains. Then it sounds as if a great choir of angels had come down from Heaven to sing glory to God, and to bring greetings to all good souls. Nowhere in all the world is there such sweet music made by echoes.
%%%
But this was only for a second; for the bold fellow, familiar from his youth, with the mountains, laughed at any and all difficulties in his path. He was just about to level his weapon and take aim, when he heard a loud voice behind him, shouting:
"Erni, pull your cap down over your eyes."
Astonished to hear his name called out at such a place, and struck with curiosity, he turned to see who and what it was.
%%%
int inString = 0, cbCount = 0, sbCount = 0;
for (char* cur = start; cur < end; cur += 1) {
    if (*cur == '\0')
        return NULL;
    else if (*cur == '"')
        inString = !inString;
    else if (*cur == '[' && !inString)
        sbCount++;
    else if (*cur == ']' && !inString)
        sbCount--;
    else if (*cur == '<' && !inString)
        cbCount++;
    else if (*cur == '>' && !inString)
        cbCount--;
    else if (*cur == ',' && !inString && !cbCount && !sbCount)
        return cur;
}
return NULL;
%%%
if (node->type != jOBJECT)
    return NULL;
if (node->contents != NULL)
    return (jObject*)node->contents;
jObject* object = malloc(sizeof(*object));
node->contents = (void**)object;
object->holder = node;
int colonCount = 0;
char* cur = findNextColon(node->rawdata + 1, node->rawdata + node->datalen);
while (cur != NULL) {
    colonCount++;
    cur = findNextColon(cur + 1, node->rawdata + node->datalen);
}

object->size = colonCount;
object->keys = malloc(sizeof(*object->keys) * object->size);
object->values = malloc(sizeof(*object->values) * object->size);

int i = 0;
char* prev = node->rawdata + 1;
cur = findNextColon(prev, node->rawdata + node->datalen);
while (cur != NULL) {
    *cur = '\0';
    object->keys[i] = getjNode(prev);
    *cur = ':';
    prev = cur + 1;
    cur = findNextComma(prev, node->rawdata + node->datalen);
    if (cur == NULL) {
        *(node->rawdata + node->datalen - 1) = '\0';
        object->values[i++] = getjNode(prev);
        *(node->rawdata + node->datalen - 1) = '>';
        break;
    } else {
        *cur = '\0';
        object->values[i++] = getjNode(prev);
        *cur = ',';
        prev = cur + 1;
        cur = findNextColon(prev, node->rawdata + node->datalen);
    }
    
}

return object;
%%%
When the barn had been built, the cows, pigs and fowls made things look friendly and sociable. They had no cuckoo clock any more, but it was really homelike to hear the cocks crow at sunrise. This sound was certainly much pleasanter, indeed, than to hear the howling of the wolves at night. Occasionally, early in the morning, the Harbys would see a bear in the barnyard, and they had to keep the chickens locked up in the chicken house, for foxes were plentiful, and always on the watch for a poultry dinner. Wild [18]turkeys-a new sort of bird for them-and wild pigeons were plentiful. Benjamin Franklin, who was then a little boy in Boston, the oldest in a family of seventeen children, when a grown man, wanted to make the wild turkey, which gives food to man, the national emblem, instead of the eagle, that lives on flesh and kills little birds.
Inside the house, there were wide seats at the chimney side, and puss purred in front of the great hearth fire. Outside, the dogs kept watch and ward, and often had a lively tussle with wolves and young bears.
%%%
char* start = str;
if (*str != '[')
    return 0;
while (*str != ']') {
    int inString = 0, sbCount = 0, cbCount = 0; // " [
    char* endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '[' && !inString)
            sbCount++;
        else if (*endValue == ']' && sbCount > 0 && !inString)
            sbCount--;
        else if (*endValue == ']' && sbCount == 0 && !inString)
            break;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && !inString)
            cbCount--;
        else if (*endValue == ',' && !sbCount && !cbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    char endHolder = *endValue;
    *endValue = '\0';
    json_type elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jERROR)
        return 0;

    if (elementType == jWHITESPACE &&
        (*str != '[' || *endValue != ']'))
        return 0;
    
    str = endValue;
}

if (*++str == '\0')
    return str - start;
return 0;
%%%
int isjWhitespace (char* str) {
    char* start = str;
    while (*str != '\0') {
        if (!isCharWhitespace(*str))
            return 0;
        str += 1;
    }
    return str - start;
}
%%%
while (*endValue != '\0') {
    if (*endValue == '"')
        inString = !inString;
    else if (*endValue == '<' && !inString)
        cbCount++;
    else if (*endValue == '>' && cbCount > 0 && !inString)
        cbCount--;
    else if (*endValue == '>' && cbCount == 0 && !inString)
        break;
    else if (*endValue == '[' && !inString)
        sbCount++;
    else if (*endValue == ']' && !inString)
        sbCount--;
    else if (*endValue == ',' && !cbCount && !sbCount && !inString)
        break;
    endValue += 1;
}
%%%
"But how could you stay all the time up there, with no living thing near you, and all alone? You will have no neighbors, except the rocks and crags, and even they will be all bare, and swept by the fierce winds. Can you stand that?" asked an old fairy, doubtingly.
"Yes, if for nothing else, than to show that we fairies are not afraid of the Frost Giants, I should be willing to live alone. Besides, our fairy queen will see that, by and bye, there will be others like me, and then I shall have company. The more of us, the merrier, I am sure. In a few thousand years, we'll make an army and a victorious one, too."
Seeing this brave one, of her company, so ready and willing, the Queen of the Fairies put on her thinking cap. She spent a whole night in planning how to turn this volunteer fairy into a flower. Then she would bundle her up in furs, and dress her so warmly, that even the biggest and coldest of the Frost Giants could not kill her with his icy breath.
And this was the way this volunteer, from the fairy ranks, was clothed and made ready to fight, in the long war with cold and storm, so that for ages, this little thing has been able to live far [148]up on the mountain heights and, all the time, to smile and be joyful, and laugh, in the face of the Frost Giants. In fact, so happy is she, among the rock crags and sunshiny crannies, and so amused at herself, in looking down over the terrible precipices, to the rocks, thousands of feet below, that she would not exchange places or climates, with even the cloves and nutmegs; no, not even with the tea roses and coffee blossoms in the Spice Islands of the southern seas.
%%%
// printTabs(tabs);
if (array->size == 0) {
    printf("[]");
    return;
}
printf("[\n");
for (int i = 0; i < array->size; i++) {
    printTabs(tabs + 1);
    printjNode(array->elements[i], tabs + 1);
    if (i < array->size - 1)
        printf(",");
    printf("\n");
}
printTabs(tabs);
printf("]");
%%%
if (*endValue == '"')
    inString = !inString;
else if (*endValue == '<' && !inString)
    cbCount++;
else if (*endValue == '>' && cbCount > 0 && !inString)
    cbCount--;
else if (*endValue == '>' && cbCount == 0 && !inString)
    break;
else if (*endValue == '[' && !inString)
    sbCount++;
else if (*endValue == ']' && !inString)
    sbCount--;
else if (*endValue == ',' && !cbCount && !sbCount && !inString)
    break;
endValue += 1;
%%%
jObject* getjObject(jNode* node) {
    if (node->type != jOBJECT)
        return NULL;
    if (node->contents != NULL)
        return (jObject*)node->contents;
    jObject* object = malloc(sizeof(*object));
    node->contents = (void**)object;
    object->holder = node;
    int colonCount = 0;
    char* cur = findNextColon(node->rawdata + 1, node->rawdata + node->datalen);
    while (cur != NULL) {
        colonCount++;
        cur = findNextColon(cur + 1, node->rawdata + node->datalen);
    }

    object->size = colonCount;
    object->keys = malloc(sizeof(*object->keys) * object->size);
    object->values = malloc(sizeof(*object->values) * object->size);

    int i = 0;
    char* prev = node->rawdata + 1;
    cur = findNextColon(prev, node->rawdata + node->datalen);
    while (cur != NULL) {
        *cur = '\0';
        object->keys[i] = getjNode(prev);
        *cur = ':';
        prev = cur + 1;
        cur = findNextComma(prev, node->rawdata + node->datalen);
        if (cur == NULL) {
            *(node->rawdata + node->datalen - 1) = '\0';
            object->values[i++] = getjNode(prev);
            *(node->rawdata + node->datalen - 1) = '>';
            break;
        } else {
            *cur = '\0';
            object->values[i++] = getjNode(prev);
            *cur = ',';
            prev = cur + 1;
            cur = findNextColon(prev, node->rawdata + node->datalen);
        }
        
    }

    return object;
}
%%%
while (*endValue != '\0') {
    if (*endValue == '"')
        inString = !inString;
    else if (*endValue == '[' && !inString)
        sbCount++;
    else if (*endValue == ']' && sbCount > 0 && !inString)
        sbCount--;
    else if (*endValue == ']' && sbCount == 0 && !inString)
        break;
    else if (*endValue == '<' && !inString)
        cbCount++;
    else if (*endValue == '>' && !inString)
        cbCount--;
    else if (*endValue == ',' && !sbCount && !cbCount && !inString)
        break;
    endValue += 1;
}
%%%
THE FROST GIANTS AND THE SUNBEAM FAIRIES
Many people think Switzerland the most beautiful country on earth. It is certainly the world's playground. Every year, many hundreds of thousands of persons from various countries, go there to spend either the winter or the summer. They come to enjoy the good sleep that comes from the bracing air, to climb the high peaks, to see the flowers, to hear the echoes of the Alpine horn, to ride over the mountain roads, or to be whisked up, on electric railways, to summits among the clouds. With most of the tourists, the effect of the sharp atmosphere is to whet their appetites, even more than their wits; but perhaps this is what they seek.
The sick and the well alike get vast benefit. They think it great fun to find so much ice and snow, and also so much sunshine, as if winter and summer liked to play together. In February, hardy and strong people enjoy sledding and sliding, besides skis and skittles, and [78]many other merry sports. Children go out on sleds, with almost nothing on them, to enjoy the air baths.
Yet Switzerland was not always a flowery playground, rich in splendid hotels, where the boarders' bills catch the spirit of the place and become mountain climbers. For ages, it was a sort of North Pole, set in the middle of Europe, frozen in, tight and fast, and with mountains of snow and rivers of ice, where no animals could live. In this age, everything was white. Then there were no animals, men, women, children or babies; no flowers, no birds, no fish; no farms, no vineyards, but only dreadful cold, all the year round, and for millions of years.
%%%
When the barn had been built, the cows, pigs and fowls made things look friendly and sociable. They had no cuckoo clock any more, but it was really homelike to hear the cocks crow at sunrise. This sound was certainly much pleasanter, indeed, than to hear the howling of the wolves at night. Occasionally, early in the morning, the Harbys would see a bear in the barnyard, and they had to keep the chickens locked up in the chicken house, for foxes were plentiful, and always on the watch for a poultry dinner. Wild [18]turkeys-a new sort of bird for them-and wild pigeons were plentiful. Benjamin Franklin, who was then a little boy in Boston, the oldest in a family of seventeen children, when a grown man, wanted to make the wild turkey, which gives food to man, the national emblem, instead of the eagle, that lives on flesh and kills little birds.
%%%
Fashions change in the fairy world, as well as among mortals who live on the earth. The Swiss water fairies, called Undines, at times grew tired of living down below the surface of the lakes and rivers. When restless, they longed to mingle in the village gatherings. They wanted to hear the lively music of the young men and maidens, as they sang and danced. Their favorite time for waltzes and cotillions was on moonlight nights.
So it became quite common, at these times, for the fairy maids and swains to swim up to the shore. Then these Undines changed themselves into girls and young men. They put on clothes, that were deep green, the color of the waves. Slipping in among the dancers, they joined in the fun and merry making. In this manner, many a lad romped with a water fairy and even kissed her, thinking she was or might be his sweetheart; for, in the dim light of the moon, it was not always easy to see clearly the face of one's partner. Many a lassie received an embrace, [202]or a salute on the lips, from a lively dancer, whom she supposed was a new comer. He might not be well known in the village, she thought, though he appeared graceful and dressed very nicely, in sea green, gauzy clothes.
Yet no matter how hard these Undines might try to get their clothes entirely dry, they could never wring the water out wholly of their garments, so that they were always more or less damp. If they had changed their form too quickly, their clothes would drip, and make spots on the floor, or ground. Often the village folk felt dampness, on their limbs below the knees. Yet few ever gave the matter a second thought, for their minds were wholly set on having a good time, and they had it.
Sometimes the lady fairies started rather late in the evening to take their swim to the lake shore. Fearing to lose some of the fun, and thinking they might even find the dancing all over, and the people gone home to bed, they were in a great hurry, while on the strand, to change into the form of mortals and put on their human clothes. So it happened that, when they joined in the dance, one sharp-eyed fellow, who was playing the violin for the measures, noticed that something was wrong. In fact, he was so surprised, that he suddenly stopped fiddling. Then, instantly, everybody dropped arms and stood [203]looking around at the musician's stand, to see what was the matter. In a moment, it was as quiet as a church aisle, when the parson was praying.
%%%
char* start = str;
if (*str != '<')
    return 0;
while (*str != '>') {
    int inString = 0, cbCount = 0, sbCount = 0; // " < [
    char* endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && !cbCount && !inString)
            break;
        else if (*endValue == ':' && !cbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    char endHolder = *endValue;
    *endValue = '\0';
    json_type elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE &&
        *str == '<' && 
        *endValue == '>')
        return endValue - start;

    if (elementType != jSTRING ||
        *endValue == '>')
        return 0;

    str = endValue;

    inString = 0, cbCount = 0, sbCount = 0;
    endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && cbCount == 0 && !inString)
            break;
        else if (*endValue == '[' && !inString)
            sbCount++;
        else if (*endValue == ']' && !inString)
            sbCount--;
        else if (*endValue == ',' && !cbCount && !sbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    endHolder = *endValue;
    *endValue = '\0';
    elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE ||
        elementType == jERROR)
        return 0;

    str = endValue;
}

if (*++str == '\0')
    return str - start;
return 0;
%%%
if (object->holder != NULL) {
    freejNode(object->holder);
    return;
}
for (int i = 0; i < object->size; i++) {
    freejNode(object->keys[i]);
    freejNode(object->values[i]);
}
free(object->keys);
free(object->values);
free(object);
%%%
THE ASS THAT SAW THE ANGEL
In that part of the Swiss Republic, called the Grisons, there is a sharp mountain, thin and round, like a horn. Because it is red, its name has always been Rothhorn, or Red Peak.
In one of the towns near by, lived a proud man, named Gruntli, who scouted the idea of there being any fairies, or Santa Claus. To his view, there was no intelligence, or virtue, in dumb brutes. He did not believe in anything but what he could see, taste, smell, hear, or handle with his ten fingers. This was what he called "science."
%%%
When the fairies were called together, and told by their queen that the Sun would be their friend and help them every day, and never tire of his good work, you ought to have seen how happy they were. They all clapped their hands, and every one, big and little, wanted to be brave and go out to fight the frost giants. Each volunteer said, "I am not afraid. The frost giants can't freeze me."
It was wonderful how the pretty fairies were perfectly willing to be changed into humble looking plants, that never could grow very tall, but lie quite flat on the ground, and have deep roots in the crannies. They would have to live without much society, or excitement, and spend their lives in clefts and hollows. What was hardest to bear, was, that most of them would have to live like nuns; for in the case of many of them, [82]their beauty would never be appreciated or even seen.
Some were glad even to become plain meadow grasses. When one plump fairy was told she would become an Alpine Poa, and must carry her babies on her back, she gladly consented saying, "I am willing."
%%%
int isjNumber (char* str) {
    char* start = str;
    if (*str == '-')
        str += 1;

    if (*str == '0') {
        str += 1;
    } else if (*str >= '1' && *str <= '9') {
        while (*str >= '1' && *str <= '9')
            str += 1;
    } else { // number must contian at least one digit
        return 0;
    }

    if (*str == '.') {
        str += 1;
        if (*str < '0' || *str > '9') // at least one digit must follow '.'
            return 0;
        while (*str >= '0' && *str <= '9')
            str += 1;
    }

    if (*str == 'e' || *str == 'E') {
        str +=1;
        if (*str == '+' || *str == '-')
            str += 1;
        if (*str < '0' || *str > '9') // at least one digit must follow (e|e\+|e-)
            return 0;
        while (*str >= '0' && *str <= '9')
            str += 1;
    }

    if (*str == '\0')
        return str - start;

    return 0;
}
%%%
"1. That we prevail upon the prettiest fairy in the Alps to lure this man Walter up into one of our caves, so far up toward the peaks that, getting very tired, he will fall asleep quickly.[137]
"2. Then, while in slumber, one of our best soothsayers will make him dream of a gun that never misses fire, or fails to deliver its bullet to the mark.
"3. Finally, that our best craftsman shall invent a new kind of weapon, with improved barrel and lock. Then, when Walter wakes up, I propose he be shown how to use it."
%%%
Ulric would then tell his father, and brothers, where to cast their nets, and then they always drew up a good boat load of fish. These they sold in the market at a high price, and so had nice clothes and plenty to eat. So they never asked Ulric where he had been, so long, the night before, and why he reached home after the household were all in bed, and only their faithful dog Fritz kept watch at the door.
His mother warned her youngest son not to go and see the Lorelei too often, but he only laughed, kissed her, and said he could stop going when he wanted to; which is the way many boys and girls talk, not knowing the power of habit, which binds like a chain.
But one night, the old fisherman's son did not return, and in the morning, when his mother looked into his room, expecting to call and wake him, she found it empty. The bed was in perfect order, as if no one had slept in it. Putting her hand under the covers, she found no warmth.
At once, she gave the alarm to her husband [246]and sons, who were then at their breakfast. Taking their faithful dog with them, they at once set out to find the lad. All day long, they searched among the reeds, along the river bank, along the rocks, and even in the woods and on the hills; but no sign of son and brother was found. It was believed that the siren Lorelei, madly in love with the handsome boy, and, though in the form of a pretty woman, having no human heart to feel for his mother, had dragged him down into her caves under the river and deep in the earth, to enjoy him as her companion forever.
%%%
while (*endValue != '\0') {
    if (*endValue == '"')
        inString = !inString;
    else if (*endValue == '<' && !inString)
        cbCount++;
    else if (*endValue == '>' && cbCount > 0 && !inString)
        cbCount--;
    else if (*endValue == '>' && cbCount == 0 && !inString)
        break;
    else if (*endValue == '[' && !inString)
        sbCount++;
    else if (*endValue == ']' && !inString)
        sbCount--;
    else if (*endValue == ',' && !cbCount && !sbCount && !inString)
        break;
    endValue += 1;
}
%%%
int inString = 0, cbCount = 0, sbCount = 0;
for (char* cur = start; cur < end; cur += 1) {
    if (*cur == '\0')
        return NULL;
    else if (*cur == '"')
        inString = !inString;
    else if (*cur == '[' && !inString)
        sbCount++;
    else if (*cur == ']' && !inString)
        sbCount--;
    else if (*cur == '<' && !inString)
        cbCount++;
    else if (*cur == '>' && !inString)
        cbCount--;
    else if (*cur == ',' && !inString && !cbCount && !sbCount)
        return cur;
}
return NULL;
%%%
At once, after tasting a morsel of the confection, with gusto, Hilty smacked his lips and began to dream of getting rich. He resolved to open a shop and make the new confection in his own village.
%%%
return (*str++ == 'n' &&
    *str++ == 'u' &&
    *str++ == 'l' &&
    *str++ == 'l' &&
    *str == '\0') ? 4 : 0;
%%%
"You had warning enough; down you go!"
Just then the hunter's foot, with its hob-nailed [240]shoe, slipped upon a fragment of rock, and he fell. Over the cliff, down, down, down, the cruel man tumbled. A few minutes later, the Alpine condors were quarreling over his corpse. Later, the wolves picked his bones, that lay long upon the bare rocks. An awful warning!
%%%
printf("{}");
return;
%%%
if (node->type != jOBJECT)
    return NULL;
if (node->contents != NULL)
    return (jObject*)node->contents;
jObject* object = malloc(sizeof(*object));
node->contents = (void**)object;
object->holder = node;
int colonCount = 0;
char* cur = findNextColon(node->rawdata + 1, node->rawdata + node->datalen);
while (cur != NULL) {
    colonCount++;
    cur = findNextColon(cur + 1, node->rawdata + node->datalen);
}

object->size = colonCount;
object->keys = malloc(sizeof(*object->keys) * object->size);
object->values = malloc(sizeof(*object->values) * object->size);

int i = 0;
char* prev = node->rawdata + 1;
cur = findNextColon(prev, node->rawdata + node->datalen);
while (cur != NULL) {
    *cur = '\0';
    object->keys[i] = getjNode(prev);
    *cur = ':';
    prev = cur + 1;
    cur = findNextComma(prev, node->rawdata + node->datalen);
    if (cur == NULL) {
        *(node->rawdata + node->datalen - 1) = '\0';
        object->values[i++] = getjNode(prev);
        *(node->rawdata + node->datalen - 1) = '>';
        break;
    } else {
        *cur = '\0';
        object->values[i++] = getjNode(prev);
        *cur = ',';
        prev = cur + 1;
        cur = findNextColon(prev, node->rawdata + node->datalen);
    }
    
}

return object;
%%%
In fact, there was once a time, when men had no clocks or wrist-watches, and girls did not carry at their waist the pretty gold or nickel time-keepers of today. Nor did the big bells in the towers boom out the hours, nor were the huge clock-faces or dials seen, by day or by night. In the castles of Switzerland, where rich men or nobles lived, they knew nothing about marking the hours and minutes by anything, with a round face, having figures on it. One way to announce the hours was to have a candle, with two little brass balls, on opposite sides of the wax, and tied together with a string. When the flame burned, say, an inch, or other measured space, the balls dropped down into a brass basin. This made a loud, ringing noise, which sounded out the hours. Or, a little hammer struck a bell, and that is the reason why a clock, as its name was at first, was called a klok, or bell. On ships, the bells sounded every hour, and half hour, and this is still the method, to which sailors are accustomed; "eight bells" marking the end of one of the three periods of four hours each, into which the day is divided.
The fairies could always tell the time, as well as men, by the sun, but they were more interested in the moon and stars, for night was their joy time. The common people had no word for a minute, or a second, or anything less than an [93]hour. They knew when the sun rose and set, and they guessed the time of day from the place of the sun in the sky-at the east, as it rose in the morning, and during the afternoon, as it sank in the west.
%%%
The hour and place of gathering was named, and it was promised that all, whether pretty or ugly, slow or rapid of speech, and whether of land, water, air, or snow, should have a chance to talk, all being limited to a quarter of an hour each.
%%%
When, after their first victories, the cows and goats should come, and the birds make their nests, and men and women arrive, and the boys and girls play, these fairies, thus changed into flowers, were not to object to have their stalks eaten up by the cattle, or their seeds to be swallowed by the birds, or their blossoms to be plucked by the children. Even when they should come to their best bloom, and seem too pretty to be touched, they were to welcome the cows and goats.
%%%
commaCount++;
cur = findNextComma(cur + 1, node->rawdata + node->datalen);
%%%
jString* getjString(jNode* node) {
    if (node->type != jSTRING)
        return NULL;
    if (node->contents != NULL)
        return (jString*)node->contents;
    jString* string = malloc(sizeof(*string));
    node->contents = (void**)string;
    string->holder = node;
    string->length = node->datalen - 2;
    string->chars = malloc(sizeof(*string->chars) * (string->length + 1));
    for (int i = 0; i < node->datalen - 2; i++)
        string->chars[i] = node->rawdata[i + 1];
    string->chars[string->length] = '\0';
    return string;
}
%%%
char* start = str;
while (*str != '\0') {
    if (!isCharWhitespace(*str))
        return 0;
    str += 1;
}
return str - start;
%%%
void printjObject(jObject* object, int tabs) {
    // printTabs(tabs);
    if (object->size == 0) {
        printf("{}");
        return;
    }
    printf("{\n");
    for (int i = 0; i < object->size; i++) {
        printTabs(tabs + 1);
        printjNode(object->keys[i], tabs + 1);
        printf(": ");
        printjNode(object->values[i], tabs + 1);
        if (i < object->size - 1)
            printf(",");
        printf("\n");
    }

    printTabs(tabs);
    printf("}");
}
%%%
Each speaker mounted the platform, which was a big boulder, with a flat top. When any of the frost giants, who sat up in front, made a speech, it was noticed that, while there were gnomes and kobolds out on the edge of the audience, who shouted "Louder, Louder;" some of the gentler fairies, who were nearer, put up their hands to their ears, for fear of being deafened. It was hard to please all, and at one time, when there were too many on their feet and all wanted to talk at once, the president roared out that he would adjourn the meeting, if there was not better order.[200]
As for the grotto girls, they were pointedly requested, several times, to stop whispering.
It was a pretty long session, for all were allowed to have their say, just as at a town meeting of mortals.
%%%
Millions of fairies gathered together on the hill slopes, to see the procession start, and did not mind waiting a thousand years or so. They hung on bushes, sat on top of rocks and boulders and on the tree-branches, or stood or hovered, wherever they could get either a peep, or a good view of the fairy flower army, that was to march up to the heights and wrestle with the giants.
%%%
void printjArray(jArray* array, int tabs) {
    // printTabs(tabs);
    if (array->size == 0) {
        printf("[]");
        return;
    }
    printf("[\n");
    for (int i = 0; i < array->size; i++) {
        printTabs(tabs + 1);
        printjNode(array->elements[i], tabs + 1);
        if (i < array->size - 1)
            printf(",");
        printf("\n");
    }
    printTabs(tabs);
    printf("]");
}
%%%
Stripped of all her pretty gauzy skirts, bodice, and chemise, and standing forth as nude as a baby in the bath tub, the Queen bade her brave fairy look at her new wardrobe, which lay piled up and as white as any snowdrift. Then, before all the other fairies, the Queen put this question:
%%%
void freejNumber(jNumber* number) {
    if (number->holder != NULL) {
        freejNode(number->holder);
        return;
    }
    free(number);
}
%%%
char* start = str;
if (*str != '[')
    return 0;
while (*str != ']') {
    int inString = 0, sbCount = 0, cbCount = 0; // " [
    char* endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '[' && !inString)
            sbCount++;
        else if (*endValue == ']' && sbCount > 0 && !inString)
            sbCount--;
        else if (*endValue == ']' && sbCount == 0 && !inString)
            break;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && !inString)
            cbCount--;
        else if (*endValue == ',' && !sbCount && !cbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    char endHolder = *endValue;
    *endValue = '\0';
    json_type elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jERROR)
        return 0;

    if (elementType == jWHITESPACE &&
        (*str != '[' || *endValue != ']'))
        return 0;
    
    str = endValue;
}

if (*++str == '\0')
    return str - start;
return 0;
%%%
At first, for several seconds, with Soaker Smash-All, it was more like ploughing, than rolling its way through the drifts, for the slope was slight. Then, as the incline grew more steep, the tumbling became more rapid, until about a half mile from the starting point, the baby avalanche had, by its leaps and bounds grown so fast, as to be already as big as a barn. It was bouncing swiftly along, when, instead of going straight ahead, as its daddy, the Frost King, had planned and expected, it rolled against a rounded rock, that curved up and backwards, like the dashboard of a sleigh, or the roof of a pagoda.
At once, it swerved to the right and bounded high up in the air, as though some Frost Giant was playing foot ball, and was trying to hit the goal.
%%%
The old fairy felt insulted, or thought the questioner was trifling, and made no answer. So there was quiet for the space of three minutes.
%%%
THE ALPINE HUNTER AND HIS FAIRY GUARDIAN
%%%
HER COMPANION LEAPED WITH HER INTO THE LAKE
%%%
"You had warning enough; down you go!"
Just then the hunter's foot, with its hob-nailed [240]shoe, slipped upon a fragment of rock, and he fell. Over the cliff, down, down, down, the cruel man tumbled. A few minutes later, the Alpine condors were quarreling over his corpse. Later, the wolves picked his bones, that lay long upon the bare rocks. An awful warning!
After this, the chamois mothers, during the summer season, reared their kids in peace and quiet and all was happy in the high places, where the dwarfs and the chamois dwell as friends together.[241]
%%%
For instance, there were several of the Herwisch folk, or first cousins to the Will-o'-the-wisp. Several dozen of little creatures of this family, not much bigger than dolls, were on hand. They live on marshy ground and delight in lighting their little lanterns at night. Then they entice bumpkins and other dull fellows, out of the regular path in the fields, into the mud and swamp. When the clumsy chaps are floundering deep in the water, and down among the frogs and tadpoles, the Herwisch put out their lights and leave the louts in the wet, all the while laughing at them. Stupid fellows from the grog and beer shops, with their brains befuddled, are the chief victims of these merry mischiefs. It is good to see how many a drunkard gets a ducking and cooling off from these tiny tots.[196]
Some of the Herwisch folk have wings like bats, and to the bold girl or boy that is too smart, and makes fun of them, they come and flap their wings in his or her face and this frightens them. Men, especially, who have drunk too much wine, get easily scared. After it is dark, most people are careful not to anger, or irritate the Herwisches in any way.
Quite different in their bearing and looks, as well as in their ideas and manners, was another set of delegates to this fairy convention. These were the gnomes, the kobolds, and the elves. They were near relations, and looked very much alike, especially in stature, in the color of their skin, and in all having beards. Most of them live underground and in the mines. These very industrious and lively little fellows are always busy. Many among them look like old men. When they talk to each other, their long beards and chins wag up and down, so the boys and girls call them "chin choppers." They wear funny, peaked caps, each with a tassel on the end of it. They have to do with gold mines, for they understand all about fires, forges, coal, crucibles, and what one sees in a foundry.
A long time ago, one of these gnomes amused himself and enriched the good people in a place called Plurs, by pouring liquid gold in a crevice of the rocks. But having thus gained plenty [197]of the precious metal, the people got to be very proud, like most mortals who get rich suddenly. They lost their good manners, and got drunk and fell into very bad habits. When the gnomes saw that the heads of these mortals were turned, and that their hearts were like those of bad potatoes, they threw down tons of dirt upon the villages and destroyed them, just as men burn up caterpillars and potato bugs.
%%%
if (node->type != jSTRING)
    return NULL;
if (node->contents != NULL)
    return (jString*)node->contents;
jString* string = malloc(sizeof(*string));
node->contents = (void**)string;
string->holder = node;
string->length = node->datalen - 2;
string->chars = malloc(sizeof(*string->chars) * (string->length + 1));
for (int i = 0; i < node->datalen - 2; i++)
    string->chars[i] = node->rawdata[i + 1];
string->chars[string->length] = '\0';
return string;
%%%
*cur = '\0';
object->keys[i] = getjNode(prev);
*cur = ':';
prev = cur + 1;
cur = findNextComma(prev, node->rawdata + node->datalen);
if (cur == NULL) {
    *(node->rawdata + node->datalen - 1) = '\0';
    object->values[i++] = getjNode(prev);
    *(node->rawdata + node->datalen - 1) = '>';
    break;
} else {
    *cur = '\0';
    object->values[i++] = getjNode(prev);
    *cur = ',';
    prev = cur + 1;
    cur = findNextColon(prev, node->rawdata + node->datalen);
}

%%%
Before the two little girls could know what it all meant, the Harbys heard, in their home at Barren Hill, of the Continental Congress, held in Carpenters' Hall, in Philadelphia. In this gathering Canada was represented. Then, it was hoped that there would be fourteen stripes in the flag, which the Philadelphia City Troop of cavalry were making. But when their flag was unfurled and the handsome horsemen escorted Colonel George Washington, of Virginia, to Cambridge, many felt very sorry, that there were only thirteen, instead of the longed-for fourteen stripes, and hoped, even yet, that Canada would join.
War broke out. From the new State House, in Philadelphia, then one of the most wonderful buildings in any of the colonies, floated the flag of thirteen stripes, red and white, and independence was proclaimed.
%%%
"DRINK YOUNG FRIEND," SAID THE GIANT
"DRINK YOUNG FRIEND," SAID THE GIANT
[41]
As a rule, nobody knows, either in summer or winter, just when the avalanches will fall, or whether they will be made of light, powdery, dry snow, or of snow that is heavy, wet, and like what the boys call "soakers." Yet there are some old men in Switzerland, who can foretell avalanches, as our wise men try to do with the weather.
%%%
"We bow to your wisdom, and so it shall be written in our books. Nevertheless, both mortals and fairies must have also a short name for everyday use. How about the second, or personal part, Margarita?"
"As you will, your Highness, but may I suggest even a better term, in the speech of the mortals of this mountain land? They will love anything that you may clothe and adorn, I am sure."
After this ending of her speech, the wise old fairy curtsied most politely.
The Fairy Queen looked very lovely, as thus flattered, by the fine tact, and the charming speech, of this oldest member of the family; and, besides, as she loved the brave Swiss nation, she said.
%%%
*cur = '\0';
object->keys[i] = getjNode(prev);
*cur = ':';
prev = cur + 1;
cur = findNextComma(prev, node->rawdata + node->datalen);
if (cur == NULL) {
    *(node->rawdata + node->datalen - 1) = '\0';
    object->values[i++] = getjNode(prev);
    *(node->rawdata + node->datalen - 1) = '>';
    break;
} else {
    *cur = '\0';
    object->values[i++] = getjNode(prev);
    *cur = ',';
    prev = cur + 1;
    cur = findNextColon(prev, node->rawdata + node->datalen);
}

%%%
void freejNode (jNode* node) {
    if (node == NULL)
        return;
    *node->contents = NULL; // node->contents->holder
    switch (node->type) {
        case jSTRING:
            freejString((jString*)node->contents);
            break;
        case jNUMBER:
            freejNumber((jNumber*)node->contents);
            break;
        case jARRAY:
            freejArray((jArray*)node->contents);
            break;
        case jOBJECT:
            freejObject((jObject*)node->contents);
            break;
        default:
            break;
    }
    free (node->rawdata);
    free (node);
}
%%%
void freejNode (jNode* node) {
    if (node == NULL)
        return;
    *node->contents = NULL; // node->contents->holder
    switch (node->type) {
        case jSTRING:
            freejString((jString*)node->contents);
            break;
        case jNUMBER:
            freejNumber((jNumber*)node->contents);
            break;
        case jARRAY:
            freejArray((jArray*)node->contents);
            break;
        case jOBJECT:
            freejObject((jObject*)node->contents);
            break;
        default:
            break;
    }
    free (node->rawdata);
    free (node);
}
%%%
for (char* cur = start; cur < end; cur += 1) {
    if (*cur == '\0')
        return NULL;
    else if (*cur == '"')
        inString = !inString;
    else if (*cur == '[' && !inString)
        sbCount++;
    else if (*cur == ']' && !inString)
        sbCount--;
    else if (*cur == '<' && !inString)
        cbCount++;
    else if (*cur == '>' && !inString)
        cbCount--;
    else if (*cur == ',' && !inString && !cbCount && !sbCount)
        return cur;
}
%%%
if (node->type != jOBJECT)
    return NULL;
if (node->contents != NULL)
    return (jObject*)node->contents;
jObject* object = malloc(sizeof(*object));
node->contents = (void**)object;
object->holder = node;
int colonCount = 0;
char* cur = findNextColon(node->rawdata + 1, node->rawdata + node->datalen);
while (cur != NULL) {
    colonCount++;
    cur = findNextColon(cur + 1, node->rawdata + node->datalen);
}

object->size = colonCount;
object->keys = malloc(sizeof(*object->keys) * object->size);
object->values = malloc(sizeof(*object->values) * object->size);

int i = 0;
char* prev = node->rawdata + 1;
cur = findNextColon(prev, node->rawdata + node->datalen);
while (cur != NULL) {
    *cur = '\0';
    object->keys[i] = getjNode(prev);
    *cur = ':';
    prev = cur + 1;
    cur = findNextComma(prev, node->rawdata + node->datalen);
    if (cur == NULL) {
        *(node->rawdata + node->datalen - 1) = '\0';
        object->values[i++] = getjNode(prev);
        *(node->rawdata + node->datalen - 1) = '>';
        break;
    } else {
        *cur = '\0';
        object->values[i++] = getjNode(prev);
        *cur = ',';
        prev = cur + 1;
        cur = findNextColon(prev, node->rawdata + node->datalen);
    }
    
}

return object;
%%%
The whole front of the house was nearly hidden by vines and flowers that invited the bees and birds, though there were hives and dovecotes in the yard space, fronting the house. Cut into the corner columns, or through the gable [6]boards, was this Scripture sentence: "As for me and my house, we will serve the Lord."
Not far away was the barn and yard for the cows and chickens, ducks and geese. Near by, the purling of a running brook, fed from the mountain with water, cold, and clear as crystal, was like the singing of a sweet song. As neat as a new pin was this Spring House. Here upon shelves, only a little higher than the stream, and on the stone surbase that ran across one side of the low room, or floating in the cold water, were shallow pans for the milk. In a corner stood the big jar, to hold the cream, which was daily skimmed from the milk in the pans. The caldron and utensils for cheesemaking were kept in another corner. It was from cheese chiefly that the family lived, especially in winter.
%%%
void freejNumber(jNumber* number) {
    if (number->holder != NULL) {
        freejNode(number->holder);
        return;
    }
    free(number);
}
%%%
But when the stable boy went outdoors, he found the line of mules was some distance up the road, and that Gulick was leading them.
%%%
THE AVALANCHE THAT WAS PEACEMAKER
Sometimes judges and lawyers advise people, that have a quarrel, to settle their case outside of court. When a person thus decides between two, who are not agreed, we say that they are judicially minded. Now there was once, in Switzerland, an avalanche, that did what peacemakers and honest judges could not accomplish. So it was called the Judicial Avalanche.
%%%
In time, the rifle was made lighter to carry, prettier to look at, and easier to charge. Men discovered that the old way of loading was at the wrong end, and used the breech, instead of [143]the muzzle, to put in the cartridges. So the heavy mallet and ramrod were left behind and forgotten, and wars became shorter and less dreadful.[144]
[Contents]
XIV
%%%
jString* getjString(jNode* node) {
    if (node->type != jSTRING)
        return NULL;
    if (node->contents != NULL)
        return (jString*)node->contents;
    jString* string = malloc(sizeof(*string));
    node->contents = (void**)string;
    string->holder = node;
    string->length = node->datalen - 2;
    string->chars = malloc(sizeof(*string->chars) * (string->length + 1));
    for (int i = 0; i < node->datalen - 2; i++)
        string->chars[i] = node->rawdata[i + 1];
    string->chars[string->length] = '\0';
    return string;
}
%%%
jNode* getjNode (char* str) {
    // printf("creating node\n");
    jNode* node = malloc(sizeof(*node));
    char* start = firstNonSpace(str);
    char* end = firstEndSpace(start);
    node->type = getjNodeType(str);
    node->contents = NULL;
    node->datalen = end - start;
    node->rawdata = malloc(sizeof(*node->rawdata) * (node->datalen + 1));
    for (int i = 0; i < node->datalen; i++)
        node->rawdata[i] = start[i];
    return node;
}
%%%
for (int i = 0; i < array->size; i++) {
    printTabs(tabs + 1);
    printjNode(array->elements[i], tabs + 1);
    if (i < array->size - 1)
        printf(",");
    printf("\n");
}
%%%
if (*endValue == '"')
    inString = !inString;
else if (*endValue == '<' && !inString)
    cbCount++;
else if (*endValue == '>' && cbCount > 0 && !inString)
    cbCount--;
else if (*endValue == '>' && cbCount == 0 && !inString)
    break;
else if (*endValue == '[' && !inString)
    sbCount++;
else if (*endValue == ']' && !inString)
    sbCount--;
else if (*endValue == ',' && !cbCount && !sbCount && !inString)
    break;
endValue += 1;
%%%
str += 1;
 else if (*str >= '1' && *str <= '9') {
while (*str >= '1' && *str <= '9')
    str += 1;
 else { // number must contian at least one digit
return 0;
%%%
commaCount++;
cur = findNextComma(cur + 1, node->rawdata + node->datalen);
%%%
char* start = str;
while (*str != '\0') {
    if (!isCharWhitespace(*str))
        return 0;
    str += 1;
}
return str - start;
%%%
"First, to reward valor and virtue, by giving an august name; and second, to let the Frost Giants, the insolent fellows from the North Pole, know, that when even one of us fairies puts her foot down, it is like a lion's. No one can move, or lift, or push, or drive it away. We [150]thrust forward this fairy flower, as our banner, to say to the enemy, 'We shall not surrender, and we defy you!' "
The Fairy Queen, full of admiration, replied:
%%%
while (*endValue != '\0') {
    if (*endValue == '"')
        inString = !inString;
    else if (*endValue == '<' && !inString)
        cbCount++;
    else if (*endValue == '>' && cbCount > 0 && !inString)
        cbCount--;
    else if (*endValue == '>' && cbCount == 0 && !inString)
        break;
    else if (*endValue == '[' && !inString)
        sbCount++;
    else if (*endValue == ']' && !inString)
        sbCount--;
    else if (*endValue == ',' && !cbCount && !sbCount && !inString)
        break;
    endValue += 1;
}
%%%
Silver Wreath soon found out what Jeannod liked most to eat, for while she was a fairy, he was a mortal, and had a stomach, and, always, a lively appetite. He was very particular, and rather fussy about the kind of cheese he ate, and he always bought the best that could be found [213]in the market. In fact, he would often walk many miles, and spend his last coin, to get a cheese of an especially good brand or flavor, no matter at what price.
The fairy soon found this out, about her lover's taste, and when Jeannod was hungry, after climbing the steep rocks, she fed him on a most delicious kind of cheese. He declared no mortal man or woman could make any equal to it, whether in taste, or in nourishment, or in flavor. On the other hand, he amused her by singing, rattling off rhymes, or telling her stories about men and women. One of these, about "Peter, Peter, Pumpkin-eater," seemed to her to be the funniest of all. After that, when he asked her what he might bring her for a present, he was surprised to hear her say a "pumpkin shell." Then he laughed heartily. When he brought it to her, she kept the pumpkin shell in a rock crevice as a great curiosity and called it her doll house.
Jeannod was so happy in his love for fairy Silver Wreath, that he wanted to make her his wife. So one day, he kneeled before her and asked her to be his bride. He thought it would be easy for her to accept his love and care, after she had so helped and favored him.
%%%
The man on the left-hand side of the fireplace, appeared to be a woodman, or hunter. At least, he seemed to be used to the forest. Though it was pitch dark night, he knew where the wood lay, piled up under the eaves of the chalet; for, when the fire burned low, he went out doors and returned with an arm load of faggots. Then he piled up the wood, and the fire blazed, and crackled, and roared, until the boy in the loft thought the hut would be burned up, too. Yet, though he trembled at the strange sight, he was brave. He resolved not to be quiet, if the big men tried to steal his cheese, which was to be food for the family during the winter.
%%%
while (*endValue != '\0') {
    if (*endValue == '"')
        inString = !inString;
    else if (*endValue == '<' && !inString)
        cbCount++;
    else if (*endValue == '>' && cbCount > 0 && !inString)
        cbCount--;
    else if (*endValue == '>' && cbCount == 0 && !inString)
        break;
    else if (*endValue == '[' && !inString)
        sbCount++;
    else if (*endValue == ']' && !inString)
        sbCount--;
    else if (*endValue == ',' && !cbCount && !sbCount && !inString)
        break;
    endValue += 1;
}
%%%
// printf("printing\n");
// printf("type= %d\n", node->type);
switch (node->type) {
    case jSTRING: {
        printjString(getjString(node), tabs);
        break;
    } case jNUMBER: {
        printjNumber(getjNumber(node), tabs);
        break;
    } case jARRAY: {
        printjArray(getjArray(node), tabs);
        break;
    } case jOBJECT: {
        printjObject(getjObject(node), tabs);
        break;
    } default: {
        printf("Could not parse.\n");
        break;
    }
}
%%%
"Now I see that I am a fool," he cried, as he beat upon his breast. "That cow has more religion than I, for it kneels before it lies down; while, before tumbling into bed, my knee has been unbent, this many a year."
Then going back, he patted the neck of his faithful Gulick, washed off the blood stains, threw his spurs away, and spoke so kindly to the ass, that it rose up, and actually began frisking around. Then it sidled up close to Gruntli, and seemed to invite him to get on its back again.
This the man did, and, riding to where the village had been, organized a corps of relief to help the wounded and hungry, who were left alive, and he paid for medicines out of his own purse. Then he built new and better houses for his tenants, the survivors, and for those who came from other parts of the Swiss country.
%%%
return (*str++ == 't' &&
        *str++ == 'r' &&
        *str++ == 'u' &&
        *str++ == 'e' &&
        *str == '\0') ? 4 : 0;
%%%
char* start = str;
while (*str != '\0') {
    if (!isCharWhitespace(*str))
        return 0;
    str += 1;
}
return str - start;
%%%
while (cur != NULL) {
    commaCount++;
    cur = findNextComma(cur + 1, node->rawdata + node->datalen);
}
%%%
On the contrary, in the forest home of the chamois, there was much rejoicing, for they had heard the ring of the rifle and seen its flash. In fact, avalanches were very popular in chamois society, for even when one was seen coming, soon enough, the bucks and does could easily dodge them.[48]
[Contents]
V
THE MOUNTAIN GIANTS
%%%
if (*endValue == '"')
    inString = !inString;
else if (*endValue == '<' && !inString)
    cbCount++;
else if (*endValue == '>' && cbCount > 0 && !inString)
    cbCount--;
else if (*endValue == '>' && cbCount == 0 && !inString)
    break;
else if (*endValue == '[' && !inString)
    sbCount++;
else if (*endValue == ']' && !inString)
    sbCount--;
else if (*endValue == ',' && !cbCount && !sbCount && !inString)
    break;
endValue += 1;
%%%
char* firstNonSpace (char* str) {
    while (isCharWhitespace(*str))
        str += 1;
    return str;
}
%%%
The good daughter placed one of the big cheeses, still uneaten, upon her thumb nail, as a sign of truth. Then she declared she never would disturb anything, man or beast in the valley.
Now there was another giant, named Hotap, who, in disposition, was very different from his neighbor, and often played bad tricks on the farmers. He loved to start avalanches, by making a wet snowball called a soaker, and then flinging it over the snow and down into the valley, upon the villages. In this way, he ruined many houses, barns, and stables, killing men, goats, sheep, donkeys, chickens and cattle.
%%%
One night, Gruntli's overseer was returning from Zurich. He reached the village of Plurs, late at night. There, the wine being good and the stabling cheap, he expected to make his stay, until next morning. So, stepping into the wine room, and calling for the hostler, he sat down [254]before the table, thinking that all was right, according to the usual way of beasts and man, until morning.
But when the stable boy went outdoors, he found the line of mules was some distance up the road, and that Gulick was leading them.
%%%
"We bow to your wisdom, and so it shall be written in our books. Nevertheless, both mortals and fairies must have also a short name for everyday use. How about the second, or personal part, Margarita?"
"As you will, your Highness, but may I suggest even a better term, in the speech of the mortals of this mountain land? They will love anything that you may clothe and adorn, I am sure."
After this ending of her speech, the wise old fairy curtsied most politely.
%%%
The display, in the big window, of all the delicious things known to the confectioners, and many of them from foreign countries, advertised to be of "private growth," and "imported in our own fleet of ships" was dazzling.
Most astounding of all, was the tableau over the main entrance. It consisted of a group of carved and gilded figures, in front of a highly tinted background, showing the dwarf at the fire, with the well-spread tables and the dairyman as his guest.
Out on the street, the crowd that stood on the pavement, gazing up to see this pretty picture, in bas-relief, was so great, that the police [64]had to make a lane and keep open a passage way, through the press of old and young folks, so that ordinary people could get through.
So, for a half hour or more, inside that shepherd's brain, a moving picture show went on, as if a five-reel film was being rolled off, and his imagination had spread the screen. The bright colors, in this picture, of the furore for dwarf's candy exceeded any gallery of paintings known in Paris, or any panorama that could be made on canvas.
%%%
What was even more wonderful, Old Sol promised that every flower, as it climbed higher, should have a richer color on its cheeks, so that all the world would wonder. Then, the plants, [81]in the warmer regions lower down, should envy the brilliant faces of their sisters so high up. In fact, it was to be a beauty contest. "Nothing venture nothing have," should be the rule. They might not grow to be so tall. Their feet might be larger, for they would need strong toes, to hold on tight to the ground, when old Boreas, the wind giant, tried his best to blow them away; but to win out, they were sure to do, in the end, and beat Jack Frost and all his army.
When the fairies were called together, and told by their queen that the Sun would be their friend and help them every day, and never tire of his good work, you ought to have seen how happy they were. They all clapped their hands, and every one, big and little, wanted to be brave and go out to fight the frost giants. Each volunteer said, "I am not afraid. The frost giants can't freeze me."
It was wonderful how the pretty fairies were perfectly willing to be changed into humble looking plants, that never could grow very tall, but lie quite flat on the ground, and have deep roots in the crannies. They would have to live without much society, or excitement, and spend their lives in clefts and hollows. What was hardest to bear, was, that most of them would have to live like nuns; for in the case of many of them, [82]their beauty would never be appreciated or even seen.
%%%
Nevertheless, there were times, when the donkey, Gulick, showed that it had a mind of its own. Then it could be stubborn, too. But this was what men thought, and not the animal's own opinion of itself. This usually took place, when it saw that the path ahead, or the ledge of rock, over which it was expected to pass, with a pack load, or a stout lady in the saddle, or a big fat fellow, with both legs far out and taking up the room, between the ass and the rock.
Then, no amount of scolding, yelling, bad temper, hard names, or even beating, could move [253]the creature. The only thing to do was to get off and unload. In fact, the ass had a very poor opinion of some human beings. He even pitied them, because they had only two legs, while donkeys had four.
Not once, in all its long life, did Gulick lose its way, slip, fall down, or have an accident. In fact, its master could go to sleep, while riding home. When, as was often the case, the man was too full of strong wine, to sit up straight, this was a good thing; for a sober donkey has more brains than a drunken man.
Some people, who believed in fairies, even thought that Gulick was really a human being who, for doing something wicked, in another world, had been changed, by a fairy, into this creature with the shaggy hide, ropy tail and ears like a jack rabbit's.
%%%
if (node->type != jNUMBER)
    return NULL;
if (node->contents != NULL)
    return (jNumber*)node->contents;
jNumber* number = malloc(sizeof(*number));
node->contents = (void**)number;
number->holder = node;
if (containsDecimalOrExponent(node->rawdata, node->datalen)) {
    number->isInt = 0;
    number->dvalue = atof(node->rawdata);
    number->ivalue = (int)number->dvalue;
} else {
    number->isInt = 1;
    number->ivalue = atoi(node->rawdata);
    number->dvalue = (double)number->ivalue;
}
return number;
%%%
jArray* getjArray(jNode* node) {
    if (node->type != jARRAY)
        return NULL;
    // printf("getting array\n");
    if (node->contents != NULL)
        return (jArray*)node->contents;
    jArray* array = malloc(sizeof(*array));
    node->contents = (void**)array;
    array->holder = node;
    int commaCount = 0;
    char* cur = findNextComma(node->rawdata + 1, node->rawdata + node->datalen);
    while (cur != NULL) {
        commaCount++;
        cur = findNextComma(cur + 1, node->rawdata + node->datalen);
    }

    if (!commaCount && *firstNonSpace(node->rawdata + 1) == ']')
        array->size = 0;
    else
        array->size = commaCount + 1;
    array->elements = malloc(sizeof(*array->elements) * array->size);

    int i = 0;
    char* prev = node->rawdata + 1;
    cur = findNextComma(prev, node->rawdata + node->datalen);
    while (cur != NULL) {
        *cur = '\0';
        array->elements[i++] = getjNode(prev);
        *cur = ',';
        prev = cur + 1;
        cur = findNextComma(prev, node->rawdata + node->datalen);
    }
    // printf("prev=%c\n", *prev);
    if (array->size > 0) {
        *(node->rawdata + node->datalen - 1) = '\0';
        array->elements[i] = getjNode(prev);
        *(node->rawdata + node->datalen - 1) = ']';
    }
    
    
    // printf("array size=%d\n", array->size);
    // printf("array[0]=%p\n", array->elements[0]);
    return array;
}
%%%
void freejObject(jObject* object) {
    if (object->holder != NULL) {
        freejNode(object->holder);
        return;
    }
    for (int i = 0; i < object->size; i++) {
        freejNode(object->keys[i]);
        freejNode(object->values[i]);
    }
    free(object->keys);
    free(object->values);
    free(object);
}
%%%
Now in this place, and just at this time, there was a very ugly and dilapidated old house of worship, which had been erected several hundred years before, and was now almost ready to tumble to pieces.
For a long time, the question, of tearing down the old church and erecting in its place a new one, in modern style, had so vexed the community, [159]that a disgraceful squabble had broken out. The people of one party would not speak to, or have anything to do with, those of the other way of thinking; and all on account of this old building. The young people were hot for a new edifice. They hoped to get an architect from Zurich, who had gone from their village, and had his plans all ready, which the young ladies all said were "just lovely."
Against these, the old folks held to the idea of keeping the holy house yet a while longer. The aged people were especially anxious that the venerable tower should not be touched, but be kept; and they even wanted to give it a new coat of paint, for which, of course, the younger party would not vote.
On this very afternoon, the choir had gathered to practice to sing the hymns for Sunday. The organist had put his foot on the pedals and struck the keys, and the soprano had just opened her mouth, when down thundered the avalanche!
%%%
return (*str++ == 't' &&
        *str++ == 'r' &&
        *str++ == 'u' &&
        *str++ == 'e' &&
        *str == '\0') ? 4 : 0;
%%%
if (array->holder != NULL) {
    freejNode(array->holder);
    return;
}
for (int i = 0; i < array->size; i++)
    freejNode(array->elements[i]);
free(array->elements);
free(array);
%%%
void freejObject(jObject* object) {
    if (object->holder != NULL) {
        freejNode(object->holder);
        return;
    }
    for (int i = 0; i < object->size; i++) {
        freejNode(object->keys[i]);
        freejNode(object->values[i]);
    }
    free(object->keys);
    free(object->values);
    free(object);
}
%%%
Now like a great army they are, indeed. They laugh at winter's cold, or icy wind, or driving sleet, and even at that scorching south wind, the Fohn, that blows for over two weeks [188]in the spring time, and again, for a fortnight in the autumn. By and bye, in a little while, according to the fairy clock, that is, in a million years or so, the Kangaroo Poa had spread all over Switzerland. Twenty thousand cows were made happy, for they loved to browse on the Poa pastures, and liked nothing better. Now, nearly two million of Swiss cows enjoy the summer feast, while their bells tinkle on the hillsides.
When the calves were too big for their mother's milk, and the lady cow got tired of being a restaurant for her booby calf, she pushed it away, and said, in cow language, "go and eat Poa." Sometimes the calf did not like to give up its baby habits, learned in the nursery. Then, it behaved like the naughty boy, who said "I'm hungry and bread I won't have. I want cake."
Then the mother cow tried another plan. She would give notice to the cowherd, in her own language, that she had done her part, and wanted him to attend to her naughty, and bad tempered, or sulky calf. Then the man would put a leather strap with sharp nails on it, over the calf's muzzle, so that, when calfy wanted refreshment, it would be like sticking pins into its mother. Then the cow would push the calf away and make it learn to eat Poa.
But once having taken a bite, the calf never [189]again wanted to eat anything else. It tasted as good as candy to a little girl. So Switzerland became one of the greatest countries in the world for butter and cheese. The fairies rejoiced, too, for the Poa, with its pretty blossom, made the meadows, which were their dancing hall, more beautiful, and for them, it was like waltzing on a cloth of gold.
%%%
[201]
%%%
Scratching, cracking, dropping out dirty stuff, rock and gravel, it acted like a dredge box. It sprinkled out its contents, to fill up the great deep green crevasses in the ice, until it finally reached a big open space of waste land, that had nothing on it, but rocks and bushes. Then, with a roar, as if laughing at itself, it broke up, spread open, and left the place strewn with more rocks and stones and lumps of ice.
%%%
THE SWISS FAIRIES IN TOWN MEETING
In Appenzell, and some other cantons in the heroic Swiss republic, many old democratic customs still prevail. One of these is seen in the Landsgemeinde, or meeting of all the men not only in a village, but in the whole canton, or district.
%%%
if (node->type != jSTRING)
    return NULL;
if (node->contents != NULL)
    return (jString*)node->contents;
jString* string = malloc(sizeof(*string));
node->contents = (void**)string;
string->holder = node;
string->length = node->datalen - 2;
string->chars = malloc(sizeof(*string->chars) * (string->length + 1));
for (int i = 0; i < node->datalen - 2; i++)
    string->chars[i] = node->rawdata[i + 1];
string->chars[string->length] = '\0';
return string;
%%%
if (*endValue == '"')
    inString = !inString;
else if (*endValue == '<' && !inString)
    cbCount++;
else if (*endValue == '>' && cbCount > 0 && !inString)
    cbCount--;
else if (*endValue == '>' && cbCount == 0 && !inString)
    break;
else if (*endValue == '[' && !inString)
    sbCount++;
else if (*endValue == ']' && !inString)
    sbCount--;
else if (*endValue == ',' && !cbCount && !sbCount && !inString)
    break;
endValue += 1;
%%%
At first, for several seconds, with Soaker Smash-All, it was more like ploughing, than rolling its way through the drifts, for the slope was slight. Then, as the incline grew more steep, the tumbling became more rapid, until about a half mile from the starting point, the baby avalanche had, by its leaps and bounds grown so fast, as to be already as big as a barn. It was bouncing swiftly along, when, instead of going straight ahead, as its daddy, the Frost King, had planned and expected, it rolled against a rounded rock, that curved up and backwards, like the dashboard of a sleigh, or the roof of a pagoda.
At once, it swerved to the right and bounded high up in the air, as though some Frost Giant was playing foot ball, and was trying to hit the goal.
%%%
char* start = str;
if (*str != '<')
    return 0;
while (*str != '>') {
    int inString = 0, cbCount = 0, sbCount = 0; // " < [
    char* endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && !cbCount && !inString)
            break;
        else if (*endValue == ':' && !cbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    char endHolder = *endValue;
    *endValue = '\0';
    json_type elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE &&
        *str == '<' && 
        *endValue == '>')
        return endValue - start;

    if (elementType != jSTRING ||
        *endValue == '>')
        return 0;

    str = endValue;

    inString = 0, cbCount = 0, sbCount = 0;
    endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && cbCount == 0 && !inString)
            break;
        else if (*endValue == '[' && !inString)
            sbCount++;
        else if (*endValue == ']' && !inString)
            sbCount--;
        else if (*endValue == ',' && !cbCount && !sbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    endHolder = *endValue;
    *endValue = '\0';
    elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE ||
        elementType == jERROR)
        return 0;

    str = endValue;
}

if (*++str == '\0')
    return str - start;
return 0;
%%%
int isjWhitespace (char* str) {
    char* start = str;
    while (*str != '\0') {
        if (!isCharWhitespace(*str))
            return 0;
        str += 1;
    }
    return str - start;
}
%%%
char* start = str;
while (*str != '\0') {
    if (!isCharWhitespace(*str))
        return 0;
    str += 1;
}
return str - start;
%%%
for (int i = 0; i < len; i++)
    if (str[i] == '.' || str[i] == 'e' || str[i] == 'E')
        return 1;
return 0;
%%%
*cur = '\0';
object->keys[i] = getjNode(prev);
*cur = ':';
prev = cur + 1;
cur = findNextComma(prev, node->rawdata + node->datalen);
if (cur == NULL) {
    *(node->rawdata + node->datalen - 1) = '\0';
    object->values[i++] = getjNode(prev);
    *(node->rawdata + node->datalen - 1) = '>';
    break;
} else {
    *cur = '\0';
    object->values[i++] = getjNode(prev);
    *cur = ',';
    prev = cur + 1;
    cur = findNextColon(prev, node->rawdata + node->datalen);
}

%%%
"Let me tell you, then, about the kangaroo, that lives in Australia. She has a wallet, or [185]travelling bag where, or in which, she stows away her little folks, and there they are as cozy as if they were riding in a wagon. Yet, all the time, they can look out and see what is going on in the world. In this way, both the young opossums and the kangaroos are kept warm, and are fed until they are grown. No wolves, or bears, or foxes can catch and run away with them."
"Can a kangaroo climb a tree?" asked a fairy, whose fancy had been greatly taken with the idea of a whole family being up a tree at once, and free from the wolves.
%%%
But by and bye, Hilty, while he was a good fellow, became too inquisitive. He wanted to know the secrets of the dwarfs and even pestered them with questions. Then, they warned him that they could not tell, and that he must not ask. When he got too troublesome, the chief of the dwarfs thought it was time to give him a lesson. So one day, Hilty was invited, by an old white beard, to come and pay a visit to his cave.
%%%
int isjObject (char* str) {
    char* start = str;
    if (*str != '<')
        return 0;
    while (*str != '>') {
        int inString = 0, cbCount = 0, sbCount = 0; // " < [
        char* endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && !cbCount && !inString)
                break;
            else if (*endValue == ':' && !cbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        char endHolder = *endValue;
        *endValue = '\0';
        json_type elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE &&
            *str == '<' && 
            *endValue == '>')
            return endValue - start;

        if (elementType != jSTRING ||
            *endValue == '>')
            return 0;

        str = endValue;

        inString = 0, cbCount = 0, sbCount = 0;
        endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && cbCount == 0 && !inString)
                break;
            else if (*endValue == '[' && !inString)
                sbCount++;
            else if (*endValue == ']' && !inString)
                sbCount--;
            else if (*endValue == ',' && !cbCount && !sbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        endHolder = *endValue;
        *endValue = '\0';
        elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE ||
            elementType == jERROR)
            return 0;

        str = endValue;
    }

    if (*++str == '\0')
        return str - start;
    return 0;
}
%%%
The tailor overheard the steward's talk, and at once he proposed a plan, by which the contest between the two claimants could be settled. Let that hogshead of rice be made into one enormous pudding. It must be well sweetened, and with plenty of raisins and powdered nutmeg on top, and then divided into two parts, or piles. Whichever ate up his portion, most quickly, should be hailed as the hero, marry the princess, get the money, and be publicly announced, by the trumpeters, as the royal son-in-law and successor to the throne.
"Now I'll keep my promise," said the tailor to himself, "as to what I could do, with only a pair of scissors and a bag."
So, when the boiled rice, smoking hot, was piled on trenchers, and served on a long table, with a small shovel beside each large wooden plate, the trial began. The giant went at his mess, as if he were himself a dragon. To his astonishment, however, the tailor made the rice pudding disappear as fast as he himself could. Even after unbuckling his belt, and letting out, first, two, and then four holes, in the leather, the tailor kept on.
Finally the giant had to stop. He rolled over on the floor and cried out:
%%%
He had hardly stepped out of the topaz cave, [140]which seemed to close like a door behind him, than there appeared in view four chamois, each full grown and with splendid horns. Putting his rifle to his shoulder and taking careful aim, though the distance was great, he fired. Instantly, there fell the finest of the animals, while the others scampered away.
Retrieving his prize, Walter started down the mountain with the buck on his back. Reaching home, his wife embraced him, and all his children gathered round him, while his dog frisked about him in delight. Then he told the whole story.
%%%
"So you see, daughter Bertha," said Old Gargy, her daddy, "what these human creatures can do for us. So, do you let them alone; and, in the future, harm them not, even in play. Then [53]they will give us more bread and cheese and milk."
%%%
if (containsDecimalOrExponent(node->rawdata, node->datalen)) {
    number->isInt = 0;
    number->dvalue = atof(node->rawdata);
    number->ivalue = (int)number->dvalue;
} else {
    number->isInt = 1;
    number->ivalue = atoi(node->rawdata);
    number->dvalue = (double)number->ivalue;
}
%%%
Once upon a time, the fairies that live up near the mountain tops got together, and one said to another:
"Let us go travelling."
"We'll go as far as Geneva," said another.
"Agreed," they all shouted in chorus. "It will be like going from the North Pole to the Spice Islands. We can see all sorts of landscapes and go through many climates, before we get to Geneva. So let us all begin our journey today!"
%%%
As for the church question, that was settled. There must be a new building and there was one soon, which, when finished, toned up the whole dorf. At a later meeting, one frivolous youth proposed a resolution of thanks to the avalanche, but this was voted down. Then the pertinacious fellow brought in a proposition to give thanks for the special Providence, that had opened the way to peace in the church. This was carried by a [162]majority vote, all the young people being on the affirmative side.
%%%
return (*str++ == 'f' &&
        *str++ == 'a' &&
        *str++ == 'l' &&
        *str++ == 's' &&
        *str++ == 'e' &&
        *str == '\0') ? 5 : 0;
%%%
She did not feel, just then, like marrying either of them, big or little. When, however, she thought it over, she believed she could live on her income better with the tailor, than with the giant, who was already beginning to ask when dinner would be ready.
%%%
TWO GOOD NATURED DRAGONS
%%%
commaCount++;
cur = findNextComma(cur + 1, node->rawdata + node->datalen);
%%%
char* start = str;
if (*str != '<')
    return 0;
while (*str != '>') {
    int inString = 0, cbCount = 0, sbCount = 0; // " < [
    char* endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && !cbCount && !inString)
            break;
        else if (*endValue == ':' && !cbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    char endHolder = *endValue;
    *endValue = '\0';
    json_type elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE &&
        *str == '<' && 
        *endValue == '>')
        return endValue - start;

    if (elementType != jSTRING ||
        *endValue == '>')
        return 0;

    str = endValue;

    inString = 0, cbCount = 0, sbCount = 0;
    endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && cbCount == 0 && !inString)
            break;
        else if (*endValue == '[' && !inString)
            sbCount++;
        else if (*endValue == ']' && !inString)
            sbCount--;
        else if (*endValue == ',' && !cbCount && !sbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    endHolder = *endValue;
    *endValue = '\0';
    elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE ||
        elementType == jERROR)
        return 0;

    str = endValue;
}

if (*++str == '\0')
    return str - start;
return 0;
%%%
But in spring time, when the sun began to climb high in the sky, and the sap rose in the trees, the flowers bloomed, and, the cows went, with the cheesemakers, to the higher pastures, the two dragons grew restless, and their appetites came back in full force. Hoping to catch a nice fat maiden or two, they began to stretch, and roll, and to writhe, and tumble. They flapped, and furled, and unfolded their wings, until they felt ready to soar and swoop, with all their former skill.
By this time, also, the cooper began to get homesick. Even though afraid to meet his wife, he was longing to see his children, after his long absence. He had got very tired of looking only on rocks and the walls of the ravine. Moreover, the dragons did not seem to be as sociable, [73]as at first, and they amused him no longer. Besides, he wanted to see his neighbors again, to tell them of his adventures and even to pose as a hero. He feared, however, that before he tried to get away, the dragons might still eat him up; for they snorted, and bellowed, and rubbed their stomachs, with their forepaws, as if hungry enough, indeed, to swallow a horse with its harness on.
One warm day, the cooper heard, afar off, the echoes of the Alpine horn. He listened with delight to the yodel music, as the shepherds called their cows and goats. As he was wondering how he could get out of the valley, and whether the dragons would let him go, he saw the larger one of the two monsters unfurl his wings, which were as big as a windmill's sails. He flew straight up in the air, and, when near the blue sky, circled about a few times, like the carrier pigeons, which the cooper had seen at home. Then, careering far away, he disappeared in the dim distance beyond. No doubt, that day, some poor daddy, on coming home at night, missed one of his daughters. The cooper had noticed, that both the dragons had been roaring with hunger, for several days previously, and now he had his fears.
So the cooper watched his chance, determined not to let the other dragon get away, without his stealing a ride on the monster's back. He knew [74]that a man's weight, for a dragon to carry in the air, would hardly be felt, so much as that of a feather.
%%%
The story would take too much time to tell, if we tried to note every detail. For a week previous, the snow had fallen continuously. It darkened the air, and covered the earth with many feet of solid whiteness. One old man was full of forebodings of calamity. On the edge of a cliff, far up on the mountain side, mighty masses of snow piled up, stood like a lofty tower, in terrible menace, likely soon to fall. All were hoping for the Fohn, or south wind, to blow and "eat up" the snow.
%%%
For breakfast, the Harbys had honey, bread, milk and eggs. On the wall, resting on pegs, was the father's gun, for hunting. It was a real rifle, and few men in the world, except the Swiss and the Jager, or hunters, then knew of this wonderful weapon.
For dinner, they often had chamois or ibex, and, occasionally, bear meat, for John Harby was a dead shot with the rifle. Beef, with greens, was common, though the chief staple of food was cheese, or cream cooked in many wonderful ways, with cheese-cake, or pie, though buttermilk was in daily demand.
What the young folks liked, best of all, was the weekly treat of "schnitzel." This was made of boiled ham, dumplings of wheat flour, dried apples and spices, and was served on the table with molasses. When nicely cooked, and, as mother knew how to make it, nothing tasted better. It was enjoyed until the waist belts of youngsters began to tighten.
Every morning, the doors of the clock, set in a box or house on the wall, flew open, and the cuckoo chirped its song and then retired inside from view. The wooden bird thus gave notice [8]that it was time to get up and make ready for school.
%%%
Then he clutched his whip more tightly, expecting to get down and thrash the animal with all his strength.
But Gulick moved on, the road narrowing down, between rocks, as many bridle paths in Switzerland do. Yet no sooner had the intelligent beast entered into the shadow, than again a shining angel appeared in the path in front of them, but this time in a threatening manner, and waving his glittering sword.
Startled at the sight, the ass again stopped, hoping its master would treat his own beast more kindly and see what was the matter.
%%%
"Well, the four-legged creature is the opossum, and lives in America. The mother carries a whole family of her cubs in a chatelaine pocket, which she wears in the front of her dress. She can even climb up a tree with her family.
"Who can believe that?" whispered one fairy to another. "And the other?" she asked, hardly believing such a thing was possible.
"Let me tell you, then, about the kangaroo, that lives in Australia. She has a wallet, or [185]travelling bag where, or in which, she stows away her little folks, and there they are as cozy as if they were riding in a wagon. Yet, all the time, they can look out and see what is going on in the world. In this way, both the young opossums and the kangaroos are kept warm, and are fed until they are grown. No wolves, or bears, or foxes can catch and run away with them."
%%%
Before starting on the expedition to capture the siren, every man was taken into the cathedral, and, before the altar, made to cross himself on the breast, and swear not to listen to the Lorelei's [247]song. All of them wore helmets, with thick padded ear muffs, coming down over their ears, and tied tight. All the orders of the captain were to be given by signs without his speaking a word.
%%%
if (node->type != jOBJECT)
    return NULL;
if (node->contents != NULL)
    return (jObject*)node->contents;
jObject* object = malloc(sizeof(*object));
node->contents = (void**)object;
object->holder = node;
int colonCount = 0;
char* cur = findNextColon(node->rawdata + 1, node->rawdata + node->datalen);
while (cur != NULL) {
    colonCount++;
    cur = findNextColon(cur + 1, node->rawdata + node->datalen);
}

object->size = colonCount;
object->keys = malloc(sizeof(*object->keys) * object->size);
object->values = malloc(sizeof(*object->values) * object->size);

int i = 0;
char* prev = node->rawdata + 1;
cur = findNextColon(prev, node->rawdata + node->datalen);
while (cur != NULL) {
    *cur = '\0';
    object->keys[i] = getjNode(prev);
    *cur = ':';
    prev = cur + 1;
    cur = findNextComma(prev, node->rawdata + node->datalen);
    if (cur == NULL) {
        *(node->rawdata + node->datalen - 1) = '\0';
        object->values[i++] = getjNode(prev);
        *(node->rawdata + node->datalen - 1) = '>';
        break;
    } else {
        *cur = '\0';
        object->values[i++] = getjNode(prev);
        *cur = ',';
        prev = cur + 1;
        cur = findNextColon(prev, node->rawdata + node->datalen);
    }
    
}

return object;
%%%
int isjObject (char* str) {
    char* start = str;
    if (*str != '<')
        return 0;
    while (*str != '>') {
        int inString = 0, cbCount = 0, sbCount = 0; // " < [
        char* endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && !cbCount && !inString)
                break;
            else if (*endValue == ':' && !cbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        char endHolder = *endValue;
        *endValue = '\0';
        json_type elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE &&
            *str == '<' && 
            *endValue == '>')
            return endValue - start;

        if (elementType != jSTRING ||
            *endValue == '>')
            return 0;

        str = endValue;

        inString = 0, cbCount = 0, sbCount = 0;
        endValue = str + 1;
        while (*endValue != '\0') {
            if (*endValue == '"')
                inString = !inString;
            else if (*endValue == '<' && !inString)
                cbCount++;
            else if (*endValue == '>' && cbCount > 0 && !inString)
                cbCount--;
            else if (*endValue == '>' && cbCount == 0 && !inString)
                break;
            else if (*endValue == '[' && !inString)
                sbCount++;
            else if (*endValue == ']' && !inString)
                sbCount--;
            else if (*endValue == ',' && !cbCount && !sbCount && !inString)
                break;
            endValue += 1;
        }
        if (*endValue == '\0')
            return 0;

        endHolder = *endValue;
        *endValue = '\0';
        elementType = getjNodeType(str + 1);
        *endValue = endHolder;

        if (elementType == jWHITESPACE ||
            elementType == jERROR)
            return 0;

        str = endValue;
    }

    if (*++str == '\0')
        return str - start;
    return 0;
}
%%%
Flying straight up, high in the air, and swiftly descending, swooping down and striking the bird in the neck, with its sharp beak, the falcons brought down the game to their masters, until the hunting bags were full. Women, as well as men, loved this sport, and it was a gay sight, when a cavalcade of ladies and gentlemen, as they issued from the castle, and all on horseback, went out for a hunt, while the gamekeepers with the falcons and bush-beaters, with the dogs, followed. [103]The men on foot carried a spear, in case they should meet a bear, or wild boar. On their return, the hunting party would have a feast in the castle.
Now it was the belief, in Asia, that a good person, after his death, was born again in another world, and became a still holier being or even an angel. But a bad person, after his death, if he had been a tale-bearer or deceitful, or told lies, would be changed into a snake. If he had been stupid, he might become a sheep or donkey, or a mule. Or, if he or she had been too proud, each was reborn as a peacock; if cruel, into a tiger or a hawk.
There were many girls in Japan, named Taka, which means a hawk, because of their bad temper, or their cruelty to puppies or kittens. Sometimes, however, the name was a compliment, because they were quick and smart, like falcons.
Now, according to these ideas, there was a very hard-hearted man, named Chicksha, who beat his children. When angry, he threw dishes at his wife and cursed his servants. One day, when in a fit of bad temper, he fell dead. No one was sorry, and some were even glad.
%%%
Yet no matter how hard these Undines might try to get their clothes entirely dry, they could never wring the water out wholly of their garments, so that they were always more or less damp. If they had changed their form too quickly, their clothes would drip, and make spots on the floor, or ground. Often the village folk felt dampness, on their limbs below the knees. Yet few ever gave the matter a second thought, for their minds were wholly set on having a good time, and they had it.
%%%
return 
    ch == ' ' ||
    ch == '\t' ||
    ch == '\r' ||
    ch == '\n';
%%%
for (int i = 0; i < object->size; i++) {
    printTabs(tabs + 1);
    printjNode(object->keys[i], tabs + 1);
    printf(": ");
    printjNode(object->values[i], tabs + 1);
    if (i < object->size - 1)
        printf(",");
    printf("\n");
}

printTabs(tabs);
%%%
Now this funny old fellow had a name which, if translated, into English, would be Soft Pudding. He was a kind-hearted chap, that loved [95]the birds, and his pets, and children, but he was a most absent-minded codger. He never knew where his hat was, when he went outdoors, so his wife tied it, by a string, on to his button hole, as she did the little children's mittens with a bit of tape, over their shoulders. Yet he was a delightful daddy, and all the little folks loved him.
Mr. Soft Pudding gladly paid the bill for his new toy, the sundial. He was so overjoyed at the idea of telling time by a shadow, that he talked about it for hours. Indeed, he was so absorbed in it, that he forgot all about the sun, and the necessity of its shining, or that daylight was at all requisite for his enjoyment, in looking at the sundial.
%%%
jArray* getjArray(jNode* node) {
    if (node->type != jARRAY)
        return NULL;
    // printf("getting array\n");
    if (node->contents != NULL)
        return (jArray*)node->contents;
    jArray* array = malloc(sizeof(*array));
    node->contents = (void**)array;
    array->holder = node;
    int commaCount = 0;
    char* cur = findNextComma(node->rawdata + 1, node->rawdata + node->datalen);
    while (cur != NULL) {
        commaCount++;
        cur = findNextComma(cur + 1, node->rawdata + node->datalen);
    }

    if (!commaCount && *firstNonSpace(node->rawdata + 1) == ']')
        array->size = 0;
    else
        array->size = commaCount + 1;
    array->elements = malloc(sizeof(*array->elements) * array->size);

    int i = 0;
    char* prev = node->rawdata + 1;
    cur = findNextComma(prev, node->rawdata + node->datalen);
    while (cur != NULL) {
        *cur = '\0';
        array->elements[i++] = getjNode(prev);
        *cur = ',';
        prev = cur + 1;
        cur = findNextComma(prev, node->rawdata + node->datalen);
    }
    // printf("prev=%c\n", *prev);
    if (array->size > 0) {
        *(node->rawdata + node->datalen - 1) = '\0';
        array->elements[i] = getjNode(prev);
        *(node->rawdata + node->datalen - 1) = ']';
    }
    
    
    // printf("array size=%d\n", array->size);
    // printf("array[0]=%p\n", array->elements[0]);
    return array;
}
%%%
while (*endValue != '\0') {
    if (*endValue == '"')
        inString = !inString;
    else if (*endValue == '<' && !inString)
        cbCount++;
    else if (*endValue == '>' && cbCount > 0 && !inString)
        cbCount--;
    else if (*endValue == '>' && cbCount == 0 && !inString)
        break;
    else if (*endValue == '[' && !inString)
        sbCount++;
    else if (*endValue == ']' && !inString)
        sbCount--;
    else if (*endValue == ',' && !cbCount && !sbCount && !inString)
        break;
    endValue += 1;
}
%%%
So, when the boiled rice, smoking hot, was piled on trenchers, and served on a long table, with a small shovel beside each large wooden plate, the trial began. The giant went at his mess, as if he were himself a dragon. To his astonishment, however, the tailor made the rice pudding disappear as fast as he himself could. Even after unbuckling his belt, and letting out, first, two, and then four holes, in the leather, the tailor kept on.
Finally the giant had to stop. He rolled over on the floor and cried out:
"I'm beaten. Give the tailor the princess and the money; but don't let him skin me alive."[130]
All the while, the tailor, who had a pal, under the table, to hand him bag after bag, as he dropped into them the shovelfuls of rice pudding. He filled, first, one big bag, strapped to his bosom, and when that was full, he put on another. The giant was so occupied with gorging himself, that he did not notice anything, but the rice before him.
%%%
*str != 't') {
return 0;

%%%
if (node->type != jOBJECT)
    return NULL;
if (node->contents != NULL)
    return (jObject*)node->contents;
jObject* object = malloc(sizeof(*object));
node->contents = (void**)object;
object->holder = node;
int colonCount = 0;
char* cur = findNextColon(node->rawdata + 1, node->rawdata + node->datalen);
while (cur != NULL) {
    colonCount++;
    cur = findNextColon(cur + 1, node->rawdata + node->datalen);
}

object->size = colonCount;
object->keys = malloc(sizeof(*object->keys) * object->size);
object->values = malloc(sizeof(*object->values) * object->size);

int i = 0;
char* prev = node->rawdata + 1;
cur = findNextColon(prev, node->rawdata + node->datalen);
while (cur != NULL) {
    *cur = '\0';
    object->keys[i] = getjNode(prev);
    *cur = ':';
    prev = cur + 1;
    cur = findNextComma(prev, node->rawdata + node->datalen);
    if (cur == NULL) {
        *(node->rawdata + node->datalen - 1) = '\0';
        object->values[i++] = getjNode(prev);
        *(node->rawdata + node->datalen - 1) = '>';
        break;
    } else {
        *cur = '\0';
        object->values[i++] = getjNode(prev);
        *cur = ',';
        prev = cur + 1;
        cur = findNextColon(prev, node->rawdata + node->datalen);
    }
    
}

return object;
%%%
if (*endValue == '"')
    inString = !inString;
else if (*endValue == '<' && !inString)
    cbCount++;
else if (*endValue == '>' && cbCount > 0 && !inString)
    cbCount--;
else if (*endValue == '>' && cbCount == 0 && !inString)
    break;
else if (*endValue == '[' && !inString)
    sbCount++;
else if (*endValue == ']' && !inString)
    sbCount--;
else if (*endValue == ',' && !cbCount && !sbCount && !inString)
    break;
endValue += 1;
%%%
Here was one creature, dazzlingly splendid in colors, while, alongside of her, was a little lady robed entirely in white, as if she were to be the bride of Jack Frost, and marry him in a country where the tint of ermine and ptarmigan bird was the only one in fashion.
The lowliness, of some of these new born flowers, was perhaps the most astonishing thing about them. Even when in bloom they were not over an inch in height, while their neighbors, down in the valley, were all nearly as tall as yard sticks. One group became only plain meadow grass, while their relatives seemed dressed for Fifth Avenue, or the main street of Zurich or Berne.
Although, when the fairies were turned into trees, and were, at first, hardly higher than a needle, and not one of them had a body as thick as a thimble, they at once began whispering, for [85]it was hard to give up the old habit of talking every minute.
Of one pretty creature, shaped like a blue bell, with scalloped edges, it was noticed that she shut up her mouth, and did not say a word. At this, one wise old fairy looked up at the sky, and said, "It is certainly going to rain." Thereupon, since flowers were so cheap, this one, they called "the poor man's weather glass." Another, that had a curiously shaped blossom, they named Lady's Slipper. To still another, very reddish, tufty, and strong, they gave the title of Prince's Feather; while an unusually pert and active one, that had a very expressive face, they christened Johnny-jump-up. This fairy had whimpered a little, at the idea of being named after a boy; but, when told she would have clothes of many colors, she was instantly happy, and welcomed her change into a flower with a face that would never need rouge, or lily white powder.
%%%
if (*str == '0') {
    str += 1;
} else if (*str >= '1' && *str <= '9') {
    while (*str >= '1' && *str <= '9')
        str += 1;
} else { // number must contian at least one digit
    return 0;
}
%%%
Many another adventure did that judicial avalanche have, before it had scudded past other villages, but hurting next to nothing, avoiding forests, farmhouses and vineyards, until it reached a glacier, over which it rolled.
Scratching, cracking, dropping out dirty stuff, rock and gravel, it acted like a dredge box. It sprinkled out its contents, to fill up the great deep green crevasses in the ice, until it finally reached a big open space of waste land, that had nothing on it, but rocks and bushes. Then, with a roar, as if laughing at itself, it broke up, spread open, and left the place strewn with more rocks and stones and lumps of ice.
Then a troop of fairies came riding on the hot, [167]dry, south wind. They blew, with their breath, on the snow mass, and quickly melted it into the river, so fast, indeed, that men wondered at the high water in the distant lakes and the rivers in France. In lovely Switzerland, new soil was made, where today are farms and vineyards. In time, billions of purple clusters are plucked, and willing tourists are happy, in taking the grape cure; while they walk over the place where once, a judicially minded avalanche had laughed so hard, that it burst.[168]
%%%
Gruntli was rich. He had a large house, with one room full of books, but not one of these contained any poetry, or stories, or novels, or romances. He sneered at anybody who said they [251]believed in Santa Claus, and he openly insulted people who loved to think that William Tell, their national hero, ever lived. As for the exploits of Joan of Arc, or of Arnold of Winkelried, he used to say that what was told of them was only the same as nursery stories.
Nobody loved Gruntli, for he was a hard master with his servants. Though he called himself "a man of science," and sneered at the village folks, when they went to church on Sunday, he did nothing to help the poor people of the valley.
Part of the wealth, of this hard-hearted man, consisted in mules, of which he had twenty or more. These were sumpters, or pack animals, that carried the milk, butter, cheese, and produce of the valley, to be sold in the nearest large city, and to bring back what was needed.
%%%
"Come down, you boy, and make your choice of one of these three. Each has a glorious gift to him who drinks. Come quick, for it will soon be daylight."
Perrod knew he was discovered, but he was a brave boy. If his legs trembled, his heart was big. Moreover, the golden haired man gave him a nod, and winked his eye, to encourage the lad.
So Perrod at once climbed down and stood [35]before the table, on which were the three chalices.
"Drink, young friend," said the giant, "from any one of these, but know that, in the red liquid, is a gift to the Swiss men. Drain this cup, and then you will have strength, like me." At that, he bent his arm to show his mighty muscles. "You will be able to conquer the strongest man, or fiercest beast. Besides, I shall give you a hundred fat cows, each of which will yield much milk, rich in butter. Drain this cup, and, according to my promise, you will see the kine tomorrow."
%%%
We cannot here tell what Erni, the enraged hunter, said.
%%%
while (*endValue != '\0') {
    if (*endValue == '"')
        inString = !inString;
    else if (*endValue == '<' && !inString)
        cbCount++;
    else if (*endValue == '>' && cbCount > 0 && !inString)
        cbCount--;
    else if (*endValue == '>' && cbCount == 0 && !inString)
        break;
    else if (*endValue == '[' && !inString)
        sbCount++;
    else if (*endValue == ']' && !inString)
        sbCount--;
    else if (*endValue == ',' && !cbCount && !sbCount && !inString)
        break;
    endValue += 1;
}
%%%
// printf("printing\n");
// printf("type= %d\n", node->type);
switch (node->type) {
    case jSTRING: {
        printjString(getjString(node), tabs);
        break;
    } case jNUMBER: {
        printjNumber(getjNumber(node), tabs);
        break;
    } case jARRAY: {
        printjArray(getjArray(node), tabs);
        break;
    } case jOBJECT: {
        printjObject(getjObject(node), tabs);
        break;
    } default: {
        printf("Could not parse.\n");
        break;
    }
}
%%%
*cur = '\0';
object->keys[i] = getjNode(prev);
*cur = ':';
prev = cur + 1;
cur = findNextComma(prev, node->rawdata + node->datalen);
if (cur == NULL) {
    *(node->rawdata + node->datalen - 1) = '\0';
    object->values[i++] = getjNode(prev);
    *(node->rawdata + node->datalen - 1) = '>';
    break;
} else {
    *cur = '\0';
    object->values[i++] = getjNode(prev);
    *cur = ',';
    prev = cur + 1;
    cur = findNextColon(prev, node->rawdata + node->datalen);
}

%%%
while (cur != NULL) {
    *cur = '\0';
    array->elements[i++] = getjNode(prev);
    *cur = ',';
    prev = cur + 1;
    cur = findNextComma(prev, node->rawdata + node->datalen);
}
%%%
Not a minute did Perrod wait to decide. "I care more for music, than for money, or strength," he said, and, lifting the glass, he put it to his lips and drained the cup dry.
"What was it, and how did it taste?" do you ask? It was what the cows gave him every day-pure fresh milk, but cold as glacier water.
"Good," cried the man with the golden hair. "Any other choice would have meant death. Here is the horn. Blow it tomorrow, and see what will happen."
As if lifted up on wings, to his straw bed, but holding on to his horn, Perrod heard the door shut and bang, as the three men went out, two of them scowling. Then the fire cooled to ashes. He fell asleep and dreamed of the time when, in the church, he should lead his bride to the altar, his lovely sweetheart, Luquette, to be married, and the two should have a chateau and home of their own.
%%%
[Contents]
XXII
THE WHITE CHAMOIS
The dwarfs and chamois have always been good friends. This is chiefly because they are so much like each other, in being small. The short dwarfs look like little men. They have beards, and wear caps and clothes, but they are hardly as high as a yard stick, and measure up, only to the heads of quite small boys. In weight, some of them scarcely reach up to a calf. Occasionally, you find a little fellow that could be packed in a band box, or carried in a suit case. As for the baby dwarfs, one of them could be wrapped up in a napkin, and be dropped into a man's overcoat pocket.
%%%
Out of, and on top, the dense star-like mass of warmth and coziness, as if robed for a skiing or skating party, there blossomed forth many round-headed tufts, or rosettes, that were pearly white.
Now, not only thickly clothed, but beautiful and strong, the Noble White was given a home at once in a rock cranny. Like a new-born baby, that, as soon as it arrives, sticks its thumb in its mouth, as much as to say, "This world is all right; I am going to like it," the Edelweiss rooted itself at once and began to grow.
%%%
When the shepherd, who had grown rather fat, was very tired, after much climbing up and over the rocks, with much puffing and blowing, arrived at the cave, he had to stop and get his breath. The chief dwarf came out, and smilingly [59]invited him into the cave, where he sat down on the stool offered him.
Hilty was amazed, as he looked at the beautiful stalactites, hanging from the ceiling, and his eyes opened wide at the ingots of gold and silver, which he saw lying on the floor. Piles of silver ore, not yet smelted, and heaps of rocky crystals, topazes, onyx, and some sapphires and opals lay around. His host, the dwarf, paid no attention to these, but led him further in the cave, where was a sofa, made of thick soft moss, on which he was told to lounge at ease.
%%%
"Bah! that's nothing. Why don't you give me something that's hard to do? I can pick up the hardest pebble and squeeze water out of it with my hands. I'll wager a gold coin you can't do it."
Thus dared, the giant picked up a bit of hard rock and nearly broke his finger bones trying to crush it, or make it yield water. Mad as fire, he called the tailor a rascal, and said he told fibs. Then he dared him to try his hand at it. He got his club ready to smash the man into a jelly, if he failed.
Now the tailor, not expecting to get home until night, had brought a fresh cheese ball and some crackers, to eat on the way. He turned his back to the giant and bent over, pretending to pick up a hard round stone from the ground. Then he pressed this cheese between his two hands so hard, that a drop or two, of what looked like water, [124]came out. As the moisture glistened in the sun, the astonished giant dropped his club. Then, rushing up to the tailor, he grasped his hand and cried out:
%%%
Then he clutched his whip more tightly, expecting to get down and thrash the animal with all his strength.
%%%
if (containsDecimalOrExponent(node->rawdata, node->datalen)) {
    number->isInt = 0;
    number->dvalue = atof(node->rawdata);
    number->ivalue = (int)number->dvalue;
} else {
    number->isInt = 1;
    number->ivalue = atoi(node->rawdata);
    number->dvalue = (double)number->ivalue;
}
%%%
But his happiness was but for a short time, for his stomach had changed, and could no longer digest the ordinary food of mortals, not even buttermilk; and, as for cheese, it nearly killed him. Feeding so long, on honey and dragon's food, had ruined him for liking any other articles of diet.
%%%
if (number->holder != NULL) {
    freejNode(number->holder);
    return;
}
free(number);
%%%
Sometimes judges and lawyers advise people, that have a quarrel, to settle their case outside of court. When a person thus decides between two, who are not agreed, we say that they are judicially minded. Now there was once, in Switzerland, an avalanche, that did what peacemakers and honest judges could not accomplish. So it was called the Judicial Avalanche.
%%%
Some were glad even to become plain meadow grasses. When one plump fairy was told she would become an Alpine Poa, and must carry her babies on her back, she gladly consented saying, "I am willing."
%%%
if (*endValue == '"')
    inString = !inString;
else if (*endValue == '<' && !inString)
    cbCount++;
else if (*endValue == '>' && cbCount > 0 && !inString)
    cbCount--;
else if (*endValue == '>' && cbCount == 0 && !inString)
    break;
else if (*endValue == '[' && !inString)
    sbCount++;
else if (*endValue == ']' && !inString)
    sbCount--;
else if (*endValue == ',' && !cbCount && !sbCount && !inString)
    break;
endValue += 1;
%%%
for (int i = 0; i < array->size; i++) {
    printTabs(tabs + 1);
    printjNode(array->elements[i], tabs + 1);
    if (i < array->size - 1)
        printf(",");
    printf("\n");
}
%%%
When men finally arrived on the earth, and began to plough the ground, and to raise wheat for bread, and brought cows for milk, the giants, and especially the giantesses, were mightily interested. Their curiosity was great, to see how the things were done and how houses were built, and cradles were made for babies to sleep in.[50]
The giants told their sons and daughters not to meddle with the human folks, but rather to help them; for the giants, dull as their wits were, were afraid of any creature, that, though smaller than they were, had more brains. They wondered how human beings got such big heads, and they often pounded on each other's skulls, to see if they were hollow inside, like a cocoanut.
Now the biggest, of all these big fellows, was their king, named Gargantua, but men learned to call him "Old Gargy." He had only one daughter, Bertha, who was his pet. She was a pretty good giantess, but she always wanted to have her own way, and this often made trouble in the family. Daddy and mamma could not always agree about her. Bertha knew how to get on Old Gargy's soft side, and sweeten his temper.
Too often, her indulgent father either let her have her own way, or gave what she begged of him, or else he winked at, and overlooked, some of her foolish pranks.
%%%
if (array->holder != NULL) {
    freejNode(array->holder);
    return;
}
for (int i = 0; i < array->size; i++)
    freejNode(array->elements[i]);
free(array->elements);
free(array);
%%%
while (*endValue != '\0') {
    if (*endValue == '"')
        inString = !inString;
    else if (*endValue == '<' && !inString)
        cbCount++;
    else if (*endValue == '>' && cbCount > 0 && !inString)
        cbCount--;
    else if (*endValue == '>' && cbCount == 0 && !inString)
        break;
    else if (*endValue == '[' && !inString)
        sbCount++;
    else if (*endValue == ']' && !inString)
        sbCount--;
    else if (*endValue == ',' && !cbCount && !sbCount && !inString)
        break;
    endValue += 1;
}
%%%
The children all clapped their hands and the mother embraced her husband in joy. By and bye, for ivory, which was very costly, Mr. Soft Pudding used white birch for the clock hands.
Then he set up a factory, and this gave work to many villagers, men and women, boys and girls. He soon made a fortune, and now, no one [100]called him Soft Pudding, but every one saluted him with a title of respect.
%%%
The talk went on for hours. At last a good looking dwarf, with a big head and very long white beard, slowly arose to speak. Usually, he never said a word, but listened carefully, until every one else had had his say. Then, if asked, he would give his own opinion, which always proved to be the sense of the whole meeting. Every one wondered how his head could carry all [136]he knew, and how he could remember what each one had said. So he was generally known, by one or the other of two names, which, in the dwarf language, mean "Thought Includer," or "Clarifier of Ideas."
The chairman at once recognized him, called him by name, and bade him come up in front and speak where all could hear him. He was very modest at first, and held back a moment, but fearing that some of the other dwarfs might twist their necks off, in turning them too far around to get a good look at him, and knowing that some of the old fellows were nearly deaf, he strode forward. Stepping upon a platform of rock, where all could hear him easily, he began thus:
"The trouble with our friend Walter, and with all other hunters, good and bad, especially with those who are poor shots, is that with all their good intentions, they are too stupid. They need the help of us dwarfs."
%%%
Occasionally, in rambling through the ice halls, [225]the fairies could discern, embedded in the crystal walls, black spots. Asking whether these were flies in amber, such as they had heard of, they were told that these specks were mortals, men and women, mountain climbers, who had fallen down precipices, or upon the ice, or slipped into crevices. Having ended their lives thus, they were kept in the crystal for years, until their bodies were shot out on the moraines, or washed down the rivers. Sometimes the fairies found bits of rope and alpenstocks. They even learned to tell the difference between blondes and brunettes.
Often some of the fairies wondered how it would feel to be born as a baby, and drink milk, and eat candy, and first crawl over the floor, and then walk and grow up to be a man or a woman. They could only guess vaguely what it was to die. For that is the curious thing about fairies, they cannot die, because they were never born. They do not have to grow like human babies, or big elephants, or little kangaroos, or be hatched out of eggs, like chickens, or wriggle in the ponds, or swim in the water like frogs, or fishes, or whales, or porpoises. Once in a while, some fairy thought she would like to try it, just once, to live and die, just to see how it felt, but the other fairies, who did not admire her taste, only laughed at her.[226]
%%%
This the man did, and, riding to where the village had been, organized a corps of relief to help the wounded and hungry, who were left alive, and he paid for medicines out of his own purse. Then he built new and better houses for his tenants, the survivors, and for those who came from other parts of the Swiss country.
And when later, a devout worshipper in church and helper of his fellow men, Gruntli cared for and fed his ass Gulick, in a comfortable stable, until at last the beast died at a good old age.
The pastor of the rebuilt village came one day, and asked Gruntli to tell the story of his great change and the reason of it. Then the man made answer as follows:
%%%
"I cannot promise you either cows or coins, but if you drink the liquid in the white goblet, you will be able to use this horn, make music in the mountains and call your cows, as I have [36]done. Thus your flocks and herds also will share with you my gift."
Not a minute did Perrod wait to decide. "I care more for music, than for money, or strength," he said, and, lifting the glass, he put it to his lips and drained the cup dry.
"What was it, and how did it taste?" do you ask? It was what the cows gave him every day-pure fresh milk, but cold as glacier water.
%%%
"Who can believe that?" whispered one fairy to another. "And the other?" she asked, hardly believing such a thing was possible.
"Let me tell you, then, about the kangaroo, that lives in Australia. She has a wallet, or [185]travelling bag where, or in which, she stows away her little folks, and there they are as cozy as if they were riding in a wagon. Yet, all the time, they can look out and see what is going on in the world. In this way, both the young opossums and the kangaroos are kept warm, and are fed until they are grown. No wolves, or bears, or foxes can catch and run away with them."
"Can a kangaroo climb a tree?" asked a fairy, whose fancy had been greatly taken with the idea of a whole family being up a tree at once, and free from the wolves.
%%%
char* start = str;
if (*str != '<')
    return 0;
while (*str != '>') {
    int inString = 0, cbCount = 0, sbCount = 0; // " < [
    char* endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && !cbCount && !inString)
            break;
        else if (*endValue == ':' && !cbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    char endHolder = *endValue;
    *endValue = '\0';
    json_type elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE &&
        *str == '<' && 
        *endValue == '>')
        return endValue - start;

    if (elementType != jSTRING ||
        *endValue == '>')
        return 0;

    str = endValue;

    inString = 0, cbCount = 0, sbCount = 0;
    endValue = str + 1;
    while (*endValue != '\0') {
        if (*endValue == '"')
            inString = !inString;
        else if (*endValue == '<' && !inString)
            cbCount++;
        else if (*endValue == '>' && cbCount > 0 && !inString)
            cbCount--;
        else if (*endValue == '>' && cbCount == 0 && !inString)
            break;
        else if (*endValue == '[' && !inString)
            sbCount++;
        else if (*endValue == ']' && !inString)
            sbCount--;
        else if (*endValue == ',' && !cbCount && !sbCount && !inString)
            break;
        endValue += 1;
    }
    if (*endValue == '\0')
        return 0;

    endHolder = *endValue;
    *endValue = '\0';
    elementType = getjNodeType(str + 1);
    *endValue = endHolder;

    if (elementType == jWHITESPACE ||
        elementType == jERROR)
        return 0;

    str = endValue;
}

if (*++str == '\0')
    return str - start;
return 0;
%%%
Thinking his last day had come, the old daddy fell on his knees to pray, but he was quickly awakened to his senses, by hearing a regular concert in the barn yard. Outside, the donkeys were braying, the horses neighing, the roosters crowing, the geese cackling, the hens clucking, and the dogs barking-and all in joy. As for the old billy goat, he stood up on his hind legs and cut up such capers, that the whole family of kids began to imitate him by frisking in a circle.
%%%
if (object->holder != NULL) {
    freejNode(object->holder);
    return;
}
for (int i = 0; i < object->size; i++) {
    freejNode(object->keys[i]);
    freejNode(object->values[i]);
}
free(object->keys);
free(object->values);
free(object);
%%%
while (cur != NULL) {
    *cur = '\0';
    array->elements[i++] = getjNode(prev);
    *cur = ',';
    prev = cur + 1;
    cur = findNextComma(prev, node->rawdata + node->datalen);
}
%%%
ret = jSTRING;
 else if (isjNumber(start)) {
ret = jNUMBER;
 else if (isjArray(start)) {
ret = jARRAY;
 else if (isjObject(start)) {
ret = jOBJECT;
 else if (isjWhitespace(start)) {
ret = jWHITESPACE;
 else if (isjTrue(start)) {
ret = jTRUE;
 else if (isjFalse(start)) {
ret = jFALSE;
 else if (isjNull(start)) {
ret = jNULL;
 else {
ret = jERROR;
%%%
[Contents]
XVI
THE FAIRIES AND THEIR PLAYGROUND
Once upon a time in Switzerland, there was a Golden Age for cows and people. This was before the country had become the playground of Europe and the Land of a Thousand Hotels. It was before men climbed mountains for pleasure; or, imitating the New Hampshire Yankees on Mount Washington, had built railways to their summits, and filled the land with wires and rails. Not then, could the Edelweiss be bought in a drygoods store, or in the markets. Not then did lazy and soft-muscled tourists pay money to have burnt upon alpenstocks the names of a hundred mountains, which they never even saw, except from a hotel porch, or distant window, or from the train.
%%%
return 0;
%%%
jObject* getjObject(jNode* node) {
    if (node->type != jOBJECT)
        return NULL;
    if (node->contents != NULL)
        return (jObject*)node->contents;
    jObject* object = malloc(sizeof(*object));
    node->contents = (void**)object;
    object->holder = node;
    int colonCount = 0;
    char* cur = findNextColon(node->rawdata + 1, node->rawdata + node->datalen);
    while (cur != NULL) {
        colonCount++;
        cur = findNextColon(cur + 1, node->rawdata + node->datalen);
    }

    object->size = colonCount;
    object->keys = malloc(sizeof(*object->keys) * object->size);
    object->values = malloc(sizeof(*object->values) * object->size);

    int i = 0;
    char* prev = node->rawdata + 1;
    cur = findNextColon(prev, node->rawdata + node->datalen);
    while (cur != NULL) {
        *cur = '\0';
        object->keys[i] = getjNode(prev);
        *cur = ':';
        prev = cur + 1;
        cur = findNextComma(prev, node->rawdata + node->datalen);
        if (cur == NULL) {
            *(node->rawdata + node->datalen - 1) = '\0';
            object->values[i++] = getjNode(prev);
            *(node->rawdata + node->datalen - 1) = '>';
            break;
        } else {
            *cur = '\0';
            object->values[i++] = getjNode(prev);
            *cur = ',';
            prev = cur + 1;
            cur = findNextColon(prev, node->rawdata + node->datalen);
        }
        
    }

    return object;
}
%%%
int isjNumber (char* str) {
    char* start = str;
    if (*str == '-')
        str += 1;

    if (*str == '0') {
        str += 1;
    } else if (*str >= '1' && *str <= '9') {
        while (*str >= '1' && *str <= '9')
            str += 1;
    } else { // number must contian at least one digit
        return 0;
    }

    if (*str == '.') {
        str += 1;
        if (*str < '0' || *str > '9') // at least one digit must follow '.'
            return 0;
        while (*str >= '0' && *str <= '9')
            str += 1;
    }

    if (*str == 'e' || *str == 'E') {
        str +=1;
        if (*str == '+' || *str == '-')
            str += 1;
        if (*str < '0' || *str > '9') // at least one digit must follow (e|e\+|e-)
            return 0;
        while (*str >= '0' && *str <= '9')
            str += 1;
    }

    if (*str == '\0')
        return str - start;

    return 0;
}
%%%
Now in this place, and just at this time, there was a very ugly and dilapidated old house of worship, which had been erected several hundred years before, and was now almost ready to tumble to pieces.
For a long time, the question, of tearing down the old church and erecting in its place a new one, in modern style, had so vexed the community, [159]that a disgraceful squabble had broken out. The people of one party would not speak to, or have anything to do with, those of the other way of thinking; and all on account of this old building. The young people were hot for a new edifice. They hoped to get an architect from Zurich, who had gone from their village, and had his plans all ready, which the young ladies all said were "just lovely."
%%%
jNode* getjNode (char* str) {
    // printf("creating node\n");
    jNode* node = malloc(sizeof(*node));
    char* start = firstNonSpace(str);
    char* end = firstEndSpace(start);
    node->type = getjNodeType(str);
    node->contents = NULL;
    node->datalen = end - start;
    node->rawdata = malloc(sizeof(*node->rawdata) * (node->datalen + 1));
    for (int i = 0; i < node->datalen; i++)
        node->rawdata[i] = start[i];
    return node;
}
%%%
No ogres or man-eating giants, of either sex, [174]were invited to this meeting, for the Swiss fairies are a very respectable lot of folks. In some countries, they do not have anything to do with "gods," or "devils." They are very particular as to who or how or what they regard as fit for society, or look upon as equals. Such beings of uncertain reputation as "the gods," or "the fates," or "the devils" or any of their tribe, were not known in their fairy society. It is said that such beings used to live in the mountains, when the Romans were in the land.
%%%
number->isInt = 0;
number->dvalue = atof(node->rawdata);
number->ivalue = (int)number->dvalue;
 else {
number->isInt = 1;
number->ivalue = atoi(node->rawdata);
number->dvalue = (double)number->ivalue;
%%%
On the other hand, one cunning summer fairy, with a fan of flowers in her hand, enticed a young frost giant to come and sit down beside her. Then she threw a spell over him, and he was so wrapped up in her charms, that she actually melted him with her beauty, so that when the meeting broke up, there was no frost giant there, but only a puddle of cold water; for that is what frost giants turn into, when the weather is too warm.
Each speaker mounted the platform, which was a big boulder, with a flat top. When any of the frost giants, who sat up in front, made a speech, it was noticed that, while there were gnomes and kobolds out on the edge of the audience, who shouted "Louder, Louder;" some of the gentler fairies, who were nearer, put up their hands to their ears, for fear of being deafened. It was hard to please all, and at one time, when there were too many on their feet and all wanted to talk at once, the president roared out that he would adjourn the meeting, if there was not better order.[200]
As for the grotto girls, they were pointedly requested, several times, to stop whispering.
It was a pretty long session, for all were allowed to have their say, just as at a town meeting of mortals.
%%%
if (string->holder != NULL) {
    freejNode(string->holder);
    return;
}
free(string->chars);
free(string);
%%%
if (*endValue == '"')
    inString = !inString;
else if (*endValue == '<' && !inString)
    cbCount++;
else if (*endValue == '>' && cbCount > 0 && !inString)
    cbCount--;
else if (*endValue == '>' && cbCount == 0 && !inString)
    break;
else if (*endValue == '[' && !inString)
    sbCount++;
else if (*endValue == ']' && !inString)
    sbCount--;
else if (*endValue == ',' && !cbCount && !sbCount && !inString)
    break;
endValue += 1;
%%%
char* start = str;
if (*str != '"')
    return 0;
str += 1;
while (*str != '"') {
    if (*str == '\\') {
        str += 1;
        if (*str == 'u') {
            for (int i = 0; i < 4; i++) {
                str += 1;
                if ((*str < '0' || *str > '9') &&
                    (*str < 'a' || *str > 'f')) {
                    return 0;
                }
            }
        } else if (
            *str != '"' &&
            *str != '\\' && 
            *str != '/' &&
            *str != 'b' &&
            *str != 'f' &&
            *str != 'n' &&
            *str != 'r' &&
            *str != 't') {
            return 0;
        }
    }
    else if (*str == '\0') {
        return 0;
    }
    str += 1;
}

str += 1;
if (*str == '\0')
    return str - start;
return 0;
%%%
void freejObject(jObject* object) {
    if (object->holder != NULL) {
        freejNode(object->holder);
        return;
    }
    for (int i = 0; i < object->size; i++) {
        freejNode(object->keys[i]);
        freejNode(object->values[i]);
    }
    free(object->keys);
    free(object->values);
    free(object);
}
%%%
He tried long to find the way out, but could see no hole or cleft in the rocks. After a while, he saw what looked like a tunnel, or, it might be, a grotto.
%%%
In that part of the Swiss Republic, called the Grisons, there is a sharp mountain, thin and round, like a horn. Because it is red, its name has always been Rothhorn, or Red Peak.
In one of the towns near by, lived a proud man, named Gruntli, who scouted the idea of there being any fairies, or Santa Claus. To his view, there was no intelligence, or virtue, in dumb brutes. He did not believe in anything but what he could see, taste, smell, hear, or handle with his ten fingers. This was what he called "science."
This old fellow, Gruntli, boasted of being "a man of science." He considered that everything belonging to religion was superstition. Mule drivers, cow milkers, cheese makers, and such folk, whom he called "the ignorant common people," might have faith in such things, but not he.
%%%
Soon she had led him into the topaz hall of the great cave, but no sooner had he crossed the threshold than he fell down, exhausted, upon the shining floor. In a moment he was in a deep sleep, from which he was not to awake for many days.
%%%
Even the cattle enjoy the music of the bells. Just as soon as the shepherds sound the Alpine horn, or start the call, for the herds to come home, every goat moves forward and cows leave their grazing on the grass, or they rise from chewing the cud. Then one may see the long lines of the milk-givers marching towards the chalets. There the men, at night, and in the morning, milk the cows. When the animals are housed for the night, they start the fires. They put in the rennet, that curdles the cream and turns the white and golden liquid into cheeses, so solid that one can roll them down the hills.
Everyone in America knows about the delicious white Schweitzer cheese. When cut open, it is seen to be full of holes, as if well ventilated, or, in many places, bored with an augur.
%%%
char* start = str;
while (*str != '\0') {
    if (!isCharWhitespace(*str))
        return 0;
    str += 1;
}
return str - start;
%%%
return (*str++ == 't' &&
        *str++ == 'r' &&
        *str++ == 'u' &&
        *str++ == 'e' &&
        *str == '\0') ? 4 : 0;
%%%
Old Sol declared that, with the aid of the fairies, he would make Switzerland the most beautiful of all countries, so that many people from foreign lands would come to see it. He would scoop out lakes, channel out rivers, smooth the face of the country, and make it lovely with pastures, rich in cows and goats, and spangled with flowers of many hues. Yes, if the fairies would promise to put enough clothes on their favorites, and wrap them up in downy undergarments, with lots of fur and wool for overcoats, he would help the prettiest flowers to climb up to the high mountains. Then he would promise to furnish heat enough, so that they could keep warm and live there. He would make it so pleasant for them, that they would never get homesick, or want to go back to their mothers in the valley below. In spite of the frost giants, the storms and winds, the tempests, and the icy breath of the giants, these flowers would bloom, and nod, and laugh at and defy all enemies.
%%%
Now it is customary in all happy families, when father and mother are expecting the cradle soon to be filled, to choose a name for the baby, and to have its clothes ready. This is done, so that the poor little thing, on coming into the world, will not get a chill, or sneeze, or have a cough, and die. Moreover, if it have a name, no one will mistake one baby for another, unless they arrive as twins, when some mark, such as a blue ribbon for a boy, and a pink one for a girl, is necessary.
So the old fairies put their heads together, to find a proper name for the new fairy flower-baby, that was to live among the cold mountain tops and refuse to be frightened, or frozen, or be driven down lower, or to be cuddled up in meadows, near men's houses, where it was warm.
"What say you?" asked the Queen, of the wisest of the fairies, who was considered a sort of [149]sage or prophet, and who had a wonderfully long head. "What name do you give?"
%%%
[Contents]
XIX
%%%
if (node->type != jSTRING)
    return NULL;
if (node->contents != NULL)
    return (jString*)node->contents;
jString* string = malloc(sizeof(*string));
node->contents = (void**)string;
string->holder = node;
string->length = node->datalen - 2;
string->chars = malloc(sizeof(*string->chars) * (string->length + 1));
for (int i = 0; i < node->datalen - 2; i++)
    string->chars[i] = node->rawdata[i + 1];
string->chars[string->length] = '\0';
return string;
%%%
colonCount++;
cur = findNextColon(cur + 1, node->rawdata + node->datalen);
%%%
// printTabs(tabs);
if (array->size == 0) {
    printf("[]");
    return;
}
printf("[\n");
for (int i = 0; i < array->size; i++) {
    printTabs(tabs + 1);
    printjNode(array->elements[i], tabs + 1);
    if (i < array->size - 1)
        printf(",");
    printf("\n");
}
printTabs(tabs);
printf("]");
%%%
printf("[]");
return;
%%%
void freejString(jString* string) {
    if (string->holder != NULL) {
        freejNode(string->holder);
        return;
    }
    free(string->chars);
    free(string);
}
%%%
int isjNumber (char* str) {
    char* start = str;
    if (*str == '-')
        str += 1;

    if (*str == '0') {
        str += 1;
    } else if (*str >= '1' && *str <= '9') {
        while (*str >= '1' && *str <= '9')
            str += 1;
    } else { // number must contian at least one digit
        return 0;
    }

    if (*str == '.') {
        str += 1;
        if (*str < '0' || *str > '9') // at least one digit must follow '.'
            return 0;
        while (*str >= '0' && *str <= '9')
            str += 1;
    }

    if (*str == 'e' || *str == 'E') {
        str +=1;
        if (*str == '+' || *str == '-')
            str += 1;
        if (*str < '0' || *str > '9') // at least one digit must follow (e|e\+|e-)
            return 0;
        while (*str >= '0' && *str <= '9')
            str += 1;
    }

    if (*str == '\0')
        return str - start;

    return 0;
}
%%%
while (cur != NULL) {
    colonCount++;
    cur = findNextColon(cur + 1, node->rawdata + node->datalen);
}
%%%
if (*endValue == '"')
    inString = !inString;
else if (*endValue == '<' && !inString)
    cbCount++;
else if (*endValue == '>' && cbCount > 0 && !inString)
    cbCount--;
else if (*endValue == '>' && cbCount == 0 && !inString)
    break;
else if (*endValue == '[' && !inString)
    sbCount++;
else if (*endValue == ']' && !inString)
    sbCount--;
else if (*endValue == ',' && !cbCount && !sbCount && !inString)
    break;
endValue += 1;
%%%
At night, before the children went to sleep, Mother, and sometimes Daddy, told them fairy or wonder tales, or of the heroes that had made Switzerland free, or the Bible stories, till they knew these by heart, and, when they grew up, told them to their children.
With the young men of the village, it was not always work-in winter with the cows and goats, in the dairy at home; or, in summer the driving of the flock up to the mountain pastures, with the cheesemaking there. Tired of the monotony of country life, the sturdy lads welcomed the advent of the soldiers, in bright, gay uniforms, with a band of music, and the recruiting officer at their head.
With their flags and banners, these strangers came from the great world outside, to enlist young men for military service, in France or Germany, or for the Scotch Brigade in the Netherlands, or, to serve the King of England, in America. All the village folk turned out and the mothers and maidens were as eager as the fathers, to see how it was done, before their sons, brothers and sweethearts marched away. Not least among these Swiss, who gained fame, was General Henry Bouquet, who, in the British [9]service, and as comrade of Washington, won Pittsburg for the King.
For these were the gala days of monarchs and of the soldier of fortune, that is, of the brave young man, who left his home and country to fight for any one who paid him well. He enlisted, more for love of adventure, than for love of the ruler whose splendid uniform he wore. Yet his loyalty and honor were steadfast. Faithful and brave, he lived in camps and barracks, fought battles, and died in the hospital, or on the field.
%%%
// printTabs(tabs);
if (array->size == 0) {
    printf("[]");
    return;
}
printf("[\n");
for (int i = 0; i < array->size; i++) {
    printTabs(tabs + 1);
    printjNode(array->elements[i], tabs + 1);
    if (i < array->size - 1)
        printf(",");
    printf("\n");
}
printTabs(tabs);
printf("]");
%%%
As soon as the news had spread abroad in the city, after sunrise, the stock on hand, in all the shops that kept mourning goods, or black silk, or muslin, or grief-bordered handkerchiefs, was sold out before noon, and there was not time enough to import a fresh supply of crepe from Paris. So everybody was sighing and groaning, and the sounds were appalling. Some were shedding tears copiously, for real grief; but others, because their old mourning garments were out of fashion. With others, it was a case of economy, rather than grief, for black goods saved their best clothes.
But the tailor, though feeling sad at first, saw a chance of coining wealth and getting into society, for he had quickly learned that the king had offered his daughter, in marriage, to any one who would fight and kill the dragon, besides [126]making a gift outright, of a thousand pounds of gold.
So when the pair of heroes, the tailor and giant, proffered their services, the monarch gave the monstrous fellow an iron bar, as big as the rail for a locomotive to run on.
%%%
char* findNextColon (char* start, char* end) {
    int inString = 0, cbCount = 0, sbCount = 0;
    for (char* cur = start; cur < end; cur += 1) {
        if (*cur == '\0')
            return NULL;
        else if (*cur == '"')
            inString = !inString;
        else if (*cur == '[' && !inString)
            sbCount++;
        else if (*cur == ']' && !inString)
            sbCount--;
        else if (*cur == '<' && !inString)
            cbCount++;
        else if (*cur == '>' && !inString)
            cbCount--;
        else if (*cur == ':' && !inString && !cbCount && !sbCount)
            return cur;
    }
    return NULL;
}
%%%
The fairy, named Lorelei, paid no attention to their cries, but only laughed at them, as they struggled in the water.
This Lorelei, the chief of the river fairies, was never seen during the day, for during the sunlight she loved to sit among her jeweled caves, and remain far down below in the cool depths of the waters. During daylight hours, if any mortal tried to catch even a glimpse of her, he sought in vain. It thus happened that some people, and even boatmen on their way down to Rotterdam, laughed at the idea of there being a Lorelei, or any other fairy among the rocks.
But when the moon was at its full and shone brightest, and its silvery beams seemed to turn into a fairy-like gauze, woven of mist and moonbeams, the Lorelei was in her happiest mood.
%%%
At this, the kind hearted fairy, in Yankee clothes, nearly dropped his Alpenstock, out of sheer sympathy. Taking out his purse, he was [173]about to hand the child a silver coin; when, looking up at the doorway of the chalet near by, he saw a woman standing and peering out with keen interest. He hesitated a moment, and then inquired, of the little gate-opener, whether that were her mother. She, having learned to speak her piece, but not prompted as to any further question, replied at once "Yes."
At this the fairy in disguise lost his temper and said to her "you little cheat!" Then he shut up his purse, and passed on.
Quickly changing into his former fairy form, messengers by the score were sent out by him over the mountain tops, down in the mines, under the lakes, over the pastures, and wherever fairies of any kind or sort lived. These were all summoned to the meeting.
%%%
str +=1;
if (*str == '+' || *str == '-')
    str += 1;
if (*str < '0' || *str > '9') // at least one digit must follow (e|e\+|e-)
    return 0;
while (*str >= '0' && *str <= '9')
    str += 1;
%%%
// printf("printing\n");
// printf("type= %d\n", node->type);
switch (node->type) {
    case jSTRING: {
        printjString(getjString(node), tabs);
        break;
    } case jNUMBER: {
        printjNumber(getjNumber(node), tabs);
        break;
    } case jARRAY: {
        printjArray(getjArray(node), tabs);
        break;
    } case jOBJECT: {
        printjObject(getjObject(node), tabs);
        break;
    } default: {
        printf("Could not parse.\n");
        break;
    }
}
%%%
char* start = str;
if (*str != '"')
    return 0;
str += 1;
while (*str != '"') {
    if (*str == '\\') {
        str += 1;
        if (*str == 'u') {
            for (int i = 0; i < 4; i++) {
                str += 1;
                if ((*str < '0' || *str > '9') &&
                    (*str < 'a' || *str > 'f')) {
                    return 0;
                }
            }
        } else if (
            *str != '"' &&
            *str != '\\' && 
            *str != '/' &&
            *str != 'b' &&
            *str != 'f' &&
            *str != 'n' &&
            *str != 'r' &&
            *str != 't') {
            return 0;
        }
    }
    else if (*str == '\0') {
        return 0;
    }
    str += 1;
}

str += 1;
if (*str == '\0')
    return str - start;
return 0;
%%%
int isjWhitespace (char* str) {
    char* start = str;
    while (*str != '\0') {
        if (!isCharWhitespace(*str))
            return 0;
        str += 1;
    }
    return str - start;
}